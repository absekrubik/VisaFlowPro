{"file_contents":{"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","path":null,"size_bytes":649,"size_tokens":null},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","path":null,"size_bytes":1148,"size_tokens":null},"client/src/components/NotificationBar.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Bell, User, FileText, DollarSign, Settings } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport { commonApi } from \"@/lib/api\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { Button } from \"@/components/ui/button\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Badge } from \"@/components/ui/badge\";\n\ninterface Activity {\n  id: number;\n  actorId: number;\n  actorRole: string;\n  targetType: string;\n  targetId: number;\n  activityType: string;\n  description: string;\n  metadata: any;\n  createdAt: string;\n  actor: {\n    id: number;\n    name: string;\n    email: string;\n    role: string;\n  };\n}\n\nconst activityIcons: Record<string, any> = {\n  application_submitted: FileText,\n  application_updated: FileText,\n  broker_assigned: User,\n  document_uploaded: FileText,\n  document_reviewed: FileText,\n  commission_created: DollarSign,\n  profile_updated: Settings,\n  status_changed: Settings,\n};\n\nfunction getActivityLink(activity: Activity, userRole: string): string | null {\n  const { targetType, targetId, activityType } = activity;\n  \n  if (userRole === \"admin\") {\n    if (targetType === \"student\") return `/admin/students/${targetId}`;\n    if (targetType === \"broker\") return `/admin/brokers/${targetId}`;\n    if (targetType === \"application\") return `/admin/applications`;\n  }\n  \n  if (userRole === \"broker\") {\n    if (targetType === \"student\") return `/broker/students`;\n    if (targetType === \"application\") return `/broker/applications`;\n  }\n  \n  if (userRole === \"student\") {\n    if (targetType === \"application\") return `/student/application`;\n  }\n  \n  return null;\n}\n\nexport function NotificationBar({ userRole }: { userRole: string }) {\n  const { data: activities = [], isLoading } = useQuery({\n    queryKey: [\"activities\"],\n    queryFn: commonApi.getActivities,\n    refetchInterval: 30000,\n  });\n\n  const recentActivities = activities.slice(0, 10);\n  const unreadCount = Math.min(activities.length, 5);\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <Button variant=\"ghost\" size=\"icon\" className=\"relative\" data-testid=\"notification-trigger\">\n          <Bell className=\"h-5 w-5\" />\n          {unreadCount > 0 && (\n            <Badge \n              className=\"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 text-xs bg-primary\"\n              data-testid=\"notification-count\"\n            >\n              {unreadCount}\n            </Badge>\n          )}\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent align=\"end\" className=\"w-80 glass-panel border-white/10\">\n        <div className=\"p-3 border-b border-white/10\">\n          <h4 className=\"font-semibold text-sm\">Recent Activity</h4>\n        </div>\n        <ScrollArea className=\"h-[300px]\">\n          {isLoading ? (\n            <div className=\"p-4 text-center text-muted-foreground text-sm\">\n              Loading...\n            </div>\n          ) : recentActivities.length === 0 ? (\n            <div className=\"p-4 text-center text-muted-foreground text-sm\">\n              No recent activity\n            </div>\n          ) : (\n            recentActivities.map((activity: Activity) => {\n              const IconComponent = activityIcons[activity.activityType] || Bell;\n              const link = getActivityLink(activity, userRole);\n              const timeAgo = formatDistanceToNow(new Date(activity.createdAt), { addSuffix: true });\n              \n              const content = (\n                <div className=\"flex items-start gap-3 p-3 hover:bg-white/5 transition-colors cursor-pointer\">\n                  <div className=\"p-2 rounded-lg bg-primary/10 text-primary\">\n                    <IconComponent className=\"h-4 w-4\" />\n                  </div>\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"text-sm font-medium truncate\">{activity.description}</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      by {activity.actor?.name || \"System\"} • {timeAgo}\n                    </p>\n                  </div>\n                </div>\n              );\n              \n              return link ? (\n                <Link key={activity.id} href={link}>\n                  <DropdownMenuItem className=\"p-0 focus:bg-transparent\" data-testid={`activity-${activity.id}`}>\n                    {content}\n                  </DropdownMenuItem>\n                </Link>\n              ) : (\n                <DropdownMenuItem key={activity.id} className=\"p-0 focus:bg-transparent\" data-testid={`activity-${activity.id}`}>\n                  {content}\n                </DropdownMenuItem>\n              );\n            })\n          )}\n        </ScrollArea>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}\n","path":null,"size_bytes":4923,"size_tokens":null},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","path":null,"size_bytes":4419,"size_tokens":null},"client/src/components/ui/dropdown-menu.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md\",\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","path":null,"size_bytes":7606,"size_tokens":null},"client/src/components/ui/chart.tsx":{"content":"import * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload\n            .filter((item) => item.type !== \"none\")\n            .map((item, index) => {\n              const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n              const itemConfig = getPayloadConfigFromPayload(config, item, key)\n              const indicatorColor = color || item.payload.fill || item.color\n\n              return (\n                <div\n                  key={item.dataKey}\n                  className={cn(\n                    \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                    indicator === \"dot\" && \"items-center\"\n                  )}\n                >\n                  {formatter && item?.value !== undefined && item.name ? (\n                    formatter(item.value, item.name, item, index, item.payload)\n                  ) : (\n                    <>\n                      {itemConfig?.icon ? (\n                        <itemConfig.icon />\n                      ) : (\n                        !hideIndicator && (\n                          <div\n                            className={cn(\n                              \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                              {\n                                \"h-2.5 w-2.5\": indicator === \"dot\",\n                                \"w-1\": indicator === \"line\",\n                                \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                  indicator === \"dashed\",\n                                \"my-0.5\": nestLabel && indicator === \"dashed\",\n                              }\n                            )}\n                            style={\n                              {\n                                \"--color-bg\": indicatorColor,\n                                \"--color-border\": indicatorColor,\n                              } as React.CSSProperties\n                            }\n                          />\n                        )\n                      )}\n                      <div\n                        className={cn(\n                          \"flex flex-1 justify-between leading-none\",\n                          nestLabel ? \"items-end\" : \"items-center\"\n                        )}\n                      >\n                        <div className=\"grid gap-1.5\">\n                          {nestLabel ? tooltipLabel : null}\n                          <span className=\"text-muted-foreground\">\n                            {itemConfig?.label || item.name}\n                          </span>\n                        </div>\n                        {item.value && (\n                          <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                            {item.value.toLocaleString()}\n                          </span>\n                        )}\n                      </div>\n                    </>\n                  )}\n                </div>\n              )\n            })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload\n          .filter((item) => item.type !== \"none\")\n          .map((item) => {\n            const key = `${nameKey || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n            return (\n              <div\n                key={item.value}\n                className={cn(\n                  \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n                )}\n              >\n                {itemConfig?.icon && !hideIcon ? (\n                  <itemConfig.icon />\n                ) : (\n                  <div\n                    className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                    style={{\n                      backgroundColor: item.color,\n                    }}\n                  />\n                )}\n                {itemConfig?.label}\n              </div>\n            )\n          })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","path":null,"size_bytes":10763,"size_tokens":null},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","path":null,"size_bytes":1753,"size_tokens":null},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":711,"size_tokens":null},"client/src/components/ui/button-group.tsx":{"content":"import { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Separator } from \"@/components/ui/separator\"\n\nconst buttonGroupVariants = cva(\n  \"flex w-fit items-stretch has-[>[data-slot=button-group]]:gap-2 [&>*]:focus-visible:relative [&>*]:focus-visible:z-10 has-[select[aria-hidden=true]:last-child]:[&>[data-slot=select-trigger]:last-of-type]:rounded-r-md [&>[data-slot=select-trigger]:not([class*='w-'])]:w-fit [&>input]:flex-1\",\n  {\n    variants: {\n      orientation: {\n        horizontal:\n          \"[&>*:not(:first-child)]:rounded-l-none [&>*:not(:first-child)]:border-l-0 [&>*:not(:last-child)]:rounded-r-none\",\n        vertical:\n          \"flex-col [&>*:not(:first-child)]:rounded-t-none [&>*:not(:first-child)]:border-t-0 [&>*:not(:last-child)]:rounded-b-none\",\n      },\n    },\n    defaultVariants: {\n      orientation: \"horizontal\",\n    },\n  }\n)\n\nfunction ButtonGroup({\n  className,\n  orientation,\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof buttonGroupVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"button-group\"\n      data-orientation={orientation}\n      className={cn(buttonGroupVariants({ orientation }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction ButtonGroupText({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  asChild?: boolean\n}) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      className={cn(\n        \"bg-muted shadow-xs flex items-center gap-2 rounded-md border px-4 text-sm font-medium [&_svg:not([class*='size-'])]:size-4 [&_svg]:pointer-events-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ButtonGroupSeparator({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"button-group-separator\"\n      orientation={orientation}\n      className={cn(\n        \"bg-input relative !m-0 self-stretch data-[orientation=vertical]:h-auto\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  ButtonGroup,\n  ButtonGroupSeparator,\n  ButtonGroupText,\n  buttonGroupVariants,\n}\n","path":null,"size_bytes":2209,"size_tokens":null},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-primary/10\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","path":null,"size_bytes":266,"size_tokens":null},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverAnchor = PopoverPrimitive.Anchor\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent, PopoverAnchor }\n","path":null,"size_bytes":1342,"size_tokens":null},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","path":null,"size_bytes":2712,"size_tokens":null},"replit.md":{"content":"# Overview\n\nVisaFlow is a full-stack visa consultancy management platform built with React, Express, and MongoDB. The application serves three user roles—admins, brokers, and students—each with dedicated dashboards and workflows for managing visa applications, tracking commissions, and coordinating between parties.\n\nThe tech stack consists of:\n- **Frontend**: React with Vite, TypeScript, TailwindCSS, and shadcn/ui components\n- **Backend**: Express.js with TypeScript\n- **Database**: MongoDB via Mongoose ODM\n- **Authentication**: Session-based with express-session and bcrypt\n- **State Management**: TanStack Query (React Query)\n\n# Recent Changes\n\n**December 5, 2025 - Broker Edit Flow Fix**\n- Fixed race condition in broker edit dialog that was corrupting profile data\n- Consolidated commission and profile updates into single PATCH request\n- Added commissionAmount support to admin broker update endpoint\n- Backend now uses `!== undefined` checks to allow clearing optional fields (phone, companyName)\n- Frontend sends null values for cleared fields to properly remove outdated info\n- Removed unused commissionMutation in favor of unified updateMutation\n\n**December 5, 2025 - User Creation Workflow Improvements**\n- Enhanced admin broker creation with secure credential modal\n- Enhanced broker student creation with secure credential modal\n- Credential modals prevent accidental dismissal (ESC/outside click) until user clicks \"Done\"\n- Fixed student application submission to work correctly\n- Verified complete workflow: admin creates broker → broker creates student → student submits application\n\n**December 4, 2025 - MongoDB Migration**\n- Migrated from PostgreSQL (Drizzle ORM) to MongoDB (Mongoose)\n- Updated shared/schema.ts to use Zod-only schemas with TypeScript types\n- Created new server/db.ts with Mongoose connection and models\n- Rewrote server/storage.ts to use Mongoose queries\n- Implemented auto-incrementing numeric IDs using a counter collection\n- Fixed security vulnerability: replaced hardcoded passwords with cryptographically secure random passwords\n- New user creation endpoints now return temporaryPassword for admin/broker to share with users\n\n# User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n# System Architecture\n\n## Frontend Architecture\n\n**Component Structure**: The application uses a component-based architecture with shadcn/ui as the design system foundation. Components are organized into:\n- UI primitives (`client/src/components/ui/`) - Reusable, accessible components built on Radix UI\n- Layout components (`client/src/components/layout/`) - DashboardLayout and Sidebar for consistent page structure\n- Page components (`client/src/pages/`) - Role-specific views organized by user type\n\n**Routing**: Uses wouter for client-side routing with role-based route organization:\n- `/admin/*` - Admin dashboard routes\n- `/broker/*` - Broker dashboard routes  \n- `/student/*` - Student dashboard routes\n- `/login` and `/signup` - Authentication flows\n\n**State Management**: TanStack Query handles server state with custom query client configuration. API functions are centralized in `client/src/lib/api.ts` for type-safe backend communication.\n\n**Authentication Flow**: React Context (`AuthProvider`) manages authentication state, providing login/logout functions and user session data throughout the component tree. Protected routes verify user role and redirect unauthorized access.\n\n**Styling**: TailwindCSS v4 with custom theme configuration. The design system uses CSS variables for theming with light/dark mode support built into components.\n\n## Backend Architecture\n\n**API Structure**: RESTful Express server with route handlers in `server/routes.ts`. The API follows conventional HTTP methods:\n- POST `/api/auth/signup` - User registration with role-based profile creation\n- POST `/api/auth/login` - Session-based authentication\n- GET/POST/PATCH `/api/admin/*` - Admin operations\n- GET/POST `/api/broker/*` - Broker operations\n- GET/POST `/api/student/*` - Student operations\n\n**Session Management**: Uses express-session with MemoryStore (for development). Sessions store userId and role for authorization checks.\n\n**Data Layer**: The storage interface (`server/storage.ts`) abstracts database operations, providing type-safe methods for CRUD operations on users, brokers, students, applications, and commissions. This separation allows for easier testing and potential database migration.\n\n**Authentication & Authorization**: \n- Password hashing with bcrypt (10 rounds)\n- Secure random password generation for admin/broker-created accounts\n- Session-based authentication with httpOnly cookies\n- Role-based access control enforced at route level\n- User roles: admin, broker, student\n\n## Database Design\n\n**Schema Organization** (`shared/schema.ts`): Zod schemas define data validation with TypeScript types for type safety.\n\n**MongoDB Collections** (`server/db.ts`): Mongoose models define the database structure:\n- `users` - Authentication and base user information (id, email, password, role)\n- `brokers` - Broker-specific data (commissionRate, status, activeStudents, references users)\n- `students` - Student profiles (references users and optional broker)\n- `applications` - Visa applications (studentId, status, progress, documents)\n- `commissions` - Commission tracking for broker earnings\n- `documents` - Document uploads and status tracking\n- `activities` - Activity logging for notifications\n- `counters` - Auto-incrementing ID sequences\n\n**Key Relationships**:\n- Users have a one-to-one relationship with either brokers or students based on role\n- Students can be assigned to one broker (nullable brokerId)\n- Applications belong to students\n- Commissions are tied to brokers and applications\n\n**Status Enums** (validated via Zod):\n- `role`: admin, broker, student\n- `application_status`: Document Review, Submitted, Interview, Approved, Rejected\n- `commission_status`: Pending, Approved, Paid, Rejected\n- `document_status`: Pending, Approved, Rejected\n\n## Build System\n\n**Development**: \n- Client runs on Vite dev server (port 5000)\n- Server runs with tsx for TypeScript execution\n- Hot module replacement enabled for frontend\n\n**Production Build** (`script/build.ts`):\n- Vite builds the client to `dist/public`\n- esbuild bundles the server to `dist/index.cjs`\n- Selective dependency bundling: Core dependencies are bundled (allowlist) to reduce cold start times; others remain external\n- Single executable output for deployment\n\n**TypeScript Configuration**: Shared tsconfig.json with path aliases:\n- `@/*` → client source\n- `@shared/*` → shared schema/types\n- Module resolution set to \"bundler\" for Vite compatibility\n\n# External Dependencies\n\n**UI Framework**: Radix UI provides headless, accessible component primitives (dialogs, dropdowns, accordions, etc.). shadcn/ui wraps these with styled implementations.\n\n**Database**: \n- MongoDB via Mongoose ODM\n- Connection managed via MONGODB_URI environment variable\n- Auto-incrementing IDs using counter collection pattern\n\n**Authentication**: bcryptjs for password hashing (no native dependencies for cross-platform compatibility)\n\n**Styling**: \n- TailwindCSS for utility-first styling\n- class-variance-authority (cva) for component variant management\n- Framer Motion for animations\n\n**Development Tools**:\n- Replit-specific plugins (vite-plugin-runtime-error-modal, vite-plugin-cartographer, vite-plugin-dev-banner)\n- Custom meta-images plugin for OpenGraph image URL updates\n\n**State & Data Fetching**: TanStack Query v5 manages server state with caching, refetching, and synchronization\n\n**Forms**: React Hook Form with Zod resolvers (@hookform/resolvers) for validation\n\n**Date Handling**: date-fns for date manipulation and formatting\n\n# Environment Variables\n\n- `MONGODB_URI` - MongoDB connection string (required)\n- `SESSION_SECRET` - Session encryption key (optional, has default for development)\n- `NODE_ENV` - Environment mode (development/production)\n- `PORT` - Server port (default: 5000)\n\nThe application is designed for deployment on Replit with environment-based configuration and support for both development and production environments.\n","path":null,"size_bytes":8194,"size_tokens":null},"client/src/components/ui/item.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Separator } from \"@/components/ui/separator\"\n\nfunction ItemGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      role=\"list\"\n      data-slot=\"item-group\"\n      className={cn(\"group/item-group flex flex-col\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction ItemSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"item-separator\"\n      orientation=\"horizontal\"\n      className={cn(\"my-0\", className)}\n      {...props}\n    />\n  )\n}\n\nconst itemVariants = cva(\n  \"group/item [a]:hover:bg-accent/50 focus-visible:border-ring focus-visible:ring-ring/50 [a]:transition-colors flex flex-wrap items-center rounded-md border border-transparent text-sm outline-none transition-colors duration-100 focus-visible:ring-[3px]\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline: \"border-border\",\n        muted: \"bg-muted/50\",\n      },\n      size: {\n        default: \"gap-4 p-4 \",\n        sm: \"gap-2.5 px-4 py-3\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Item({\n  className,\n  variant = \"default\",\n  size = \"default\",\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> &\n  VariantProps<typeof itemVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n  return (\n    <Comp\n      data-slot=\"item\"\n      data-variant={variant}\n      data-size={size}\n      className={cn(itemVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nconst itemMediaVariants = cva(\n  \"flex shrink-0 items-center justify-center gap-2 group-has-[[data-slot=item-description]]/item:translate-y-0.5 group-has-[[data-slot=item-description]]/item:self-start [&_svg]:pointer-events-none\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        icon: \"bg-muted size-8 rounded-sm border [&_svg:not([class*='size-'])]:size-4\",\n        image:\n          \"size-10 overflow-hidden rounded-sm [&_img]:size-full [&_img]:object-cover\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction ItemMedia({\n  className,\n  variant = \"default\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof itemMediaVariants>) {\n  return (\n    <div\n      data-slot=\"item-media\"\n      data-variant={variant}\n      className={cn(itemMediaVariants({ variant, className }))}\n      {...props}\n    />\n  )\n}\n\nfunction ItemContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-content\"\n      className={cn(\n        \"flex flex-1 flex-col gap-1 [&+[data-slot=item-content]]:flex-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-title\"\n      className={cn(\n        \"flex w-fit items-center gap-2 text-sm font-medium leading-snug\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <p\n      data-slot=\"item-description\"\n      className={cn(\n        \"text-muted-foreground line-clamp-2 text-balance text-sm font-normal leading-normal\",\n        \"[&>a:hover]:text-primary [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemActions({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-actions\"\n      className={cn(\"flex items-center gap-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction ItemHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-header\"\n      className={cn(\n        \"flex basis-full items-center justify-between gap-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-footer\"\n      className={cn(\n        \"flex basis-full items-center justify-between gap-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Item,\n  ItemMedia,\n  ItemContent,\n  ItemActions,\n  ItemGroup,\n  ItemSeparator,\n  ItemTitle,\n  ItemDescription,\n  ItemHeader,\n  ItemFooter,\n}\n","path":null,"size_bytes":4494,"size_tokens":null},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","path":null,"size_bytes":565,"size_tokens":null},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","path":null,"size_bytes":21846,"size_tokens":null},"client/src/pages/admin/brokers.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation, useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport { DashboardLayout } from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Plus, MoreHorizontal, Edit, Percent, Key, DollarSign } from \"lucide-react\";\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from \"@/components/ui/dropdown-menu\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger, DialogFooter } from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { adminApi } from \"@/lib/api\";\n\nexport default function AdminBrokers() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isAddOpen, setIsAddOpen] = useState(false);\n  const [isEditOpen, setIsEditOpen] = useState(false);\n  const [isPasswordOpen, setIsPasswordOpen] = useState(false);\n  const [selectedBroker, setSelectedBroker] = useState<any>(null);\n  const [editForm, setEditForm] = useState({ commissionRate: \"\", commissionAmount: \"\", phone: \"\", companyName: \"\" });\n  const [newPassword, setNewPassword] = useState(\"\");\n  const [newBroker, setNewBroker] = useState({ name: \"\", email: \"\" });\n\n  const { data: brokers = [], isLoading } = useQuery({\n    queryKey: [\"admin\", \"brokers\"],\n    queryFn: adminApi.getBrokers,\n  });\n\n  const [createdCredentials, setCreatedCredentials] = useState<{ email: string; password: string } | null>(null);\n  const [isCredentialsOpen, setIsCredentialsOpen] = useState(false);\n\n  const createMutation = useMutation({\n    mutationFn: adminApi.createBroker,\n    onSuccess: (data: any) => {\n      queryClient.invalidateQueries({ queryKey: [\"admin\", \"brokers\"] });\n      setIsAddOpen(false);\n      setCreatedCredentials({ email: newBroker.email, password: data.temporaryPassword });\n      setIsCredentialsOpen(true);\n      setNewBroker({ name: \"\", email: \"\" });\n    },\n    onError: (error: any) => {\n      toast({ \n        title: \"Error\", \n        description: error.message || \"Failed to add broker\",\n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const statusMutation = useMutation({\n    mutationFn: ({ brokerId, status }: { brokerId: number; status: string }) =>\n      adminApi.updateBrokerStatus(brokerId, status),\n    onSuccess: (_, variables) => {\n      queryClient.invalidateQueries({ queryKey: [\"admin\", \"brokers\"] });\n      toast({ title: \"Status Updated\", description: `Broker status changed to ${variables.status}.` });\n    },\n    onError: (error: any) => {\n      toast({ \n        title: \"Error\", \n        description: error.message || \"Failed to update status\",\n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ brokerId, data }: { brokerId: number; data: any }) =>\n      adminApi.updateBroker(brokerId, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"admin\", \"brokers\"] });\n      setIsEditOpen(false);\n      setSelectedBroker(null);\n      toast({ title: \"Broker Updated\", description: \"Broker details have been updated.\" });\n    },\n    onError: (error: any) => {\n      toast({ \n        title: \"Error\", \n        description: error.message || \"Failed to update broker\",\n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const passwordMutation = useMutation({\n    mutationFn: ({ brokerId, newPassword }: { brokerId: number; newPassword: string }) =>\n      adminApi.changeBrokerPassword(brokerId, newPassword),\n    onSuccess: () => {\n      setIsPasswordOpen(false);\n      setSelectedBroker(null);\n      setNewPassword(\"\");\n      toast({ title: \"Password Updated\", description: \"Broker password has been changed successfully.\" });\n    },\n    onError: (error: any) => {\n      toast({ \n        title: \"Error\", \n        description: error.message || \"Failed to change password\",\n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const openEditDialog = (broker: any) => {\n    setSelectedBroker(broker);\n    setEditForm({\n      commissionRate: broker.commissionRate?.replace(\"%\", \"\") || \"10\",\n      commissionAmount: broker.commissionAmount?.toString() || \"\",\n      phone: broker.phone || \"\",\n      companyName: broker.companyName || \"\",\n    });\n    setIsEditOpen(true);\n  };\n\n  const openPasswordDialog = (broker: any) => {\n    setSelectedBroker(broker);\n    setNewPassword(\"\");\n    setIsPasswordOpen(true);\n  };\n\n  const handleUpdateBroker = () => {\n    if (!selectedBroker) return;\n    \n    const commissionRate = `${editForm.commissionRate || \"10\"}%`;\n    const commissionAmount = editForm.commissionAmount ? parseFloat(editForm.commissionAmount) : null;\n    \n    const data: any = {\n      commissionRate,\n      commissionAmount,\n      phone: editForm.phone || null,\n      companyName: editForm.companyName || null,\n    };\n    \n    updateMutation.mutate({ brokerId: selectedBroker.id, data });\n  };\n\n  const handleChangePassword = () => {\n    if (!selectedBroker || !newPassword) return;\n    if (newPassword.length < 6) {\n      toast({ title: \"Error\", description: \"Password must be at least 6 characters\", variant: \"destructive\" });\n      return;\n    }\n    passwordMutation.mutate({ brokerId: selectedBroker.id, newPassword });\n  };\n\n  const handleAddBroker = () => {\n    if (!newBroker.name || !newBroker.email) {\n      toast({ title: \"Error\", description: \"Please fill in all fields\", variant: \"destructive\" });\n      return;\n    }\n    createMutation.mutate(newBroker);\n  };\n\n  const toggleStatus = (broker: any) => {\n    const newStatus = broker.status === \"Active\" ? \"Inactive\" : \"Active\";\n    statusMutation.mutate({ brokerId: broker.id, status: newStatus });\n  };\n\n  if (isLoading) {\n    return (\n      <DashboardLayout role=\"admin\">\n        <div className=\"flex items-center justify-center h-64\">\n          <p className=\"text-muted-foreground\">Loading brokers...</p>\n        </div>\n      </DashboardLayout>\n    );\n  }\n\n  return (\n    <DashboardLayout role=\"admin\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-3xl font-display font-bold text-white\">Manage Brokers</h1>\n          <p className=\"text-muted-foreground\">Add, edit, and manage your visa consultants.</p>\n        </div>\n        \n        <Dialog open={isAddOpen} onOpenChange={setIsAddOpen}>\n          <DialogTrigger asChild>\n            <Button className=\"bg-primary text-primary-foreground hover:bg-primary/90\">\n              <Plus className=\"w-4 h-4 mr-2\" /> Add Broker\n            </Button>\n          </DialogTrigger>\n          <DialogContent className=\"bg-card border-white/10\">\n            <DialogHeader>\n              <DialogTitle>Add New Broker</DialogTitle>\n            </DialogHeader>\n            <div className=\"space-y-4 py-4\">\n              <div className=\"space-y-2\">\n                <Label>Full Name</Label>\n                <Input \n                  placeholder=\"Jane Doe\" \n                  className=\"bg-white/5 border-white/10\"\n                  value={newBroker.name}\n                  onChange={(e) => setNewBroker({...newBroker, name: e.target.value})}\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Email Address</Label>\n                <Input \n                  placeholder=\"jane@visaflow.com\" \n                  className=\"bg-white/5 border-white/10\"\n                  value={newBroker.email}\n                  onChange={(e) => setNewBroker({...newBroker, email: e.target.value})}\n                />\n              </div>\n            </div>\n            <DialogFooter>\n              <Button variant=\"ghost\" onClick={() => setIsAddOpen(false)}>Cancel</Button>\n              <Button onClick={handleAddBroker}>Create Account</Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      <Card className=\"glass-panel border-white/5\">\n        <CardHeader>\n          <CardTitle>All Brokers</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <Table>\n            <TableHeader>\n              <TableRow className=\"border-white/10 hover:bg-white/5\">\n                <TableHead>Name</TableHead>\n                <TableHead>Email</TableHead>\n                <TableHead>Active Students</TableHead>\n                <TableHead>Commission Rate</TableHead>\n                <TableHead>Commission ($)</TableHead>\n                <TableHead>Status</TableHead>\n                <TableHead className=\"text-right\">Actions</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {brokers.map((broker: any) => (\n                <TableRow key={broker.id} className=\"border-white/10 hover:bg-white/5\">\n                  <TableCell className=\"font-medium\">{broker.user?.name || \"N/A\"}</TableCell>\n                  <TableCell>{broker.user?.email || \"N/A\"}</TableCell>\n                  <TableCell>{broker.activeStudents}</TableCell>\n                  <TableCell>{broker.commissionRate}</TableCell>\n                  <TableCell>{broker.commissionAmount ? `$${broker.commissionAmount}` : \"-\"}</TableCell>\n                  <TableCell>\n                    <Badge variant=\"outline\" className={broker.status === \"Active\" ? \"bg-green-500/10 text-green-500 border-green-500/20\" : \"bg-gray-500/10 text-gray-500 border-gray-500/20\"}>\n                      {broker.status}\n                    </Badge>\n                  </TableCell>\n                  <TableCell className=\"text-right\">\n                    <DropdownMenu>\n                      <DropdownMenuTrigger asChild>\n                        <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\">\n                          <MoreHorizontal className=\"w-4 h-4\" />\n                        </Button>\n                      </DropdownMenuTrigger>\n                      <DropdownMenuContent align=\"end\" className=\"bg-card border-white/10\">\n                        <DropdownMenuItem onClick={() => openEditDialog(broker)} data-testid={`edit-broker-${broker.id}`}>\n                          <Edit className=\"w-4 h-4 mr-2\" /> Edit Details\n                        </DropdownMenuItem>\n                        <DropdownMenuItem onClick={() => openPasswordDialog(broker)} data-testid={`password-broker-${broker.id}`}>\n                          <Key className=\"w-4 h-4 mr-2\" /> Change Password\n                        </DropdownMenuItem>\n                        <DropdownMenuItem onClick={() => toast({ title: \"Performance\", description: \"Opening performance metrics...\" })}>\n                          View Performance\n                        </DropdownMenuItem>\n                        <DropdownMenuItem \n                          className={broker.status === \"Active\" ? \"text-destructive\" : \"text-green-500\"}\n                          onClick={() => toggleStatus(broker)}\n                        >\n                          {broker.status === \"Active\" ? \"Deactivate\" : \"Activate\"}\n                        </DropdownMenuItem>\n                      </DropdownMenuContent>\n                    </DropdownMenu>\n                  </TableCell>\n                </TableRow>\n              ))}\n            </TableBody>\n          </Table>\n        </CardContent>\n      </Card>\n\n      <Dialog open={isEditOpen} onOpenChange={setIsEditOpen}>\n        <DialogContent className=\"bg-card border-white/10\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <Percent className=\"w-5 h-5\" /> Edit Broker Details\n            </DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"p-3 bg-white/5 rounded-lg mb-4\">\n              <p className=\"text-sm text-muted-foreground\">Editing: <span className=\"text-white font-medium\">{selectedBroker?.user?.name}</span></p>\n            </div>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label>Commission Rate (%)</Label>\n                <div className=\"relative\">\n                  <Input \n                    type=\"number\"\n                    min=\"0\"\n                    max=\"100\"\n                    placeholder=\"10\" \n                    className=\"bg-white/5 border-white/10 pr-8\"\n                    value={editForm.commissionRate}\n                    onChange={(e) => setEditForm({...editForm, commissionRate: e.target.value})}\n                    data-testid=\"input-commission-rate\"\n                  />\n                  <span className=\"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground\">%</span>\n                </div>\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Commission Amount ($)</Label>\n                <div className=\"relative\">\n                  <DollarSign className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\n                  <Input \n                    type=\"number\"\n                    min=\"0\"\n                    step=\"0.01\"\n                    placeholder=\"500\" \n                    className=\"bg-white/5 border-white/10 pl-8\"\n                    value={editForm.commissionAmount}\n                    onChange={(e) => setEditForm({...editForm, commissionAmount: e.target.value})}\n                    data-testid=\"input-commission-amount\"\n                  />\n                </div>\n                <p className=\"text-xs text-muted-foreground\">Fixed dollar amount per application</p>\n              </div>\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Phone</Label>\n              <Input \n                placeholder=\"+1 234 567 8900\" \n                className=\"bg-white/5 border-white/10\"\n                value={editForm.phone}\n                onChange={(e) => setEditForm({...editForm, phone: e.target.value})}\n                data-testid=\"input-broker-phone\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Company Name</Label>\n              <Input \n                placeholder=\"Visa Consultants Inc.\" \n                className=\"bg-white/5 border-white/10\"\n                value={editForm.companyName}\n                onChange={(e) => setEditForm({...editForm, companyName: e.target.value})}\n                data-testid=\"input-broker-company\"\n              />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"ghost\" onClick={() => setIsEditOpen(false)} data-testid=\"cancel-edit-broker\">Cancel</Button>\n            <Button onClick={handleUpdateBroker} disabled={updateMutation.isPending} data-testid=\"save-broker-changes\">\n              {updateMutation.isPending ? \"Saving...\" : \"Save Changes\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={isPasswordOpen} onOpenChange={setIsPasswordOpen}>\n        <DialogContent className=\"bg-card border-white/10\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <Key className=\"w-5 h-5\" /> Change Broker Password\n            </DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"p-3 bg-white/5 rounded-lg\">\n              <p className=\"text-sm text-muted-foreground\">Changing password for: <span className=\"text-white font-medium\">{selectedBroker?.user?.name}</span></p>\n            </div>\n            <div className=\"space-y-2\">\n              <Label>New Password</Label>\n              <Input \n                type=\"password\"\n                placeholder=\"Enter new password (min 6 characters)\" \n                className=\"bg-white/5 border-white/10\"\n                value={newPassword}\n                onChange={(e) => setNewPassword(e.target.value)}\n                data-testid=\"input-new-password\"\n              />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"ghost\" onClick={() => setIsPasswordOpen(false)} data-testid=\"cancel-password\">Cancel</Button>\n            <Button onClick={handleChangePassword} disabled={passwordMutation.isPending} data-testid=\"save-password\">\n              {passwordMutation.isPending ? \"Updating...\" : \"Update Password\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={isCredentialsOpen} onOpenChange={(open) => {\n        if (!open && createdCredentials) {\n          return;\n        }\n        setIsCredentialsOpen(open);\n      }}>\n        <DialogContent className=\"bg-card border-white/10\">\n          <DialogHeader>\n            <DialogTitle>Broker Account Created</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"p-4 bg-green-500/10 border border-green-500/20 rounded-lg\">\n              <p className=\"text-sm text-green-400 mb-3\">Share these login credentials with the new broker:</p>\n              <div className=\"space-y-3\">\n                <div>\n                  <Label className=\"text-muted-foreground text-xs\">Email</Label>\n                  <div className=\"flex items-center gap-2\">\n                    <Input \n                      readOnly \n                      value={createdCredentials?.email || \"\"} \n                      className=\"bg-white/5 border-white/10 font-mono\"\n                      data-testid=\"text-broker-email\"\n                    />\n                    <Button \n                      variant=\"outline\" \n                      size=\"sm\"\n                      onClick={() => {\n                        navigator.clipboard.writeText(createdCredentials?.email || \"\");\n                        toast({ title: \"Copied\", description: \"Email copied to clipboard\" });\n                      }}\n                      data-testid=\"button-copy-broker-email\"\n                    >\n                      Copy\n                    </Button>\n                  </div>\n                </div>\n                <div>\n                  <Label className=\"text-muted-foreground text-xs\">Password</Label>\n                  <div className=\"flex items-center gap-2\">\n                    <Input \n                      readOnly \n                      value={createdCredentials?.password || \"\"} \n                      className=\"bg-white/5 border-white/10 font-mono\"\n                      data-testid=\"text-broker-password\"\n                    />\n                    <Button \n                      variant=\"outline\" \n                      size=\"sm\"\n                      onClick={() => {\n                        navigator.clipboard.writeText(createdCredentials?.password || \"\");\n                        toast({ title: \"Copied\", description: \"Password copied to clipboard\" });\n                      }}\n                      data-testid=\"button-copy-broker-password\"\n                    >\n                      Copy\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <p className=\"text-xs text-muted-foreground\">\n              Please save these credentials securely. The password cannot be retrieved later.\n            </p>\n          </div>\n          <DialogFooter>\n            <Button onClick={() => {\n              setIsCredentialsOpen(false);\n              setCreatedCredentials(null);\n            }} data-testid=\"button-close-credentials\">\n              Done\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </DashboardLayout>\n  );\n}\n","path":null,"size_bytes":19730,"size_tokens":null},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","path":null,"size_bytes":4845,"size_tokens":null},"client/src/components/layout/DashboardLayout.tsx":{"content":"import React, { ReactNode, useEffect } from \"react\";\nimport { Sidebar } from \"./Sidebar\";\nimport { motion } from \"framer-motion\";\nimport { useAuth } from \"@/lib/auth-context\";\nimport { useLocation } from \"wouter\";\nimport { NotificationBar } from \"@/components/NotificationBar\";\n\ninterface DashboardLayoutProps {\n  children: ReactNode;\n  role: \"admin\" | \"broker\" | \"student\";\n}\n\nexport function DashboardLayout({ children, role }: DashboardLayoutProps) {\n  const { user, isAuthenticated } = useAuth();\n  const [, setLocation] = useLocation();\n\n  useEffect(() => {\n    if (!isAuthenticated) {\n      setLocation(\"/login\");\n    } else if (user?.role !== role) {\n      setLocation(`/${user?.role}`);\n    }\n  }, [isAuthenticated, user, role, setLocation]);\n\n  if (!isAuthenticated) return null;\n\n  return (\n    <div className=\"min-h-screen bg-background text-foreground flex\">\n      <Sidebar role={role} />\n      <main className=\"flex-1 md:ml-64 p-4 md:p-8 overflow-x-hidden\">\n        <div className=\"max-w-7xl mx-auto\">\n          <div className=\"flex justify-end mb-4\">\n            <NotificationBar userRole={role} />\n          </div>\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5, delay: 0.2 }}\n            className=\"space-y-8\"\n          >\n            {children}\n          </motion.div>\n        </div>\n      </main>\n    </div>\n  );\n}\n","path":null,"size_bytes":1434,"size_tokens":null},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","path":null,"size_bytes":756,"size_tokens":null},"client/src/components/ui/calendar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport {\n  ChevronDownIcon,\n  ChevronLeftIcon,\n  ChevronRightIcon,\n} from \"lucide-react\"\nimport { DayButton, DayPicker, getDefaultClassNames } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button, buttonVariants } from \"@/components/ui/button\"\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  captionLayout = \"label\",\n  buttonVariant = \"ghost\",\n  formatters,\n  components,\n  ...props\n}: React.ComponentProps<typeof DayPicker> & {\n  buttonVariant?: React.ComponentProps<typeof Button>[\"variant\"]\n}) {\n  const defaultClassNames = getDefaultClassNames()\n\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\n        \"bg-background group/calendar p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent\",\n        String.raw`rtl:**:[.rdp-button\\_next>svg]:rotate-180`,\n        String.raw`rtl:**:[.rdp-button\\_previous>svg]:rotate-180`,\n        className\n      )}\n      captionLayout={captionLayout}\n      formatters={{\n        formatMonthDropdown: (date) =>\n          date.toLocaleString(\"default\", { month: \"short\" }),\n        ...formatters,\n      }}\n      classNames={{\n        root: cn(\"w-fit\", defaultClassNames.root),\n        months: cn(\n          \"relative flex flex-col gap-4 md:flex-row\",\n          defaultClassNames.months\n        ),\n        month: cn(\"flex w-full flex-col gap-4\", defaultClassNames.month),\n        nav: cn(\n          \"absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1\",\n          defaultClassNames.nav\n        ),\n        button_previous: cn(\n          buttonVariants({ variant: buttonVariant }),\n          \"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50\",\n          defaultClassNames.button_previous\n        ),\n        button_next: cn(\n          buttonVariants({ variant: buttonVariant }),\n          \"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50\",\n          defaultClassNames.button_next\n        ),\n        month_caption: cn(\n          \"flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]\",\n          defaultClassNames.month_caption\n        ),\n        dropdowns: cn(\n          \"flex h-[--cell-size] w-full items-center justify-center gap-1.5 text-sm font-medium\",\n          defaultClassNames.dropdowns\n        ),\n        dropdown_root: cn(\n          \"has-focus:border-ring border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] relative rounded-md border\",\n          defaultClassNames.dropdown_root\n        ),\n        dropdown: cn(\n          \"bg-popover absolute inset-0 opacity-0\",\n          defaultClassNames.dropdown\n        ),\n        caption_label: cn(\n          \"select-none font-medium\",\n          captionLayout === \"label\"\n            ? \"text-sm\"\n            : \"[&>svg]:text-muted-foreground flex h-8 items-center gap-1 rounded-md pl-2 pr-1 text-sm [&>svg]:size-3.5\",\n          defaultClassNames.caption_label\n        ),\n        table: \"w-full border-collapse\",\n        weekdays: cn(\"flex\", defaultClassNames.weekdays),\n        weekday: cn(\n          \"text-muted-foreground flex-1 select-none rounded-md text-[0.8rem] font-normal\",\n          defaultClassNames.weekday\n        ),\n        week: cn(\"mt-2 flex w-full\", defaultClassNames.week),\n        week_number_header: cn(\n          \"w-[--cell-size] select-none\",\n          defaultClassNames.week_number_header\n        ),\n        week_number: cn(\n          \"text-muted-foreground select-none text-[0.8rem]\",\n          defaultClassNames.week_number\n        ),\n        day: cn(\n          \"group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md\",\n          defaultClassNames.day\n        ),\n        range_start: cn(\n          \"bg-accent rounded-l-md\",\n          defaultClassNames.range_start\n        ),\n        range_middle: cn(\"rounded-none\", defaultClassNames.range_middle),\n        range_end: cn(\"bg-accent rounded-r-md\", defaultClassNames.range_end),\n        today: cn(\n          \"bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none\",\n          defaultClassNames.today\n        ),\n        outside: cn(\n          \"text-muted-foreground aria-selected:text-muted-foreground\",\n          defaultClassNames.outside\n        ),\n        disabled: cn(\n          \"text-muted-foreground opacity-50\",\n          defaultClassNames.disabled\n        ),\n        hidden: cn(\"invisible\", defaultClassNames.hidden),\n        ...classNames,\n      }}\n      components={{\n        Root: ({ className, rootRef, ...props }) => {\n          return (\n            <div\n              data-slot=\"calendar\"\n              ref={rootRef}\n              className={cn(className)}\n              {...props}\n            />\n          )\n        },\n        Chevron: ({ className, orientation, ...props }) => {\n          if (orientation === \"left\") {\n            return (\n              <ChevronLeftIcon className={cn(\"size-4\", className)} {...props} />\n            )\n          }\n\n          if (orientation === \"right\") {\n            return (\n              <ChevronRightIcon\n                className={cn(\"size-4\", className)}\n                {...props}\n              />\n            )\n          }\n\n          return (\n            <ChevronDownIcon className={cn(\"size-4\", className)} {...props} />\n          )\n        },\n        DayButton: CalendarDayButton,\n        WeekNumber: ({ children, ...props }) => {\n          return (\n            <td {...props}>\n              <div className=\"flex size-[--cell-size] items-center justify-center text-center\">\n                {children}\n              </div>\n            </td>\n          )\n        },\n        ...components,\n      }}\n      {...props}\n    />\n  )\n}\n\nfunction CalendarDayButton({\n  className,\n  day,\n  modifiers,\n  ...props\n}: React.ComponentProps<typeof DayButton>) {\n  const defaultClassNames = getDefaultClassNames()\n\n  const ref = React.useRef<HTMLButtonElement>(null)\n  React.useEffect(() => {\n    if (modifiers.focused) ref.current?.focus()\n  }, [modifiers.focused])\n\n  return (\n    <Button\n      ref={ref}\n      variant=\"ghost\"\n      size=\"icon\"\n      data-day={day.date.toLocaleDateString()}\n      data-selected-single={\n        modifiers.selected &&\n        !modifiers.range_start &&\n        !modifiers.range_end &&\n        !modifiers.range_middle\n      }\n      data-range-start={modifiers.range_start}\n      data-range-end={modifiers.range_end}\n      data-range-middle={modifiers.range_middle}\n      className={cn(\n        \"data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] [&>span]:text-xs [&>span]:opacity-70\",\n        defaultClassNames.day,\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Calendar, CalendarDayButton }\n","path":null,"size_bytes":7569,"size_tokens":null},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // @replit\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \",\n  {\n    variants: {\n      variant: {\n        default:\n          // @replit shadow-xs instead of shadow, no hover because we use hover-elevate\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary:\n          // @replit no hover because we use hover-elevate\n          \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          // @replit shadow-xs instead of shadow, no hover because we use hover-elevate\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n          // @replit shadow-xs\" - use badge outline variable\n        outline: \"text-foreground border [border-color:var(--badge-outline)]\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","path":null,"size_bytes":1522,"size_tokens":null},"client/src/pages/auth/signup.tsx":{"content":"import { useState } from \"react\";\nimport { Link } from \"wouter\";\nimport { motion } from \"framer-motion\";\nimport { User, Lock, Mail, ArrowRight, Shield, Briefcase, GraduationCap } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { useAuth } from \"@/lib/auth-context\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { fetchAdmins } from \"@/lib/api\";\n\nexport default function SignupPage() {\n  const { signup } = useAuth();\n  const { toast } = useToast();\n  const [role, setRole] = useState<\"student\" | \"broker\" | \"admin\">(\"student\");\n  const [name, setName] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [adminId, setAdminId] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n\n  const { data: admins = [] } = useQuery({\n    queryKey: [\"admins-public\"],\n    queryFn: async () => {\n      const response = await fetch(\"/api/admins/public\");\n      if (!response.ok) return [];\n      return response.json();\n    },\n  });\n\n  const handleSignup = async () => {\n    if (!name || !email || !password) {\n      toast({\n        title: \"Missing information\",\n        description: \"Please fill in all fields.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if ((role === \"student\" || role === \"broker\") && !adminId) {\n      toast({\n        title: \"Missing information\",\n        description: \"Please select an admin to work with.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsLoading(true);\n    \n    try {\n      await signup(role, name, email, password, adminId ? parseInt(adminId) : undefined);\n      toast({\n        title: \"Account created!\",\n        description: `Welcome to VisaFlow, ${name}.`,\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Signup failed\",\n        description: error.message || \"Could not create account. Please try again.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center relative overflow-hidden p-4 bg-background\">\n      {/* Background Elements */}\n      <div className=\"absolute top-0 left-0 w-full h-full bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 -z-10\"></div>\n      <div className=\"absolute bottom-1/4 left-1/4 w-96 h-96 bg-accent/10 rounded-full blur-[100px] -z-10\" />\n      <div className=\"absolute top-1/4 right-1/4 w-96 h-96 bg-primary/10 rounded-full blur-[100px] -z-10\" />\n\n      <motion.div\n        initial={{ opacity: 0, scale: 0.95 }}\n        animate={{ opacity: 1, scale: 1 }}\n        transition={{ duration: 0.5 }}\n        className=\"w-full max-w-md\"\n      >\n        <Card className=\"glass-panel border-white/10\">\n          <CardHeader className=\"text-center space-y-2\">\n            <CardTitle className=\"text-3xl font-display font-bold text-gradient\">Create Account</CardTitle>\n            <CardDescription>Join the future of visa consultancy</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            \n            {/* Role Selection */}\n            <div className=\"grid grid-cols-3 gap-3\">\n              <div \n                onClick={() => setRole(\"student\")}\n                data-testid=\"role-student\"\n                className={`cursor-pointer p-4 rounded-xl border transition-all duration-300 flex flex-col items-center gap-2 text-center ${\n                  role === \"student\" \n                    ? \"bg-primary/10 border-primary text-primary shadow-[0_0_15px_-5px_hsl(var(--primary)/0.3)]\" \n                    : \"bg-white/5 border-white/10 text-muted-foreground hover:bg-white/10\"\n                }`}\n              >\n                <GraduationCap className=\"w-6 h-6\" />\n                <span className=\"text-sm font-medium\">Student</span>\n              </div>\n              <div \n                onClick={() => setRole(\"broker\")}\n                data-testid=\"role-broker\"\n                className={`cursor-pointer p-4 rounded-xl border transition-all duration-300 flex flex-col items-center gap-2 text-center ${\n                  role === \"broker\" \n                    ? \"bg-secondary/10 border-secondary text-secondary shadow-[0_0_15px_-5px_hsl(var(--secondary)/0.3)]\" \n                    : \"bg-white/5 border-white/10 text-muted-foreground hover:bg-white/10\"\n                }`}\n              >\n                <Briefcase className=\"w-6 h-6\" />\n                <span className=\"text-sm font-medium\">Broker</span>\n              </div>\n              <div \n                onClick={() => setRole(\"admin\")}\n                data-testid=\"role-admin\"\n                className={`cursor-pointer p-4 rounded-xl border transition-all duration-300 flex flex-col items-center gap-2 text-center ${\n                  role === \"admin\" \n                    ? \"bg-accent/10 border-accent text-accent shadow-[0_0_15px_-5px_hsl(var(--accent)/0.3)]\" \n                    : \"bg-white/5 border-white/10 text-muted-foreground hover:bg-white/10\"\n                }`}\n              >\n                <Shield className=\"w-6 h-6\" />\n                <span className=\"text-sm font-medium\">Admin</span>\n              </div>\n            </div>\n\n            <div className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label>Full Name</Label>\n                <div className=\"relative\">\n                  <User className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                  <Input \n                    placeholder=\"John Doe\" \n                    className=\"pl-10 bg-white/5 border-white/10\"\n                    value={name}\n                    onChange={(e) => setName(e.target.value)}\n                    data-testid=\"input-name\"\n                  />\n                </div>\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Email</Label>\n                <div className=\"relative\">\n                  <Mail className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                  <Input \n                    placeholder=\"name@example.com\" \n                    className=\"pl-10 bg-white/5 border-white/10\"\n                    value={email}\n                    onChange={(e) => setEmail(e.target.value)}\n                    data-testid=\"input-email\"\n                  />\n                </div>\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Password</Label>\n                <div className=\"relative\">\n                  <Lock className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                  <Input \n                    type=\"password\" \n                    className=\"pl-10 bg-white/5 border-white/10\"\n                    value={password}\n                    onChange={(e) => setPassword(e.target.value)}\n                    data-testid=\"input-password\"\n                  />\n                </div>\n              </div>\n              \n              {(role === \"student\" || role === \"broker\") && (\n                <div className=\"space-y-2\">\n                  <Label>Select Admin</Label>\n                  <Select value={adminId} onValueChange={setAdminId}>\n                    <SelectTrigger className=\"bg-white/5 border-white/10\" data-testid=\"select-admin\">\n                      <SelectValue placeholder=\"Choose an admin to work with\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {admins.length === 0 ? (\n                        <div className=\"p-2 text-center text-sm text-muted-foreground\">No admins available yet</div>\n                      ) : (\n                        admins.map((admin: any) => (\n                          <SelectItem key={admin.id} value={String(admin.id)}>\n                            {admin.name}\n                          </SelectItem>\n                        ))\n                      )}\n                    </SelectContent>\n                  </Select>\n                  <p className=\"text-xs text-muted-foreground\">\n                    This admin will manage your account and visa applications.\n                  </p>\n                </div>\n              )}\n            </div>\n\n            <Button \n              className=\"w-full bg-gradient-to-r from-primary to-secondary hover:opacity-90 transition-opacity\" \n              onClick={handleSignup}\n              disabled={isLoading}\n              data-testid=\"button-signup\"\n            >\n              {isLoading ? \"Creating Account...\" : \"Create Account\"} <ArrowRight className=\"w-4 h-4 ml-2\" />\n            </Button>\n            \n            <div className=\"text-center text-sm text-muted-foreground\">\n              <p>Already have an account? <Link href=\"/login\" className=\"text-primary hover:underline\">Log in</Link></p>\n            </div>\n          </CardContent>\n        </Card>\n      </motion.div>\n    </div>\n  );\n}\n","path":null,"size_bytes":9245,"size_tokens":null},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":1383,"size_tokens":null},"client/src/pages/student/broker-info.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { DashboardLayout } from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Mail, Phone, MapPin, Building2, UserCheck, AlertCircle } from \"lucide-react\";\nimport { studentApi, commonApi } from \"@/lib/api\";\nimport { motion } from \"framer-motion\";\nimport { Link } from \"wouter\";\n\nexport default function StudentBrokerInfo() {\n  const { data: brokerData, isLoading } = useQuery({\n    queryKey: [\"student\", \"broker\"],\n    queryFn: studentApi.getAssignedBroker,\n  });\n\n  const broker = brokerData?.broker;\n\n  if (isLoading) {\n    return (\n      <DashboardLayout role=\"student\">\n        <div className=\"flex items-center justify-center h-64\">\n          <p className=\"text-muted-foreground\">Loading broker info...</p>\n        </div>\n      </DashboardLayout>\n    );\n  }\n\n  if (!broker) {\n    return (\n      <DashboardLayout role=\"student\">\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-3xl font-display font-bold text-white\">My Broker</h1>\n            <p className=\"text-muted-foreground\">Your assigned visa consultant.</p>\n          </div>\n        </div>\n\n        <Card className=\"glass-panel border-white/5 max-w-2xl mx-auto mt-8\">\n          <CardContent className=\"p-8 flex flex-col items-center text-center space-y-6\">\n            <div className=\"w-24 h-24 rounded-full bg-muted/20 flex items-center justify-center\">\n              <AlertCircle className=\"w-12 h-12 text-muted-foreground\" />\n            </div>\n            <div>\n              <h2 className=\"text-xl font-bold text-white mb-2\">No Broker Assigned</h2>\n              <p className=\"text-muted-foreground max-w-md\">\n                You haven't been assigned a broker yet. An admin will assign a broker to you soon, \n                or you can contact support for assistance.\n              </p>\n            </div>\n            <Link href=\"/student\">\n              <Button variant=\"outline\" className=\"border-white/10\" data-testid=\"button-back-dashboard\">\n                Back to Dashboard\n              </Button>\n            </Link>\n          </CardContent>\n        </Card>\n      </DashboardLayout>\n    );\n  }\n\n  const getInitials = (name: string) => {\n    return name\n      .split(\" \")\n      .map((n) => n[0])\n      .join(\"\")\n      .toUpperCase()\n      .slice(0, 2);\n  };\n\n  return (\n    <DashboardLayout role=\"student\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-3xl font-display font-bold text-white\">My Broker</h1>\n          <p className=\"text-muted-foreground\">Contact your assigned visa consultant.</p>\n        </div>\n      </div>\n\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.3 }}\n      >\n        <Card className=\"glass-panel border-white/5 max-w-2xl mx-auto mt-8\" data-testid=\"card-broker-info\">\n          <CardContent className=\"p-8 flex flex-col items-center text-center space-y-6\">\n            <Avatar className=\"w-32 h-32 border-4 border-secondary/20\">\n              <AvatarFallback className=\"text-4xl font-bold bg-gradient-to-br from-primary to-secondary text-white\">\n                {getInitials(broker.user?.name || \"Broker\")}\n              </AvatarFallback>\n            </Avatar>\n\n            <div>\n              <h2 className=\"text-2xl font-bold text-white\" data-testid=\"text-broker-name\">\n                {broker.user?.name || \"Broker\"}\n              </h2>\n              <p className=\"text-secondary font-medium\">Visa Consultant</p>\n              <Badge \n                variant=\"outline\" \n                className={`mt-2 ${\n                  broker.status === \"Active\" \n                    ? \"bg-green-500/10 text-green-500 border-green-500/20\" \n                    : \"bg-gray-500/10 text-gray-500 border-gray-500/20\"\n                }`}\n                data-testid=\"status-broker\"\n              >\n                {broker.status}\n              </Badge>\n            </div>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 w-full\">\n              {broker.user?.email && (\n                <a href={`mailto:${broker.user.email}`}>\n                  <Button \n                    variant=\"outline\" \n                    className=\"border-white/10 hover:bg-white/5 flex flex-col h-auto py-4 gap-2 w-full\"\n                    data-testid=\"button-email-broker\"\n                  >\n                    <Mail className=\"w-6 h-6 text-primary\" />\n                    <span className=\"text-xs\">Email</span>\n                  </Button>\n                </a>\n              )}\n              {broker.phone && (\n                <a href={`tel:${broker.phone}`}>\n                  <Button \n                    variant=\"outline\" \n                    className=\"border-white/10 hover:bg-white/5 flex flex-col h-auto py-4 gap-2 w-full\"\n                    data-testid=\"button-call-broker\"\n                  >\n                    <Phone className=\"w-6 h-6 text-secondary\" />\n                    <span className=\"text-xs\">Call</span>\n                  </Button>\n                </a>\n              )}\n              {broker.address && (\n                <Button \n                  variant=\"outline\" \n                  className=\"border-white/10 hover:bg-white/5 flex flex-col h-auto py-4 gap-2\"\n                  data-testid=\"button-address-broker\"\n                >\n                  <MapPin className=\"w-6 h-6 text-accent\" />\n                  <span className=\"text-xs\">Office</span>\n                </Button>\n              )}\n            </div>\n\n            <div className=\"w-full bg-white/5 rounded-xl p-6 text-left space-y-4\">\n              <h3 className=\"font-bold border-b border-white/10 pb-2\">Contact Details</h3>\n              <div className=\"space-y-3 text-sm\">\n                <div className=\"flex justify-between\">\n                  <span className=\"text-muted-foreground\">Email:</span>\n                  <span data-testid=\"text-broker-email\">{broker.user?.email || \"Not provided\"}</span>\n                </div>\n                {broker.phone && (\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-muted-foreground\">Phone:</span>\n                    <span data-testid=\"text-broker-phone\">{broker.phone}</span>\n                  </div>\n                )}\n                {broker.companyName && (\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-muted-foreground\">Company:</span>\n                    <span data-testid=\"text-broker-company\">{broker.companyName}</span>\n                  </div>\n                )}\n                {broker.address && (\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-muted-foreground\">Address:</span>\n                    <span data-testid=\"text-broker-address\">{broker.address}</span>\n                  </div>\n                )}\n                {broker.licenseNumber && (\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-muted-foreground\">License:</span>\n                    <span data-testid=\"text-broker-license\">{broker.licenseNumber}</span>\n                  </div>\n                )}\n              </div>\n            </div>\n\n            <Card className=\"w-full bg-primary/10 border-primary/20\">\n              <CardContent className=\"p-4 flex items-start gap-3\">\n                <UserCheck className=\"w-5 h-5 text-primary mt-0.5\" />\n                <div className=\"text-left text-sm\">\n                  <p className=\"font-medium text-primary\">Your Dedicated Consultant</p>\n                  <p className=\"text-muted-foreground\">\n                    This broker has been assigned to help you with your visa application process. \n                    Feel free to reach out with any questions.\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n          </CardContent>\n        </Card>\n      </motion.div>\n    </DashboardLayout>\n  );\n}\n","path":null,"size_bytes":8262,"size_tokens":null},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { AuthProvider } from \"@/lib/auth-context\";\nimport NotFound from \"@/pages/not-found\";\nimport Home from \"@/pages/home\";\nimport LoginPage from \"@/pages/auth/login\";\nimport SignupPage from \"@/pages/auth/signup\";\n\n// Admin Pages\nimport AdminDashboard from \"@/pages/admin/dashboard\";\nimport AdminBrokers from \"@/pages/admin/brokers\";\nimport AdminStudents from \"@/pages/admin/students\";\nimport AdminCommissions from \"@/pages/admin/commissions\";\nimport AdminSettings from \"@/pages/admin/settings\";\n\n// Broker Pages\nimport BrokerDashboard from \"@/pages/broker/dashboard\";\nimport BrokerStudents from \"@/pages/broker/students\";\nimport BrokerApplications from \"@/pages/broker/applications\";\nimport BrokerEarnings from \"@/pages/broker/earnings\";\nimport BrokerProfile from \"@/pages/broker/profile\";\n\n// Student Pages\nimport StudentDashboard from \"@/pages/student/dashboard\";\nimport StudentApplication from \"@/pages/student/application\";\nimport StudentBrokerInfo from \"@/pages/student/broker-info\";\nimport StudentProfile from \"@/pages/student/profile\";\nimport StudentDocuments from \"@/pages/student/documents\";\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={Home} />\n      <Route path=\"/login\" component={LoginPage} />\n      <Route path=\"/signup\" component={SignupPage} />\n      \n      {/* Admin Routes */}\n      <Route path=\"/admin\" component={AdminDashboard} />\n      <Route path=\"/admin/brokers\" component={AdminBrokers} />\n      <Route path=\"/admin/students\" component={AdminStudents} />\n      <Route path=\"/admin/commissions\" component={AdminCommissions} />\n      <Route path=\"/admin/settings\" component={AdminSettings} />\n      \n      {/* Broker Routes */}\n      <Route path=\"/broker\" component={BrokerDashboard} />\n      <Route path=\"/broker/students\" component={BrokerStudents} />\n      <Route path=\"/broker/applications\" component={BrokerApplications} />\n      <Route path=\"/broker/earnings\" component={BrokerEarnings} />\n      <Route path=\"/broker/profile\" component={BrokerProfile} />\n      \n      {/* Student Routes */}\n      <Route path=\"/student\" component={StudentDashboard} />\n      <Route path=\"/student/application\" component={StudentApplication} />\n      <Route path=\"/student/broker\" component={StudentBrokerInfo} />\n      <Route path=\"/student/profile\" component={StudentProfile} />\n      <Route path=\"/student/documents\" component={StudentDocuments} />\n      \n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <AuthProvider>\n      <QueryClientProvider client={queryClient}>\n        <TooltipProvider>\n          <Toaster />\n          <Router />\n        </TooltipProvider>\n      </QueryClientProvider>\n    </AuthProvider>\n  );\n}\n\nexport default App;\n","path":null,"size_bytes":2994,"size_tokens":null},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","path":null,"size_bytes":772,"size_tokens":null},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","path":null,"size_bytes":1598,"size_tokens":null},"server/static.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(__dirname, \"public\");\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":547,"size_tokens":null},"client/src/components/ui/dialog.tsx":{"content":"import * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogTrigger,\n  DialogClose,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","path":null,"size_bytes":3835,"size_tokens":null},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-xl border bg-card text-card-foreground shadow\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"font-semibold leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","path":null,"size_bytes":1828,"size_tokens":null},"client/src/components/layout/Sidebar.tsx":{"content":"import React from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { motion } from \"framer-motion\";\nimport { \n  LayoutDashboard, \n  Users, \n  FileText, \n  Settings, \n  LogOut, \n  PieChart, \n  Briefcase,\n  GraduationCap,\n  Menu,\n  Upload,\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Sheet, SheetContent, SheetTrigger } from \"@/components/ui/sheet\";\nimport { cn } from \"@/lib/utils\";\nimport { useAuth } from \"@/lib/auth-context\";\n\ntype Role = \"admin\" | \"broker\" | \"student\";\n\ninterface SidebarProps {\n  role: Role;\n}\n\nconst menuItems = {\n  admin: [\n    { icon: LayoutDashboard, label: \"Overview\", href: \"/admin\" },\n    { icon: Users, label: \"Brokers\", href: \"/admin/brokers\" },\n    { icon: GraduationCap, label: \"Students\", href: \"/admin/students\" },\n    { icon: PieChart, label: \"Commissions\", href: \"/admin/commissions\" },\n    { icon: Settings, label: \"Settings\", href: \"/admin/settings\" },\n  ],\n  broker: [\n    { icon: LayoutDashboard, label: \"Dashboard\", href: \"/broker\" },\n    { icon: Users, label: \"My Students\", href: \"/broker/students\" },\n    { icon: FileText, label: \"Applications\", href: \"/broker/applications\" },\n    { icon: PieChart, label: \"Earnings\", href: \"/broker/earnings\" },\n    { icon: Settings, label: \"Profile\", href: \"/broker/profile\" },\n  ],\n  student: [\n    { icon: LayoutDashboard, label: \"My Dashboard\", href: \"/student\" },\n    { icon: FileText, label: \"Visa Application\", href: \"/student/application\" },\n    { icon: Upload, label: \"My Documents\", href: \"/student/documents\" },\n    { icon: Briefcase, label: \"My Broker\", href: \"/student/broker\" },\n    { icon: Settings, label: \"Profile\", href: \"/student/profile\" },\n  ],\n};\n\nexport function Sidebar({ role }: SidebarProps) {\n  const [location] = useLocation();\n  const { logout } = useAuth();\n  const items = menuItems[role];\n\n  const SidebarContent = () => (\n    <div className=\"flex flex-col h-full\">\n      <div className=\"p-6\">\n        <h1 className=\"text-2xl font-display font-bold tracking-tighter text-gradient mb-2\">\n          VisaFlow\n        </h1>\n        <p className=\"text-xs text-muted-foreground font-mono uppercase tracking-widest\">\n          {role} portal\n        </p>\n      </div>\n\n      <div className=\"flex-1 px-4 py-2 space-y-2\">\n        {items.map((item) => {\n          const isActive = location === item.href;\n          return (\n            <Link key={item.href} href={item.href}>\n              <div\n                className={cn(\n                  \"flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-300 cursor-pointer group relative overflow-hidden\",\n                  isActive \n                    ? \"bg-primary/10 text-primary border border-primary/20 shadow-[0_0_15px_-5px_hsl(var(--primary)/0.5)]\" \n                    : \"text-muted-foreground hover:text-foreground hover:bg-white/5\"\n                )}\n              >\n                {isActive && (\n                  <motion.div\n                    layoutId=\"activeTab\"\n                    className=\"absolute inset-0 bg-primary/10 rounded-xl\"\n                    initial={{ opacity: 0 }}\n                    animate={{ opacity: 1 }}\n                    exit={{ opacity: 0 }}\n                  />\n                )}\n                <item.icon className={cn(\"w-5 h-5 relative z-10\", isActive && \"animate-pulse\")} />\n                <span className=\"font-medium relative z-10\">{item.label}</span>\n              </div>\n            </Link>\n          );\n        })}\n      </div>\n\n      <div className=\"p-4 mt-auto\">\n        <Button \n          variant=\"outline\" \n          className=\"w-full justify-start gap-2 border-white/10 hover:bg-destructive/10 hover:text-destructive hover:border-destructive/50 transition-colors\"\n          onClick={logout}\n        >\n          <LogOut className=\"w-4 h-4\" />\n          Logout\n        </Button>\n      </div>\n    </div>\n  );\n\n  return (\n    <>\n      {/* Desktop Sidebar */}\n      <motion.aside \n        initial={{ x: -20, opacity: 0 }}\n        animate={{ x: 0, opacity: 1 }}\n        transition={{ duration: 0.5 }}\n        className=\"hidden md:flex w-64 flex-col border-r border-white/10 bg-sidebar/50 backdrop-blur-xl h-screen fixed left-0 top-0 z-30\"\n      >\n        <SidebarContent />\n      </motion.aside>\n\n      {/* Mobile Trigger */}\n      <div className=\"md:hidden fixed top-4 left-4 z-50\">\n        <Sheet>\n          <SheetTrigger asChild>\n            <Button variant=\"outline\" size=\"icon\" className=\"bg-background/50 backdrop-blur-md border-white/10\">\n              <Menu className=\"w-5 h-5\" />\n            </Button>\n          </SheetTrigger>\n          <SheetContent side=\"left\" className=\"p-0 w-72 bg-sidebar/95 backdrop-blur-xl border-r border-white/10 text-sidebar-foreground\">\n            <SidebarContent />\n          </SheetContent>\n        </Sheet>\n      </div>\n    </>\n  );\n}\n","path":null,"size_bytes":4840,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-3.5 w-3.5 fill-primary\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","path":null,"size_bytes":1410,"size_tokens":null},"client/src/pages/student/dashboard.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { DashboardLayout } from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { CheckCircle2, Circle, Clock, FileText, Upload, Plus } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\nimport { Button } from \"@/components/ui/button\";\nimport { Link } from \"wouter\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { studentApi } from \"@/lib/api\";\n\nexport default function StudentDashboard() {\n  const { data: applications = [], isLoading } = useQuery({\n    queryKey: [\"student\", \"applications\"],\n    queryFn: studentApi.getApplications,\n  });\n\n  const getStatusIcon = (status: string, progress: number) => {\n    if (status === 'Approved') return <CheckCircle2 className=\"w-5 h-5\" />;\n    if (progress >= 75) return <Clock className=\"w-5 h-5 animate-pulse\" />;\n    return <Circle className=\"w-5 h-5\" />;\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'Approved':\n        return 'bg-green-500/10 text-green-500 border-green-500/20';\n      case 'Submitted':\n        return 'bg-blue-500/10 text-blue-500 border-blue-500/20';\n      case 'Interview':\n        return 'bg-purple-500/10 text-purple-500 border-purple-500/20';\n      case 'Document Review':\n        return 'bg-yellow-500/10 text-yellow-500 border-yellow-500/20';\n      case 'Rejected':\n        return 'bg-red-500/10 text-red-500 border-red-500/20';\n      default:\n        return 'bg-gray-500/10 text-gray-500 border-gray-500/20';\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <DashboardLayout role=\"student\">\n        <div className=\"flex items-center justify-center h-64\">\n          <p className=\"text-muted-foreground\">Loading your applications...</p>\n        </div>\n      </DashboardLayout>\n    );\n  }\n\n  return (\n    <DashboardLayout role=\"student\">\n      <div className=\"flex flex-col gap-8\">\n        <div className=\"flex justify-between items-end\">\n          <div>\n            <h1 className=\"text-4xl font-display font-bold text-white mb-2\">My Applications</h1>\n            <p className=\"text-muted-foreground\">Track your visa application progress.</p>\n          </div>\n          <Link href=\"/student/application\">\n            <Button className=\"bg-primary text-primary-foreground hover:bg-primary/90\">\n              <Plus className=\"w-4 h-4 mr-2\" /> New Application\n            </Button>\n          </Link>\n        </div>\n\n        {applications.length === 0 ? (\n          <Card className=\"glass-panel border-white/5\">\n            <CardContent className=\"flex flex-col items-center justify-center py-16\">\n              <FileText className=\"w-16 h-16 text-muted-foreground/50 mb-4\" />\n              <h3 className=\"text-xl font-semibold mb-2\">No Applications Yet</h3>\n              <p className=\"text-muted-foreground text-center mb-6\">\n                Start your visa journey by creating your first application.\n              </p>\n              <Link href=\"/student/application\">\n                <Button className=\"bg-primary text-primary-foreground\">\n                  <Plus className=\"w-4 h-4 mr-2\" /> Create Application\n                </Button>\n              </Link>\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid gap-6\">\n            {applications.map((app: any, index: number) => (\n              <motion.div\n                key={app.id}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: index * 0.1 }}\n              >\n                <Card className=\"glass-panel border-white/5 overflow-hidden\">\n                  <div className=\"flex flex-col lg:flex-row\">\n                    <div className=\"flex-1 p-6\">\n                      <div className=\"flex items-start justify-between mb-4\">\n                        <div>\n                          <h3 className=\"text-xl font-semibold mb-1\">{app.visaType}</h3>\n                          <p className=\"text-muted-foreground\">{app.targetCountry}</p>\n                        </div>\n                        <Badge variant=\"outline\" className={getStatusColor(app.status)}>\n                          {app.status}\n                        </Badge>\n                      </div>\n                      \n                      <div className=\"mb-4\">\n                        <div className=\"flex justify-between text-sm mb-2\">\n                          <span className=\"text-muted-foreground\">Progress</span>\n                          <span className=\"font-mono\">{app.progress}%</span>\n                        </div>\n                        <div className=\"w-full bg-white/10 h-2 rounded-full overflow-hidden\">\n                          <motion.div \n                            className=\"h-full bg-gradient-to-r from-primary to-secondary\"\n                            initial={{ width: 0 }}\n                            animate={{ width: `${app.progress}%` }}\n                            transition={{ duration: 0.5, delay: index * 0.1 + 0.2 }}\n                          />\n                        </div>\n                      </div>\n\n                      <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                        <div>\n                          <p className=\"text-muted-foreground\">Last Action</p>\n                          <p className=\"font-medium\">{app.lastAction || \"N/A\"}</p>\n                        </div>\n                        <div>\n                          <p className=\"text-muted-foreground\">Submitted</p>\n                          <p className=\"font-medium\">{new Date(app.submittedAt).toLocaleDateString()}</p>\n                        </div>\n                      </div>\n                    </div>\n\n                    <div className=\"bg-white/5 p-6 lg:w-64 flex flex-col justify-center items-center border-t lg:border-t-0 lg:border-l border-white/10\">\n                      <div className={`w-16 h-16 rounded-full flex items-center justify-center mb-3 ${\n                        app.status === 'Approved' ? 'bg-green-500/20 text-green-500' : \n                        app.status === 'Rejected' ? 'bg-red-500/20 text-red-500' :\n                        'bg-primary/20 text-primary'\n                      }`}>\n                        {getStatusIcon(app.status, app.progress)}\n                      </div>\n                      <p className=\"text-sm font-medium text-center\">\n                        {app.status === 'Approved' ? 'Approved!' : \n                         app.status === 'Rejected' ? 'Rejected' :\n                         'In Progress'}\n                      </p>\n                    </div>\n                  </div>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n        )}\n      </div>\n    </DashboardLayout>\n  );\n}\n","path":null,"size_bytes":6818,"size_tokens":null},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { insertUserSchema, insertApplicationSchema, updateStudentSchema, updateBrokerSchema } from \"@shared/schema\";\nimport bcrypt from \"bcryptjs\";\nimport crypto from \"crypto\";\n\nfunction generateSecurePassword(): string {\n  return crypto.randomBytes(16).toString('base64');\n}\n\nexport async function registerRoutes(\n  httpServer: Server,\n  app: Express\n): Promise<Server> {\n  // Authentication routes\n  app.post(\"/api/auth/signup\", async (req, res) => {\n    try {\n      const { name, email, password, role, adminId } = req.body;\n      \n      if (!name || !email || !password || !role) {\n        return res.status(400).json({ error: \"All fields are required\" });\n      }\n      \n      const existingUser = await storage.getUserByEmail(email);\n      if (existingUser) {\n        return res.status(400).json({ error: \"Email already registered\" });\n      }\n\n      // Brokers and students must select an admin when self-registering\n      if ((role === \"broker\" || role === \"student\") && !adminId) {\n        return res.status(400).json({ error: \"Please select an admin to work with\" });\n      }\n\n      const hashedPassword = await bcrypt.hash(password, 10);\n      \n      const user = await storage.createUser({\n        name,\n        email,\n        password: hashedPassword,\n        role,\n      });\n\n      if (role === \"broker\") {\n        await storage.createBroker({\n          userId: user.id,\n          adminId: adminId,\n          commissionRate: \"10%\",\n          status: \"Active\",\n        });\n      } else if (role === \"student\") {\n        await storage.createStudent({\n          userId: user.id,\n          adminId: adminId,\n          brokerId: null,\n        });\n      }\n\n      req.session.userId = user.id;\n      req.session.role = role;\n\n      res.json({ user: { id: user.id, name: user.name, email: user.email, role: user.role } });\n    } catch (error: any) {\n      console.error(\"Signup error:\", error);\n      res.status(400).json({ error: error.message || \"Signup failed\" });\n    }\n  });\n\n  app.post(\"/api/auth/login\", async (req, res) => {\n    try {\n      const { email, password, role } = req.body;\n      \n      const user = await storage.getUserByEmail(email);\n      if (!user || user.role !== role) {\n        return res.status(401).json({ error: \"Invalid credentials\" });\n      }\n\n      const validPassword = await bcrypt.compare(password, user.password);\n      if (!validPassword) {\n        return res.status(401).json({ error: \"Invalid credentials\" });\n      }\n\n      req.session.userId = user.id;\n      req.session.role = user.role;\n\n      res.json({ user: { id: user.id, name: user.name, email: user.email, role: user.role } });\n    } catch (error: any) {\n      console.error(\"Login error:\", error);\n      res.status(400).json({ error: error.message || \"Login failed\" });\n    }\n  });\n\n  app.post(\"/api/auth/logout\", (req, res) => {\n    req.session.destroy((err: any) => {\n      if (err) {\n        return res.status(500).json({ error: \"Logout failed\" });\n      }\n      res.json({ message: \"Logged out successfully\" });\n    });\n  });\n\n  app.get(\"/api/auth/me\", async (req, res) => {\n    if (!req.session.userId) {\n      return res.status(401).json({ error: \"Not authenticated\" });\n    }\n\n    const user = await storage.getUserById(req.session.userId);\n    if (!user) {\n      return res.status(404).json({ error: \"User not found\" });\n    }\n\n    res.json({ user: { id: user.id, name: user.name, email: user.email, role: user.role } });\n  });\n\n  // Admin list endpoint - available to all authenticated users (full details)\n  app.get(\"/api/admins\", async (req, res) => {\n    if (!req.session.userId) {\n      return res.status(401).json({ error: \"Unauthorized\" });\n    }\n\n    const admins = await storage.getAllAdmins();\n    res.json(admins);\n  });\n\n  // Public admin list endpoint - only returns name and ID for registration\n  app.get(\"/api/admins/public\", async (req, res) => {\n    const admins = await storage.getAllAdmins();\n    res.json(admins.map(admin => ({ id: admin.id, name: admin.name })));\n  });\n\n  // Clear all data endpoint - admin only\n  app.post(\"/api/admin/clear-data\", async (req, res) => {\n    if (req.session.role !== \"admin\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    try {\n      await storage.clearAllData();\n      req.session.destroy((err: any) => {\n        if (err) {\n          console.error(\"Session destroy error:\", err);\n        }\n      });\n      res.json({ message: \"All data cleared successfully\" });\n    } catch (error: any) {\n      console.error(\"Clear data error:\", error);\n      res.status(500).json({ error: error.message || \"Failed to clear data\" });\n    }\n  });\n\n  // Admin routes\n  app.get(\"/api/admin/brokers\", async (req, res) => {\n    if (req.session.role !== \"admin\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    const brokers = await storage.getBrokersByAdminId(req.session.userId!);\n    res.json(brokers);\n  });\n\n  app.post(\"/api/admin/brokers\", async (req, res) => {\n    if (req.session.role !== \"admin\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    try {\n      const { name, email } = req.body;\n      const password = generateSecurePassword();\n      const hashedPassword = await bcrypt.hash(password, 10);\n\n      const user = await storage.createUser({\n        name,\n        email,\n        password: hashedPassword,\n        role: \"broker\",\n      });\n\n      const broker = await storage.createBroker({\n        userId: user.id,\n        adminId: req.session.userId!,\n        commissionRate: \"10%\",\n        status: \"Active\",\n      });\n\n      res.json({ ...broker, user, temporaryPassword: password });\n    } catch (error: any) {\n      console.error(\"Create broker error:\", error);\n      res.status(400).json({ error: error.message || \"Failed to create broker\" });\n    }\n  });\n\n  app.patch(\"/api/admin/brokers/:id/status\", async (req, res) => {\n    if (req.session.role !== \"admin\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    try {\n      const brokerId = parseInt(req.params.id);\n      const broker = await storage.getBrokerById(brokerId);\n      if (!broker) {\n        return res.status(404).json({ error: \"Broker not found\" });\n      }\n\n      if (broker.adminId !== req.session.userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n\n      const { status } = req.body;\n      await storage.updateBrokerStatus(brokerId, status);\n      res.json({ message: \"Status updated\" });\n    } catch (error: any) {\n      res.status(400).json({ error: error.message });\n    }\n  });\n\n  // Admin: Update broker commission settings\n  app.patch(\"/api/admin/brokers/:id/commission\", async (req, res) => {\n    if (req.session.role !== \"admin\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    try {\n      const brokerId = parseInt(req.params.id);\n      const broker = await storage.getBrokerById(brokerId);\n      if (!broker) {\n        return res.status(404).json({ error: \"Broker not found\" });\n      }\n\n      if (broker.adminId !== req.session.userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n\n      const { commissionRate, commissionAmount } = req.body;\n      await storage.updateBrokerCommission(brokerId, commissionRate, commissionAmount || null);\n      res.json({ message: \"Commission updated\" });\n    } catch (error: any) {\n      res.status(400).json({ error: error.message });\n    }\n  });\n\n  // Admin: Change broker password\n  app.patch(\"/api/admin/brokers/:id/password\", async (req, res) => {\n    if (req.session.role !== \"admin\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    try {\n      const brokerId = parseInt(req.params.id);\n      const broker = await storage.getBrokerById(brokerId);\n      if (!broker) {\n        return res.status(404).json({ error: \"Broker not found\" });\n      }\n\n      if (broker.adminId !== req.session.userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n\n      const { newPassword } = req.body;\n      if (!newPassword || newPassword.length < 6) {\n        return res.status(400).json({ error: \"Password must be at least 6 characters\" });\n      }\n\n      const hashedPassword = await bcrypt.hash(newPassword, 10);\n      await storage.updateUserPassword(broker.userId, hashedPassword);\n      res.json({ message: \"Password updated\" });\n    } catch (error: any) {\n      res.status(400).json({ error: error.message });\n    }\n  });\n\n  // Admin: Change student password\n  app.patch(\"/api/admin/students/:id/password\", async (req, res) => {\n    if (req.session.role !== \"admin\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    try {\n      const studentId = parseInt(req.params.id);\n      const student = await storage.getStudentById(studentId);\n      if (!student) {\n        return res.status(404).json({ error: \"Student not found\" });\n      }\n\n      if (student.adminId !== req.session.userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n\n      const { newPassword } = req.body;\n      if (!newPassword || newPassword.length < 6) {\n        return res.status(400).json({ error: \"Password must be at least 6 characters\" });\n      }\n\n      const hashedPassword = await bcrypt.hash(newPassword, 10);\n      await storage.updateUserPassword(student.userId, hashedPassword);\n      res.json({ message: \"Password updated\" });\n    } catch (error: any) {\n      res.status(400).json({ error: error.message });\n    }\n  });\n\n  app.get(\"/api/admin/students\", async (req, res) => {\n    if (req.session.role !== \"admin\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    const students = await storage.getStudentsByAdminId(req.session.userId!);\n    res.json(students);\n  });\n\n  app.get(\"/api/admin/applications\", async (req, res) => {\n    if (req.session.role !== \"admin\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    const applications = await storage.getApplicationsByAdminId(req.session.userId!);\n    res.json(applications);\n  });\n\n  app.get(\"/api/admin/commissions\", async (req, res) => {\n    if (req.session.role !== \"admin\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    const commissions = await storage.getCommissionsByAdminId(req.session.userId!);\n    res.json(commissions);\n  });\n\n  app.patch(\"/api/admin/commissions/:id/status\", async (req, res) => {\n    if (req.session.role !== \"admin\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    try {\n      const commissionId = parseInt(req.params.id);\n      const commission = await storage.getCommissionById(commissionId);\n      if (!commission) {\n        return res.status(404).json({ error: \"Commission not found\" });\n      }\n\n      const broker = await storage.getBrokerById(commission.brokerId);\n      if (!broker || broker.adminId !== req.session.userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n\n      const { status } = req.body;\n      await storage.updateCommissionStatus(commissionId, status);\n      res.json({ message: \"Status updated\" });\n    } catch (error: any) {\n      res.status(400).json({ error: error.message });\n    }\n  });\n\n  // Broker routes\n  app.get(\"/api/broker/students\", async (req, res) => {\n    if (req.session.role !== \"broker\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    const broker = await storage.getBrokerByUserId(req.session.userId!);\n    if (!broker) {\n      return res.status(404).json({ error: \"Broker not found\" });\n    }\n\n    const students = await storage.getStudentsByBrokerId(broker.id);\n    res.json(students);\n  });\n\n  app.post(\"/api/broker/students\", async (req, res) => {\n    if (req.session.role !== \"broker\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    try {\n      const { name, email, visaType } = req.body;\n\n      const password = generateSecurePassword();\n      const hashedPassword = await bcrypt.hash(password, 10);\n\n      const broker = await storage.getBrokerByUserId(req.session.userId!);\n      if (!broker) {\n        return res.status(404).json({ error: \"Broker not found\" });\n      }\n\n      const user = await storage.createUser({\n        name,\n        email,\n        password: hashedPassword,\n        role: \"student\",\n      });\n\n      const student = await storage.createStudent({\n        userId: user.id,\n        adminId: broker.adminId,\n        brokerId: broker.id,\n      });\n\n      await storage.createApplication({\n        studentId: student.id,\n        visaType: visaType || \"F-1 Student\",\n        targetCountry: \"United States\",\n        purpose: \"\",\n        status: \"Document Review\",\n        progress: 0,\n        lastAction: \"Account Created\",\n      });\n\n      res.json({ ...student, user, temporaryPassword: password });\n    } catch (error: any) {\n      console.error(\"Create student error:\", error);\n      res.status(400).json({ error: error.message || \"Failed to create student\" });\n    }\n  });\n\n  app.get(\"/api/broker/applications\", async (req, res) => {\n    if (req.session.role !== \"broker\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    const broker = await storage.getBrokerByUserId(req.session.userId!);\n    if (!broker) {\n      return res.status(404).json({ error: \"Broker not found\" });\n    }\n\n    const applications = await storage.getApplicationsByBrokerId(broker.id);\n    res.json(applications);\n  });\n\n  app.patch(\"/api/broker/applications/:id/status\", async (req, res) => {\n    if (req.session.role !== \"broker\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    try {\n      const applicationId = parseInt(req.params.id);\n      const application = await storage.getApplicationById(applicationId);\n      if (!application) {\n        return res.status(404).json({ error: \"Application not found\" });\n      }\n\n      const broker = await storage.getBrokerByUserId(req.session.userId!);\n      if (!broker) {\n        return res.status(404).json({ error: \"Broker not found\" });\n      }\n\n      const student = await storage.getStudentById(application.studentId);\n      if (!student || student.brokerId !== broker.id) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n\n      const { status } = req.body;\n      await storage.updateApplicationStatus(applicationId, status);\n      res.json({ message: \"Status updated\" });\n    } catch (error: any) {\n      res.status(400).json({ error: error.message });\n    }\n  });\n\n  app.get(\"/api/broker/commissions\", async (req, res) => {\n    if (req.session.role !== \"broker\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    const broker = await storage.getBrokerByUserId(req.session.userId!);\n    if (!broker) {\n      return res.status(404).json({ error: \"Broker not found\" });\n    }\n\n    const commissions = await storage.getCommissionsByBrokerId(broker.id);\n    res.json(commissions);\n  });\n\n  // Student routes\n  app.get(\"/api/student/applications\", async (req, res) => {\n    if (req.session.role !== \"student\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    const student = await storage.getStudentByUserId(req.session.userId!);\n    if (!student) {\n      return res.status(404).json({ error: \"Student not found\" });\n    }\n\n    const applications = await storage.getApplicationsByStudentId(student.id);\n    res.json(applications);\n  });\n\n  app.post(\"/api/student/applications\", async (req, res) => {\n    if (req.session.role !== \"student\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    try {\n      const student = await storage.getStudentByUserId(req.session.userId!);\n      if (!student) {\n        return res.status(404).json({ error: \"Student not found\" });\n      }\n\n      const applicationData = insertApplicationSchema.parse({\n        visaType: req.body.visaType,\n        targetCountry: req.body.targetCountry,\n        purpose: req.body.purpose || \"\",\n        studentId: student.id,\n        status: \"Document Review\",\n        progress: 10,\n        lastAction: \"Application Submitted\",\n      });\n\n      const application = await storage.createApplication(applicationData);\n      res.json(application);\n    } catch (error: any) {\n      console.error(\"Create application error:\", error);\n      res.status(400).json({ error: error.message || \"Failed to create application\" });\n    }\n  });\n\n  app.patch(\"/api/student/applications/:id/progress\", async (req, res) => {\n    if (req.session.role !== \"student\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    try {\n      const applicationId = parseInt(req.params.id);\n      const application = await storage.getApplicationById(applicationId);\n      if (!application) {\n        return res.status(404).json({ error: \"Application not found\" });\n      }\n\n      const student = await storage.getStudentByUserId(req.session.userId!);\n      if (!student || application.studentId !== student.id) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n\n      const { progress, lastAction } = req.body;\n      await storage.updateApplicationProgress(applicationId, progress, lastAction);\n      res.json({ message: \"Progress updated\" });\n    } catch (error: any) {\n      res.status(400).json({ error: error.message });\n    }\n  });\n\n  app.get(\"/api/student/profile\", async (req, res) => {\n    if (req.session.role !== \"student\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    const student = await storage.getStudentByUserId(req.session.userId!);\n    const user = await storage.getUserById(req.session.userId!);\n    \n    // Include broker info if assigned\n    let broker = null;\n    let brokerUser = null;\n    if (student?.brokerId) {\n      broker = await storage.getBrokerById(student.brokerId);\n      if (broker) {\n        brokerUser = await storage.getUserById(broker.userId);\n      }\n    }\n    \n    res.json({ ...student, user, broker: broker ? { ...broker, user: brokerUser } : null });\n  });\n\n  // Get assigned broker info for student\n  app.get(\"/api/student/broker\", async (req, res) => {\n    if (req.session.role !== \"student\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    const student = await storage.getStudentByUserId(req.session.userId!);\n    if (!student) {\n      return res.status(404).json({ error: \"Student not found\" });\n    }\n\n    if (!student.brokerId) {\n      return res.json({ broker: null });\n    }\n\n    const broker = await storage.getBrokerById(student.brokerId);\n    if (!broker) {\n      return res.json({ broker: null });\n    }\n\n    const brokerUser = await storage.getUserById(broker.userId);\n    res.json({ broker: { ...broker, user: brokerUser } });\n  });\n\n  app.patch(\"/api/student/profile\", async (req, res) => {\n    if (req.session.role !== \"student\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    try {\n      const student = await storage.getStudentByUserId(req.session.userId!);\n      if (!student) {\n        return res.status(404).json({ error: \"Student not found\" });\n      }\n\n      const updateData = updateStudentSchema.parse(req.body);\n      const updatedStudent = await storage.updateStudentProfile(student.id, updateData);\n      \n      if (req.body.name) {\n        await storage.updateUserName(req.session.userId!, req.body.name);\n      }\n\n      await storage.createActivity({\n        actorId: req.session.userId!,\n        actorRole: \"student\",\n        targetType: \"student\",\n        targetId: student.id,\n        activityType: \"profile_updated\",\n        description: `Student profile updated`,\n        metadata: {},\n      });\n\n      res.json(updatedStudent);\n    } catch (error: any) {\n      res.status(400).json({ error: error.message });\n    }\n  });\n\n  app.patch(\"/api/student/choose-broker\", async (req, res) => {\n    if (req.session.role !== \"student\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    try {\n      const student = await storage.getStudentByUserId(req.session.userId!);\n      if (!student) {\n        return res.status(404).json({ error: \"Student not found\" });\n      }\n\n      const { brokerId } = req.body;\n      \n      const broker = await storage.getBrokerById(brokerId);\n      if (!broker) {\n        return res.status(404).json({ error: \"Broker not found\" });\n      }\n      \n      if (broker.adminId !== student.adminId) {\n        return res.status(403).json({ error: \"You can only choose brokers from your assigned admin\" });\n      }\n\n      await storage.assignBrokerToStudent(student.id, brokerId);\n\n      await storage.createActivity({\n        actorId: req.session.userId!,\n        actorRole: \"student\",\n        targetType: \"broker\",\n        targetId: brokerId,\n        activityType: \"broker_assigned\",\n        description: `Student chose a broker`,\n        metadata: { studentId: student.id },\n      });\n\n      res.json({ message: \"Broker assigned successfully\" });\n    } catch (error: any) {\n      res.status(400).json({ error: error.message });\n    }\n  });\n\n  // Broker profile routes\n  app.get(\"/api/broker/profile\", async (req, res) => {\n    if (req.session.role !== \"broker\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    const broker = await storage.getBrokerByUserId(req.session.userId!);\n    const user = await storage.getUserById(req.session.userId!);\n    res.json({ ...broker, user });\n  });\n\n  app.patch(\"/api/broker/profile\", async (req, res) => {\n    if (req.session.role !== \"broker\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    try {\n      const broker = await storage.getBrokerByUserId(req.session.userId!);\n      if (!broker) {\n        return res.status(404).json({ error: \"Broker not found\" });\n      }\n\n      const updateData = updateBrokerSchema.parse(req.body);\n      const updatedBroker = await storage.updateBrokerProfile(broker.id, updateData);\n      \n      if (req.body.name) {\n        await storage.updateUserName(req.session.userId!, req.body.name);\n      }\n\n      await storage.createActivity({\n        actorId: req.session.userId!,\n        actorRole: \"broker\",\n        targetType: \"broker\",\n        targetId: broker.id,\n        activityType: \"profile_updated\",\n        description: `Broker profile updated`,\n        metadata: {},\n      });\n\n      res.json(updatedBroker);\n    } catch (error: any) {\n      res.status(400).json({ error: error.message });\n    }\n  });\n\n  // Admin routes for managing brokers and students\n  app.patch(\"/api/admin/brokers/:id\", async (req, res) => {\n    if (req.session.role !== \"admin\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    try {\n      const brokerId = parseInt(req.params.id);\n      const broker = await storage.getBrokerById(brokerId);\n      if (!broker) {\n        return res.status(404).json({ error: \"Broker not found\" });\n      }\n\n      if (broker.adminId !== req.session.userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n\n      const updateData: any = {};\n      if (req.body.commissionRate) updateData.commissionRate = req.body.commissionRate;\n      if (req.body.commissionAmount !== undefined) updateData.commissionAmount = req.body.commissionAmount;\n      if (req.body.status) updateData.status = req.body.status;\n      if (req.body.phone !== undefined) updateData.phone = req.body.phone;\n      if (req.body.address !== undefined) updateData.address = req.body.address;\n      if (req.body.companyName !== undefined) updateData.companyName = req.body.companyName;\n      if (req.body.licenseNumber !== undefined) updateData.licenseNumber = req.body.licenseNumber;\n\n      const updatedBroker = await storage.updateBrokerProfile(brokerId, updateData);\n      \n      if (req.body.name) {\n        await storage.updateUserName(broker.userId, req.body.name);\n      }\n\n      await storage.createActivity({\n        actorId: req.session.userId!,\n        actorRole: \"admin\",\n        targetType: \"broker\",\n        targetId: brokerId,\n        activityType: \"profile_updated\",\n        description: `Admin updated broker profile`,\n        metadata: { changes: Object.keys(updateData) },\n      });\n\n      res.json(updatedBroker);\n    } catch (error: any) {\n      res.status(400).json({ error: error.message });\n    }\n  });\n\n  app.get(\"/api/admin/brokers/:id\", async (req, res) => {\n    if (req.session.role !== \"admin\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    const broker = await storage.getBrokerById(parseInt(req.params.id));\n    if (!broker) {\n      return res.status(404).json({ error: \"Broker not found\" });\n    }\n\n    if (broker.adminId !== req.session.userId) {\n      return res.status(403).json({ error: \"Access denied\" });\n    }\n\n    const user = await storage.getUserById(broker.userId);\n    res.json({ ...broker, user });\n  });\n\n  app.patch(\"/api/admin/students/:id\", async (req, res) => {\n    if (req.session.role !== \"admin\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    try {\n      const studentId = parseInt(req.params.id);\n      const student = await storage.getStudentById(studentId);\n      if (!student) {\n        return res.status(404).json({ error: \"Student not found\" });\n      }\n\n      if (student.adminId !== req.session.userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n\n      const updateData: any = {};\n      if (req.body.passportNumber) updateData.passportNumber = req.body.passportNumber;\n      if (req.body.dateOfBirth) updateData.dateOfBirth = req.body.dateOfBirth;\n      if (req.body.currentAddress) updateData.currentAddress = req.body.currentAddress;\n      if (req.body.phone) updateData.phone = req.body.phone;\n      if (req.body.nationality) updateData.nationality = req.body.nationality;\n      if (req.body.education) updateData.education = req.body.education;\n      if (req.body.brokerId !== undefined) updateData.brokerId = req.body.brokerId;\n\n      const updatedStudent = await storage.updateStudentProfile(studentId, updateData);\n      \n      if (req.body.name) {\n        await storage.updateUserName(student.userId, req.body.name);\n      }\n\n      await storage.createActivity({\n        actorId: req.session.userId!,\n        actorRole: \"admin\",\n        targetType: \"student\",\n        targetId: studentId,\n        activityType: \"profile_updated\",\n        description: `Admin updated student profile`,\n        metadata: { changes: Object.keys(updateData) },\n      });\n\n      res.json(updatedStudent);\n    } catch (error: any) {\n      res.status(400).json({ error: error.message });\n    }\n  });\n\n  app.get(\"/api/admin/students/:id\", async (req, res) => {\n    if (req.session.role !== \"admin\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    const student = await storage.getStudentById(parseInt(req.params.id));\n    if (!student) {\n      return res.status(404).json({ error: \"Student not found\" });\n    }\n\n    if (student.adminId !== req.session.userId) {\n      return res.status(403).json({ error: \"Access denied\" });\n    }\n\n    const user = await storage.getUserById(student.userId);\n    res.json({ ...student, user });\n  });\n\n  app.patch(\"/api/admin/applications/:id/assign-broker\", async (req, res) => {\n    if (req.session.role !== \"admin\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    try {\n      const { brokerId } = req.body;\n      const applicationId = parseInt(req.params.id);\n      \n      const application = await storage.getApplicationById(applicationId);\n      if (!application) {\n        return res.status(404).json({ error: \"Application not found\" });\n      }\n\n      const student = await storage.getStudentById(application.studentId);\n      if (!student || student.adminId !== req.session.userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n\n      await storage.assignBrokerToStudent(application.studentId, brokerId);\n\n      await storage.createActivity({\n        actorId: req.session.userId!,\n        actorRole: \"admin\",\n        targetType: \"application\",\n        targetId: applicationId,\n        activityType: \"broker_assigned\",\n        description: `Admin assigned broker to student`,\n        metadata: { brokerId, studentId: application.studentId },\n      });\n\n      res.json({ message: \"Broker assigned successfully\" });\n    } catch (error: any) {\n      res.status(400).json({ error: error.message });\n    }\n  });\n\n  // Helper function to validate URLs\n  const isValidDocumentUrl = (url: string): boolean => {\n    try {\n      const parsed = new URL(url);\n      return parsed.protocol === \"https:\" || parsed.protocol === \"http:\";\n    } catch {\n      return false;\n    }\n  };\n\n  // Document routes\n  app.post(\"/api/documents\", async (req, res) => {\n    if (!req.session.userId) {\n      return res.status(401).json({ error: \"Unauthorized\" });\n    }\n\n    try {\n      const { ownerType, ownerId, name, type, path } = req.body;\n      \n      // Validate URL to prevent XSS - only allow http/https\n      if (!path || !isValidDocumentUrl(path)) {\n        return res.status(400).json({ error: \"Invalid document URL. Only http:// and https:// URLs are allowed.\" });\n      }\n      \n      const document = await storage.createDocument({\n        ownerType,\n        ownerId,\n        uploadedById: req.session.userId,\n        name,\n        type,\n        path,\n        status: \"Pending\",\n      });\n\n      await storage.createActivity({\n        actorId: req.session.userId,\n        actorRole: req.session.role!,\n        targetType: ownerType,\n        targetId: ownerId,\n        activityType: \"document_uploaded\",\n        description: `Document \"${name}\" uploaded`,\n        metadata: { documentId: document.id },\n      });\n\n      res.json(document);\n    } catch (error: any) {\n      res.status(400).json({ error: error.message });\n    }\n  });\n\n  app.get(\"/api/documents/my\", async (req, res) => {\n    if (!req.session.userId) {\n      return res.status(401).json({ error: \"Unauthorized\" });\n    }\n\n    let ownerId: number;\n    let ownerType: string;\n\n    if (req.session.role === \"student\") {\n      const student = await storage.getStudentByUserId(req.session.userId);\n      if (!student) return res.status(404).json({ error: \"Student not found\" });\n      ownerId = student.id;\n      ownerType = \"student\";\n    } else if (req.session.role === \"broker\") {\n      const broker = await storage.getBrokerByUserId(req.session.userId);\n      if (!broker) return res.status(404).json({ error: \"Broker not found\" });\n      ownerId = broker.id;\n      ownerType = \"broker\";\n    } else {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    const documents = await storage.getDocumentsByOwner(ownerType, ownerId);\n    res.json(documents);\n  });\n\n  app.get(\"/api/broker/students/:studentId/documents\", async (req, res) => {\n    if (req.session.role !== \"broker\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    const broker = await storage.getBrokerByUserId(req.session.userId!);\n    if (!broker) {\n      return res.status(404).json({ error: \"Broker not found\" });\n    }\n\n    const studentId = parseInt(req.params.studentId);\n    const student = await storage.getStudentById(studentId);\n    \n    if (!student || student.brokerId !== broker.id) {\n      return res.status(403).json({ error: \"Student not assigned to you\" });\n    }\n\n    const documents = await storage.getDocumentsByOwner(\"student\", studentId);\n    res.json(documents);\n  });\n\n  app.get(\"/api/admin/documents\", async (req, res) => {\n    if (req.session.role !== \"admin\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    const documents = await storage.getDocumentsByAdminId(req.session.userId!);\n    res.json(documents);\n  });\n\n  app.get(\"/api/admin/documents/:ownerType/:ownerId\", async (req, res) => {\n    if (req.session.role !== \"admin\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    const ownerType = req.params.ownerType;\n    const ownerId = parseInt(req.params.ownerId);\n    \n    if (ownerType === \"student\") {\n      const student = await storage.getStudentById(ownerId);\n      if (!student || student.adminId !== req.session.userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n    } else if (ownerType === \"broker\") {\n      const broker = await storage.getBrokerById(ownerId);\n      if (!broker || broker.adminId !== req.session.userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n    }\n\n    const documents = await storage.getDocumentsByOwner(ownerType, ownerId);\n    res.json(documents);\n  });\n\n  app.patch(\"/api/documents/:id/status\", async (req, res) => {\n    if (req.session.role !== \"admin\" && req.session.role !== \"broker\") {\n      return res.status(403).json({ error: \"Unauthorized\" });\n    }\n\n    try {\n      const { status, notes } = req.body;\n      const documentId = parseInt(req.params.id);\n\n      // For brokers, verify they have access to this document's owner\n      if (req.session.role === \"broker\") {\n        const broker = await storage.getBrokerByUserId(req.session.userId!);\n        if (!broker) {\n          return res.status(404).json({ error: \"Broker not found\" });\n        }\n        \n        const document = await storage.getDocumentById(documentId);\n        if (!document) {\n          return res.status(404).json({ error: \"Document not found\" });\n        }\n        \n        // Only allow brokers to update documents of their assigned students\n        if (document.ownerType === \"student\") {\n          const student = await storage.getStudentById(document.ownerId);\n          if (!student || student.brokerId !== broker.id) {\n            return res.status(403).json({ error: \"You can only manage documents from your assigned students\" });\n          }\n        } else {\n          return res.status(403).json({ error: \"Unauthorized to manage this document\" });\n        }\n      }\n\n      await storage.updateDocumentStatus(documentId, status, notes);\n\n      await storage.createActivity({\n        actorId: req.session.userId!,\n        actorRole: req.session.role,\n        targetType: \"document\",\n        targetId: documentId,\n        activityType: \"document_reviewed\",\n        description: `Document status updated to ${status}`,\n        metadata: { status, notes },\n      });\n\n      res.json({ message: \"Document status updated\" });\n    } catch (error: any) {\n      res.status(400).json({ error: error.message });\n    }\n  });\n\n  // Activity/Notification routes\n  app.get(\"/api/activities\", async (req, res) => {\n    if (!req.session.userId) {\n      return res.status(401).json({ error: \"Unauthorized\" });\n    }\n\n    let activities;\n    if (req.session.role === \"admin\") {\n      activities = await storage.getAllActivities();\n    } else {\n      activities = await storage.getActivitiesByRole(req.session.role!, req.session.userId);\n    }\n\n    res.json(activities);\n  });\n\n  // Get available brokers for student selection\n  app.get(\"/api/brokers/available\", async (req, res) => {\n    if (!req.session.userId) {\n      return res.status(401).json({ error: \"Unauthorized\" });\n    }\n\n    let adminId: number | null = null;\n    \n    if (req.session.role === \"student\") {\n      const student = await storage.getStudentByUserId(req.session.userId);\n      if (student) {\n        adminId = student.adminId;\n      }\n    } else if (req.session.role === \"admin\") {\n      adminId = req.session.userId;\n    } else if (req.session.role === \"broker\") {\n      const broker = await storage.getBrokerByUserId(req.session.userId);\n      if (broker) {\n        adminId = broker.adminId;\n      }\n    }\n    \n    if (!adminId) {\n      return res.status(403).json({ error: \"Could not determine admin\" });\n    }\n\n    const brokers = await storage.getBrokersByAdminId(adminId);\n    const activeBrokers = brokers.filter(b => b.status === \"Active\");\n    res.json(activeBrokers);\n  });\n\n  return httpServer;\n}\n","path":null,"size_bytes":36010,"size_tokens":null},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","path":null,"size_bytes":329,"size_tokens":null},"client/src/pages/admin/students.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { DashboardLayout } from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Search, MoreHorizontal, UserPlus, UserMinus, Users, Key } from \"lucide-react\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger, DropdownMenuSeparator } from \"@/components/ui/dropdown-menu\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from \"@/components/ui/dialog\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { adminApi } from \"@/lib/api\";\n\nexport default function AdminStudents() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [isAssignOpen, setIsAssignOpen] = useState(false);\n  const [isPasswordOpen, setIsPasswordOpen] = useState(false);\n  const [selectedStudent, setSelectedStudent] = useState<any>(null);\n  const [selectedBrokerId, setSelectedBrokerId] = useState<string>(\"\");\n  const [newPassword, setNewPassword] = useState(\"\");\n\n  const { data: students = [], isLoading } = useQuery({\n    queryKey: [\"admin\", \"students\"],\n    queryFn: adminApi.getStudents,\n  });\n\n  const { data: brokers = [] } = useQuery({\n    queryKey: [\"admin\", \"brokers\"],\n    queryFn: adminApi.getBrokers,\n  });\n\n  const activeBrokers = brokers.filter((b: any) => b.status === \"Active\");\n\n  const updateStudentMutation = useMutation({\n    mutationFn: ({ studentId, data }: { studentId: number; data: any }) =>\n      adminApi.updateStudent(studentId, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"admin\", \"students\"] });\n      queryClient.invalidateQueries({ queryKey: [\"admin\", \"brokers\"] });\n      setIsAssignOpen(false);\n      setSelectedStudent(null);\n      setSelectedBrokerId(\"\");\n      toast({ title: \"Student Updated\", description: \"Broker assignment has been updated.\" });\n    },\n    onError: (error: any) => {\n      toast({ \n        title: \"Error\", \n        description: error.message || \"Failed to update student\",\n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const passwordMutation = useMutation({\n    mutationFn: ({ studentId, newPassword }: { studentId: number; newPassword: string }) =>\n      adminApi.changeStudentPassword(studentId, newPassword),\n    onSuccess: () => {\n      setIsPasswordOpen(false);\n      setSelectedStudent(null);\n      setNewPassword(\"\");\n      toast({ title: \"Password Updated\", description: \"Student password has been changed successfully.\" });\n    },\n    onError: (error: any) => {\n      toast({ \n        title: \"Error\", \n        description: error.message || \"Failed to change password\",\n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const openAssignDialog = (student: any) => {\n    setSelectedStudent(student);\n    setSelectedBrokerId(student.brokerId?.toString() || \"\");\n    setIsAssignOpen(true);\n  };\n\n  const openPasswordDialog = (student: any) => {\n    setSelectedStudent(student);\n    setNewPassword(\"\");\n    setIsPasswordOpen(true);\n  };\n\n  const handleChangePassword = () => {\n    if (!selectedStudent || !newPassword) return;\n    if (newPassword.length < 6) {\n      toast({ title: \"Error\", description: \"Password must be at least 6 characters\", variant: \"destructive\" });\n      return;\n    }\n    passwordMutation.mutate({ studentId: selectedStudent.id, newPassword });\n  };\n\n  const handleAssignBroker = () => {\n    if (!selectedStudent) return;\n    const brokerId = selectedBrokerId === \"none\" ? null : parseInt(selectedBrokerId);\n    updateStudentMutation.mutate({ \n      studentId: selectedStudent.id, \n      data: { brokerId } \n    });\n  };\n\n  const handleRemoveBroker = (student: any) => {\n    updateStudentMutation.mutate({ \n      studentId: student.id, \n      data: { brokerId: null } \n    });\n  };\n\n  const filteredStudents = students.filter((student: any) => \n    student.user?.name.toLowerCase().includes(searchTerm.toLowerCase()) || \n    student.user?.email.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  if (isLoading) {\n    return (\n      <DashboardLayout role=\"admin\">\n        <div className=\"flex items-center justify-center h-64\">\n          <p className=\"text-muted-foreground\">Loading students...</p>\n        </div>\n      </DashboardLayout>\n    );\n  }\n\n  return (\n    <DashboardLayout role=\"admin\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-3xl font-display font-bold text-white\">Student Management</h1>\n          <p className=\"text-muted-foreground\">View and manage all registered students.</p>\n        </div>\n      </div>\n\n      <div className=\"flex items-center space-x-2 bg-white/5 border border-white/10 rounded-lg px-3 py-1 max-w-md\">\n        <Search className=\"w-4 h-4 text-muted-foreground\" />\n        <Input \n          placeholder=\"Search by name or email...\" \n          className=\"border-none bg-transparent focus-visible:ring-0 focus-visible:ring-offset-0\" \n          value={searchTerm}\n          onChange={(e) => setSearchTerm(e.target.value)}\n          data-testid=\"input-search-students\"\n        />\n      </div>\n\n      <Card className=\"glass-panel border-white/5\">\n        <CardHeader>\n          <CardTitle>All Students ({filteredStudents.length})</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <Table>\n            <TableHeader>\n              <TableRow className=\"border-white/10 hover:bg-white/5\">\n                <TableHead>Name</TableHead>\n                <TableHead>Email</TableHead>\n                <TableHead>Assigned Broker</TableHead>\n                <TableHead>Passport Number</TableHead>\n                <TableHead className=\"text-right\">Actions</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {filteredStudents.length === 0 ? (\n                <TableRow>\n                  <TableCell colSpan={5} className=\"text-center text-muted-foreground\">\n                    No students found\n                  </TableCell>\n                </TableRow>\n              ) : (\n                filteredStudents.map((student: any) => (\n                  <TableRow key={student.id} className=\"border-white/10 hover:bg-white/5\" data-testid={`row-student-${student.id}`}>\n                    <TableCell className=\"font-medium\" data-testid={`text-student-name-${student.id}`}>\n                      {student.user?.name || \"N/A\"}\n                    </TableCell>\n                    <TableCell data-testid={`text-student-email-${student.id}`}>\n                      {student.user?.email || \"N/A\"}\n                    </TableCell>\n                    <TableCell>\n                      {student.broker ? (\n                        <Badge variant=\"outline\" className=\"bg-primary/10 text-primary border-primary/20\" data-testid={`badge-broker-${student.id}`}>\n                          {student.broker.user?.name}\n                        </Badge>\n                      ) : (\n                        <Badge variant=\"outline\" className=\"bg-gray-500/10 text-gray-500 border-gray-500/20\" data-testid={`badge-unassigned-${student.id}`}>\n                          Unassigned\n                        </Badge>\n                      )}\n                    </TableCell>\n                    <TableCell className=\"font-mono text-xs\">{student.passportNumber || \"Not provided\"}</TableCell>\n                    <TableCell className=\"text-right\">\n                      <DropdownMenu>\n                        <DropdownMenuTrigger asChild>\n                          <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\" data-testid={`menu-student-${student.id}`}>\n                            <MoreHorizontal className=\"w-4 h-4\" />\n                          </Button>\n                        </DropdownMenuTrigger>\n                        <DropdownMenuContent align=\"end\" className=\"bg-card border-white/10\">\n                          <DropdownMenuItem \n                            onClick={() => openAssignDialog(student)}\n                            data-testid={`action-assign-broker-${student.id}`}\n                          >\n                            <UserPlus className=\"w-4 h-4 mr-2\" />\n                            {student.brokerId ? \"Change Broker\" : \"Assign Broker\"}\n                          </DropdownMenuItem>\n                          <DropdownMenuItem \n                            onClick={() => openPasswordDialog(student)}\n                            data-testid={`action-change-password-${student.id}`}\n                          >\n                            <Key className=\"w-4 h-4 mr-2\" />\n                            Change Password\n                          </DropdownMenuItem>\n                          {student.brokerId && (\n                            <>\n                              <DropdownMenuSeparator />\n                              <DropdownMenuItem \n                                onClick={() => handleRemoveBroker(student)}\n                                className=\"text-destructive\"\n                                data-testid={`action-remove-broker-${student.id}`}\n                              >\n                                <UserMinus className=\"w-4 h-4 mr-2\" />\n                                Remove Broker\n                              </DropdownMenuItem>\n                            </>\n                          )}\n                        </DropdownMenuContent>\n                      </DropdownMenu>\n                    </TableCell>\n                  </TableRow>\n                ))\n              )}\n            </TableBody>\n          </Table>\n        </CardContent>\n      </Card>\n\n      <Dialog open={isAssignOpen} onOpenChange={setIsAssignOpen}>\n        <DialogContent className=\"bg-card border-white/10\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <Users className=\"w-5 h-5\" /> Assign Broker\n            </DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"p-3 bg-white/5 rounded-lg\">\n              <p className=\"text-sm text-muted-foreground\">\n                Student: <span className=\"text-white font-medium\">{selectedStudent?.user?.name}</span>\n              </p>\n              {selectedStudent?.broker && (\n                <p className=\"text-sm text-muted-foreground mt-1\">\n                  Current Broker: <span className=\"text-primary font-medium\">{selectedStudent.broker.user?.name}</span>\n                </p>\n              )}\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Select Broker</Label>\n              <Select value={selectedBrokerId} onValueChange={setSelectedBrokerId}>\n                <SelectTrigger className=\"bg-white/5 border-white/10\" data-testid=\"select-broker-assignment\">\n                  <SelectValue placeholder=\"Choose a broker\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"none\">No Broker (Unassign)</SelectItem>\n                  {activeBrokers.map((broker: any) => (\n                    <SelectItem key={broker.id} value={broker.id.toString()}>\n                      {broker.user?.name} ({broker.activeStudents} students)\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"ghost\" onClick={() => setIsAssignOpen(false)} data-testid=\"cancel-assign-broker\">\n              Cancel\n            </Button>\n            <Button \n              onClick={handleAssignBroker} \n              disabled={updateStudentMutation.isPending}\n              data-testid=\"confirm-assign-broker\"\n            >\n              {updateStudentMutation.isPending ? \"Saving...\" : \"Save Assignment\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={isPasswordOpen} onOpenChange={setIsPasswordOpen}>\n        <DialogContent className=\"bg-card border-white/10\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <Key className=\"w-5 h-5\" /> Change Student Password\n            </DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"p-3 bg-white/5 rounded-lg\">\n              <p className=\"text-sm text-muted-foreground\">Changing password for: <span className=\"text-white font-medium\">{selectedStudent?.user?.name}</span></p>\n            </div>\n            <div className=\"space-y-2\">\n              <Label>New Password</Label>\n              <Input \n                type=\"password\"\n                placeholder=\"Enter new password (min 6 characters)\" \n                className=\"bg-white/5 border-white/10\"\n                value={newPassword}\n                onChange={(e) => setNewPassword(e.target.value)}\n                data-testid=\"input-student-new-password\"\n              />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"ghost\" onClick={() => setIsPasswordOpen(false)} data-testid=\"cancel-student-password\">Cancel</Button>\n            <Button onClick={handleChangePassword} disabled={passwordMutation.isPending} data-testid=\"save-student-password\">\n              {passwordMutation.isPending ? \"Updating...\" : \"Update Password\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </DashboardLayout>\n  );\n}\n","path":null,"size_bytes":13937,"size_tokens":null},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","path":null,"size_bytes":1419,"size_tokens":null},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","path":null,"size_bytes":1642,"size_tokens":null},"client/src/components/ui/input-group.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Textarea } from \"@/components/ui/textarea\"\n\nfunction InputGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"input-group\"\n      role=\"group\"\n      className={cn(\n        \"group/input-group border-input dark:bg-input/30 shadow-xs relative flex w-full items-center rounded-md border outline-none transition-[color,box-shadow]\",\n        \"h-9 has-[>textarea]:h-auto\",\n\n        // Variants based on alignment.\n        \"has-[>[data-align=inline-start]]:[&>input]:pl-2\",\n        \"has-[>[data-align=inline-end]]:[&>input]:pr-2\",\n        \"has-[>[data-align=block-start]]:h-auto has-[>[data-align=block-start]]:flex-col has-[>[data-align=block-start]]:[&>input]:pb-3\",\n        \"has-[>[data-align=block-end]]:h-auto has-[>[data-align=block-end]]:flex-col has-[>[data-align=block-end]]:[&>input]:pt-3\",\n\n        // Focus state.\n        \"has-[[data-slot=input-group-control]:focus-visible]:ring-ring has-[[data-slot=input-group-control]:focus-visible]:ring-1\",\n\n        // Error state.\n        \"has-[[data-slot][aria-invalid=true]]:ring-destructive/20 has-[[data-slot][aria-invalid=true]]:border-destructive dark:has-[[data-slot][aria-invalid=true]]:ring-destructive/40\",\n\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst inputGroupAddonVariants = cva(\n  \"text-muted-foreground flex h-auto cursor-text select-none items-center justify-center gap-2 py-1.5 text-sm font-medium group-data-[disabled=true]/input-group:opacity-50 [&>kbd]:rounded-[calc(var(--radius)-5px)] [&>svg:not([class*='size-'])]:size-4\",\n  {\n    variants: {\n      align: {\n        \"inline-start\":\n          \"order-first pl-3 has-[>button]:ml-[-0.45rem] has-[>kbd]:ml-[-0.35rem]\",\n        \"inline-end\":\n          \"order-last pr-3 has-[>button]:mr-[-0.4rem] has-[>kbd]:mr-[-0.35rem]\",\n        \"block-start\":\n          \"[.border-b]:pb-3 order-first w-full justify-start px-3 pt-3 group-has-[>input]/input-group:pt-2.5\",\n        \"block-end\":\n          \"[.border-t]:pt-3 order-last w-full justify-start px-3 pb-3 group-has-[>input]/input-group:pb-2.5\",\n      },\n    },\n    defaultVariants: {\n      align: \"inline-start\",\n    },\n  }\n)\n\nfunction InputGroupAddon({\n  className,\n  align = \"inline-start\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof inputGroupAddonVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"input-group-addon\"\n      data-align={align}\n      className={cn(inputGroupAddonVariants({ align }), className)}\n      onClick={(e) => {\n        if ((e.target as HTMLElement).closest(\"button\")) {\n          return\n        }\n        e.currentTarget.parentElement?.querySelector(\"input\")?.focus()\n      }}\n      {...props}\n    />\n  )\n}\n\nconst inputGroupButtonVariants = cva(\n  \"flex items-center gap-2 text-sm shadow-none\",\n  {\n    variants: {\n      size: {\n        xs: \"h-6 gap-1 rounded-[calc(var(--radius)-5px)] px-2 has-[>svg]:px-2 [&>svg:not([class*='size-'])]:size-3.5\",\n        sm: \"h-8 gap-1.5 rounded-md px-2.5 has-[>svg]:px-2.5\",\n        \"icon-xs\":\n          \"size-6 rounded-[calc(var(--radius)-5px)] p-0 has-[>svg]:p-0\",\n        \"icon-sm\": \"size-8 p-0 has-[>svg]:p-0\",\n      },\n    },\n    defaultVariants: {\n      size: \"xs\",\n    },\n  }\n)\n\nfunction InputGroupButton({\n  className,\n  type = \"button\",\n  variant = \"ghost\",\n  size = \"xs\",\n  ...props\n}: Omit<React.ComponentProps<typeof Button>, \"size\"> &\n  VariantProps<typeof inputGroupButtonVariants>) {\n  return (\n    <Button\n      type={type}\n      data-size={size}\n      variant={variant}\n      className={cn(inputGroupButtonVariants({ size }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupText({ className, ...props }: React.ComponentProps<\"span\">) {\n  return (\n    <span\n      className={cn(\n        \"text-muted-foreground flex items-center gap-2 text-sm [&_svg:not([class*='size-'])]:size-4 [&_svg]:pointer-events-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupInput({\n  className,\n  ...props\n}: React.ComponentProps<\"input\">) {\n  return (\n    <Input\n      data-slot=\"input-group-control\"\n      className={cn(\n        \"flex-1 rounded-none border-0 bg-transparent shadow-none focus-visible:ring-0 dark:bg-transparent\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupTextarea({\n  className,\n  ...props\n}: React.ComponentProps<\"textarea\">) {\n  return (\n    <Textarea\n      data-slot=\"input-group-control\"\n      className={cn(\n        \"flex-1 resize-none rounded-none border-0 bg-transparent py-3 shadow-none focus-visible:ring-0 dark:bg-transparent\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  InputGroup,\n  InputGroupAddon,\n  InputGroupButton,\n  InputGroupText,\n  InputGroupInput,\n  InputGroupTextarea,\n}\n","path":null,"size_bytes":4971,"size_tokens":null},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-9 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-300 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","path":null,"size_bytes":5124,"size_tokens":null},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationLink,\n  PaginationItem,\n  PaginationPrevious,\n  PaginationNext,\n  PaginationEllipsis,\n}\n","path":null,"size_bytes":2751,"size_tokens":null},"client/src/components/ui/spinner.tsx":{"content":"import { Loader2Icon } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Spinner({ className, ...props }: React.ComponentProps<\"svg\">) {\n  return (\n    <Loader2Icon\n      role=\"status\"\n      aria-label=\"Loading\"\n      className={cn(\"size-4 animate-spin\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Spinner }\n","path":null,"size_bytes":331,"size_tokens":null},"client/src/components/ui/form.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue | null>(null)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  if (!itemContext) {\n    throw new Error(\"useFormField should be used within <FormItem>\")\n  }\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue | null>(null)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-[0.8rem] text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-[0.8rem] font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","path":null,"size_bytes":4175,"size_tokens":null},"client/src/components/ui/command.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","path":null,"size_bytes":4887,"size_tokens":null},"client/src/index.css":{"content":"@import \"tailwindcss\";\n@import \"tw-animate-css\";\n\n@custom-variant dark (&:is(.dark *));\n\n@theme inline {\n  --radius-sm: calc(var(--radius) - 4px);\n  --radius-md: calc(var(--radius) - 2px);\n  --radius-lg: var(--radius);\n  --radius-xl: calc(var(--radius) + 4px);\n\n  --color-background: hsl(var(--background));\n  --color-foreground: hsl(var(--foreground));\n\n  --color-card: hsl(var(--card));\n  --color-card-foreground: hsl(var(--card-foreground));\n\n  --color-popover: hsl(var(--popover));\n  --color-popover-foreground: hsl(var(--popover-foreground));\n\n  --color-primary: hsl(var(--primary));\n  --color-primary-foreground: hsl(var(--primary-foreground));\n\n  --color-secondary: hsl(var(--secondary));\n  --color-secondary-foreground: hsl(var(--secondary-foreground));\n\n  --color-muted: hsl(var(--muted));\n  --color-muted-foreground: hsl(var(--muted-foreground));\n\n  --color-accent: hsl(var(--accent));\n  --color-accent-foreground: hsl(var(--accent-foreground));\n\n  --color-destructive: hsl(var(--destructive));\n  --color-destructive-foreground: hsl(var(--destructive-foreground));\n\n  --color-border: hsl(var(--border));\n  --color-input: hsl(var(--input));\n  --color-ring: hsl(var(--ring));\n\n  --color-chart-1: hsl(var(--chart-1));\n  --color-chart-2: hsl(var(--chart-2));\n  --color-chart-3: hsl(var(--chart-3));\n  --color-chart-4: hsl(var(--chart-4));\n  --color-chart-5: hsl(var(--chart-5));\n\n  --color-sidebar: hsl(var(--sidebar));\n  --color-sidebar-foreground: hsl(var(--sidebar-foreground));\n  --color-sidebar-primary: hsl(var(--sidebar-primary));\n  --color-sidebar-primary-foreground: hsl(var(--sidebar-primary-foreground));\n  --color-sidebar-accent: hsl(var(--sidebar-accent));\n  --color-sidebar-accent-foreground: hsl(var(--sidebar-accent-foreground));\n  --color-sidebar-border: hsl(var(--sidebar-border));\n  --color-sidebar-ring: hsl(var(--sidebar-ring));\n\n  --font-sans: \"Inter\", sans-serif;\n  --font-display: \"Space Grotesk\", sans-serif;\n  --font-mono: \"JetBrains Mono\", monospace;\n}\n\n/* DARK MODE DEFAULT - FUTURISTIC THEME */\n:root {\n  --background: 230 35% 7%; /* Deep Space Black */\n  --foreground: 210 40% 98%; /* Ice White */\n\n  --card: 230 25% 10%;\n  --card-foreground: 210 40% 98%;\n\n  --popover: 230 25% 10%;\n  --popover-foreground: 210 40% 98%;\n\n  --primary: 190 100% 50%; /* Neon Cyan */\n  --primary-foreground: 230 35% 7%;\n\n  --secondary: 280 70% 60%; /* Electric Purple */\n  --secondary-foreground: 210 40% 98%;\n\n  --muted: 230 20% 15%;\n  --muted-foreground: 215 20% 65%;\n\n  --accent: 320 100% 60%; /* Hot Pink */\n  --accent-foreground: 210 40% 98%;\n\n  --destructive: 0 84% 60%;\n  --destructive-foreground: 210 40% 98%;\n\n  --border: 230 20% 20%;\n  --input: 230 20% 20%;\n  --ring: 190 100% 50%;\n\n  --radius: 0.5rem;\n\n  --chart-1: 190 100% 50%;\n  --chart-2: 280 70% 60%;\n  --chart-3: 320 100% 60%;\n  --chart-4: 45 100% 60%;\n  --chart-5: 15 100% 60%;\n\n  --sidebar: 230 30% 9%;\n  --sidebar-foreground: 210 40% 98%;\n  --sidebar-primary: 190 100% 50%;\n  --sidebar-primary-foreground: 230 35% 7%;\n  --sidebar-accent: 230 20% 20%;\n  --sidebar-accent-foreground: 210 40% 98%;\n  --sidebar-border: 230 20% 15%;\n  --sidebar-ring: 190 100% 50%;\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n    background-image: \n      radial-gradient(circle at 15% 50%, hsl(280 70% 60% / 0.1), transparent 25%), \n      radial-gradient(circle at 85% 30%, hsl(190 100% 50% / 0.1), transparent 25%);\n    background-attachment: fixed;\n  }\n  h1, h2, h3, h4, h5, h6 {\n    @apply font-display tracking-tight;\n  }\n}\n\n/* Custom Glassmorphism Utilities */\n@layer utilities {\n  .glass-panel {\n    @apply bg-card/60 backdrop-blur-xl border border-white/10 shadow-xl;\n  }\n  \n  .glass-card {\n    @apply bg-white/5 backdrop-blur-md border border-white/10 hover:bg-white/10 transition-colors duration-300;\n  }\n\n  .neon-border {\n    box-shadow: 0 0 10px -2px hsl(var(--primary) / 0.5);\n  }\n  \n  .text-gradient {\n    @apply bg-clip-text text-transparent bg-gradient-to-r from-primary via-secondary to-accent;\n  }\n}\n","path":null,"size_bytes":4063,"size_tokens":null},"client/src/lib/api.ts":{"content":"// API client functions for backend integration\n\n// Admin API\nexport const adminApi = {\n  getBrokers: async () => {\n    const response = await fetch(\"/api/admin/brokers\", {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to fetch brokers\");\n    return response.json();\n  },\n\n  createBroker: async (data: { name: string; email: string }) => {\n    const response = await fetch(\"/api/admin/brokers\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify(data),\n    });\n    if (!response.ok) throw new Error(\"Failed to create broker\");\n    return response.json();\n  },\n\n  updateBrokerStatus: async (brokerId: number, status: string) => {\n    const response = await fetch(`/api/admin/brokers/${brokerId}/status`, {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify({ status }),\n    });\n    if (!response.ok) throw new Error(\"Failed to update broker status\");\n    return response.json();\n  },\n\n  getStudents: async () => {\n    const response = await fetch(\"/api/admin/students\", {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to fetch students\");\n    return response.json();\n  },\n\n  getApplications: async () => {\n    const response = await fetch(\"/api/admin/applications\", {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to fetch applications\");\n    return response.json();\n  },\n\n  getCommissions: async () => {\n    const response = await fetch(\"/api/admin/commissions\", {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to fetch commissions\");\n    return response.json();\n  },\n\n  updateCommissionStatus: async (commissionId: number, status: string) => {\n    const response = await fetch(`/api/admin/commissions/${commissionId}/status`, {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify({ status }),\n    });\n    if (!response.ok) throw new Error(\"Failed to update commission status\");\n    return response.json();\n  },\n\n  getBroker: async (brokerId: number) => {\n    const response = await fetch(`/api/admin/brokers/${brokerId}`, {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to fetch broker\");\n    return response.json();\n  },\n\n  updateBroker: async (brokerId: number, data: any) => {\n    const response = await fetch(`/api/admin/brokers/${brokerId}`, {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify(data),\n    });\n    if (!response.ok) throw new Error(\"Failed to update broker\");\n    return response.json();\n  },\n\n  getStudent: async (studentId: number) => {\n    const response = await fetch(`/api/admin/students/${studentId}`, {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to fetch student\");\n    return response.json();\n  },\n\n  updateStudent: async (studentId: number, data: any) => {\n    const response = await fetch(`/api/admin/students/${studentId}`, {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify(data),\n    });\n    if (!response.ok) throw new Error(\"Failed to update student\");\n    return response.json();\n  },\n\n  assignBrokerToApplication: async (applicationId: number, brokerId: number) => {\n    const response = await fetch(`/api/admin/applications/${applicationId}/assign-broker`, {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify({ brokerId }),\n    });\n    if (!response.ok) throw new Error(\"Failed to assign broker\");\n    return response.json();\n  },\n\n  getDocuments: async () => {\n    const response = await fetch(\"/api/admin/documents\", {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to fetch documents\");\n    return response.json();\n  },\n\n  getDocumentsByOwner: async (ownerType: string, ownerId: number) => {\n    const response = await fetch(`/api/admin/documents/${ownerType}/${ownerId}`, {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to fetch documents\");\n    return response.json();\n  },\n\n  updateBrokerCommission: async (brokerId: number, commissionRate: string, commissionAmount: number | null) => {\n    const response = await fetch(`/api/admin/brokers/${brokerId}/commission`, {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify({ commissionRate, commissionAmount }),\n    });\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || \"Failed to update commission\");\n    }\n    return response.json();\n  },\n\n  changeBrokerPassword: async (brokerId: number, newPassword: string) => {\n    const response = await fetch(`/api/admin/brokers/${brokerId}/password`, {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify({ newPassword }),\n    });\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || \"Failed to change password\");\n    }\n    return response.json();\n  },\n\n  changeStudentPassword: async (studentId: number, newPassword: string) => {\n    const response = await fetch(`/api/admin/students/${studentId}/password`, {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify({ newPassword }),\n    });\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || \"Failed to change password\");\n    }\n    return response.json();\n  },\n};\n\n// Broker API\nexport const brokerApi = {\n  getStudents: async () => {\n    const response = await fetch(\"/api/broker/students\", {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to fetch students\");\n    return response.json();\n  },\n\n  createStudent: async (data: { name: string; email: string; visaType: string; adminId: number }) => {\n    const response = await fetch(\"/api/broker/students\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify(data),\n    });\n    if (!response.ok) throw new Error(\"Failed to create student\");\n    return response.json();\n  },\n\n  getApplications: async () => {\n    const response = await fetch(\"/api/broker/applications\", {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to fetch applications\");\n    return response.json();\n  },\n\n  updateApplicationStatus: async (applicationId: number, status: string) => {\n    const response = await fetch(`/api/broker/applications/${applicationId}/status`, {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify({ status }),\n    });\n    if (!response.ok) throw new Error(\"Failed to update application status\");\n    return response.json();\n  },\n\n  getCommissions: async () => {\n    const response = await fetch(\"/api/broker/commissions\", {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to fetch commissions\");\n    return response.json();\n  },\n\n  getProfile: async () => {\n    const response = await fetch(\"/api/broker/profile\", {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to fetch profile\");\n    return response.json();\n  },\n\n  updateProfile: async (data: any) => {\n    const response = await fetch(\"/api/broker/profile\", {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify(data),\n    });\n    if (!response.ok) throw new Error(\"Failed to update profile\");\n    return response.json();\n  },\n\n  getStudentDocuments: async (studentId: number) => {\n    const response = await fetch(`/api/broker/students/${studentId}/documents`, {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to fetch documents\");\n    return response.json();\n  },\n\n  updateDocumentStatus: async (documentId: number, status: string, notes?: string) => {\n    const response = await fetch(`/api/documents/${documentId}/status`, {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify({ status, notes }),\n    });\n    if (!response.ok) throw new Error(\"Failed to update document status\");\n    return response.json();\n  },\n};\n\n// Student API\nexport const studentApi = {\n  getApplications: async () => {\n    const response = await fetch(\"/api/student/applications\", {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to fetch applications\");\n    return response.json();\n  },\n\n  createApplication: async (data: {\n    visaType: string;\n    targetCountry: string;\n    purpose: string;\n    status?: string;\n    progress?: number;\n    lastAction?: string;\n  }) => {\n    const response = await fetch(\"/api/student/applications\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify(data),\n    });\n    if (!response.ok) throw new Error(\"Failed to create application\");\n    return response.json();\n  },\n\n  updateApplicationProgress: async (applicationId: number, progress: number, lastAction: string) => {\n    const response = await fetch(`/api/student/applications/${applicationId}/progress`, {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify({ progress, lastAction }),\n    });\n    if (!response.ok) throw new Error(\"Failed to update application progress\");\n    return response.json();\n  },\n\n  getProfile: async () => {\n    const response = await fetch(\"/api/student/profile\", {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to fetch profile\");\n    return response.json();\n  },\n\n  updateProfile: async (data: any) => {\n    const response = await fetch(\"/api/student/profile\", {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify(data),\n    });\n    if (!response.ok) throw new Error(\"Failed to update profile\");\n    return response.json();\n  },\n\n  chooseBroker: async (brokerId: number) => {\n    const response = await fetch(\"/api/student/choose-broker\", {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify({ brokerId }),\n    });\n    if (!response.ok) throw new Error(\"Failed to choose broker\");\n    return response.json();\n  },\n\n  getAssignedBroker: async () => {\n    const response = await fetch(\"/api/student/broker\", {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to fetch assigned broker\");\n    return response.json();\n  },\n};\n\n// Fetch all admins (for dropdown)\nexport const fetchAdmins = async () => {\n  const response = await fetch(\"/api/admins\", {\n    credentials: \"include\",\n  });\n  if (!response.ok) throw new Error(\"Failed to fetch admins\");\n  return response.json();\n};\n\n// Clear all data (admin only)\nexport const clearAllData = async () => {\n  const response = await fetch(\"/api/admin/clear-data\", {\n    method: \"POST\",\n    credentials: \"include\",\n  });\n  if (!response.ok) throw new Error(\"Failed to clear data\");\n  return response.json();\n};\n\n// Common API\nexport const commonApi = {\n  getAvailableBrokers: async () => {\n    const response = await fetch(\"/api/brokers/available\", {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to fetch brokers\");\n    return response.json();\n  },\n\n  getActivities: async () => {\n    const response = await fetch(\"/api/activities\", {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to fetch activities\");\n    return response.json();\n  },\n\n  getMyDocuments: async () => {\n    const response = await fetch(\"/api/documents/my\", {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to fetch documents\");\n    return response.json();\n  },\n\n  uploadDocument: async (data: { ownerType: string; ownerId: number; name: string; type: string; path: string }) => {\n    const response = await fetch(\"/api/documents\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify(data),\n    });\n    if (!response.ok) throw new Error(\"Failed to upload document\");\n    return response.json();\n  },\n\n  updateDocumentStatus: async (documentId: number, status: string, notes?: string) => {\n    const response = await fetch(`/api/documents/${documentId}/status`, {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify({ status, notes }),\n    });\n    if (!response.ok) throw new Error(\"Failed to update document status\");\n    return response.json();\n  },\n};\n","path":null,"size_bytes":13405,"size_tokens":null},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport tailwindcss from \"@tailwindcss/vite\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\nimport { metaImagesPlugin } from \"./vite-plugin-meta-images\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    tailwindcss(),\n    metaImagesPlugin(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  css: {\n    postcss: {\n      plugins: [],\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    host: \"0.0.0.0\",\n    allowedHosts: true,\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","path":null,"size_bytes":1330,"size_tokens":null},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent shadow-sm hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-9 px-2 min-w-9\",\n        sm: \"h-8 px-1.5 min-w-8\",\n        lg: \"h-10 px-2.5 min-w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","path":null,"size_bytes":1486,"size_tokens":null},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","path":null,"size_bytes":1723,"size_tokens":null},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n\" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n           // @replit: no hover, and add primary border\n           \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground shadow-sm border-destructive-border\",\n        outline:\n          // @replit Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color. Uses shadow-xs. no shadow on active\n          // No hover state\n          \" border [border-color:var(--button-outline)] shadow-xs active:shadow-none \",\n        secondary:\n          // @replit border, no hover, no shadow, secondary border.\n          \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // @replit no hover, transparent border\n        ghost: \"border border-transparent\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        // @replit changed sizes\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","path":null,"size_bytes":2356,"size_tokens":null},"client/src/pages/broker/profile.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { DashboardLayout } from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { useAuth } from \"@/lib/auth-context\";\nimport { brokerApi } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Edit, Save, X, Briefcase } from \"lucide-react\";\nimport { Badge } from \"@/components/ui/badge\";\n\nexport default function BrokerProfile() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isEditing, setIsEditing] = useState(false);\n  const [formData, setFormData] = useState({\n    name: \"\",\n    phone: \"\",\n    address: \"\",\n    companyName: \"\",\n    licenseNumber: \"\",\n  });\n  \n  const { data: profile, isLoading } = useQuery({\n    queryKey: [\"broker\", \"profile\"],\n    queryFn: brokerApi.getProfile,\n  });\n\n  useEffect(() => {\n    if (profile) {\n      setFormData({\n        name: profile.user?.name || \"\",\n        phone: profile.phone || \"\",\n        address: profile.address || \"\",\n        companyName: profile.companyName || \"\",\n        licenseNumber: profile.licenseNumber || \"\",\n      });\n    }\n  }, [profile]);\n\n  const updateMutation = useMutation({\n    mutationFn: brokerApi.updateProfile,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"broker\", \"profile\"] });\n      setIsEditing(false);\n      toast({ title: \"Profile updated\", description: \"Your profile has been saved.\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to update profile.\", variant: \"destructive\" });\n    },\n  });\n\n  const handleSave = () => {\n    updateMutation.mutate(formData);\n  };\n\n  const handleCancel = () => {\n    setFormData({\n      name: profile?.user?.name || \"\",\n      phone: profile?.phone || \"\",\n      address: profile?.address || \"\",\n      companyName: profile?.companyName || \"\",\n      licenseNumber: profile?.licenseNumber || \"\",\n    });\n    setIsEditing(false);\n  };\n\n  const initials = user?.name\n    ?.split(\" \")\n    .map((n) => n[0])\n    .join(\"\")\n    .toUpperCase() || \"BR\";\n\n  if (isLoading) {\n    return (\n      <DashboardLayout role=\"broker\">\n        <div className=\"flex items-center justify-center h-64\">\n          <p className=\"text-muted-foreground\">Loading profile...</p>\n        </div>\n      </DashboardLayout>\n    );\n  }\n\n  return (\n    <DashboardLayout role=\"broker\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-3xl font-display font-bold text-white\">My Profile</h1>\n          <p className=\"text-muted-foreground\">Manage your broker profile information.</p>\n        </div>\n        {!isEditing ? (\n          <Button onClick={() => setIsEditing(true)} data-testid=\"edit-profile-btn\">\n            <Edit className=\"w-4 h-4 mr-2\" /> Edit Profile\n          </Button>\n        ) : (\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" onClick={handleCancel} data-testid=\"cancel-edit-btn\">\n              <X className=\"w-4 h-4 mr-2\" /> Cancel\n            </Button>\n            <Button onClick={handleSave} disabled={updateMutation.isPending} data-testid=\"save-profile-btn\">\n              <Save className=\"w-4 h-4 mr-2\" /> Save\n            </Button>\n          </div>\n        )}\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n        <Card className=\"glass-panel border-white/5 lg:col-span-1 h-fit\">\n          <CardContent className=\"p-6 flex flex-col items-center space-y-4\">\n            <Avatar className=\"w-32 h-32\">\n              <AvatarFallback className=\"text-4xl bg-secondary/20 text-secondary\">\n                {initials}\n              </AvatarFallback>\n            </Avatar>\n            <div className=\"text-center space-y-2\">\n              <h3 className=\"font-bold text-xl\" data-testid=\"text-broker-name\">{user?.name || \"Broker\"}</h3>\n              <p className=\"text-sm text-muted-foreground\" data-testid=\"text-broker-id\">ID: BR-{user?.id || \"---\"}</p>\n              <Badge variant={profile?.status === \"Active\" ? \"default\" : \"secondary\"} data-testid=\"status-broker\">\n                {profile?.status || \"Active\"}\n              </Badge>\n            </div>\n            <div className=\"w-full pt-4 border-t border-white/10 space-y-2\">\n              <div className=\"flex justify-between text-sm\">\n                <span className=\"text-muted-foreground\">Commission Rate</span>\n                <span className=\"font-medium text-primary\" data-testid=\"text-commission-rate\">{profile?.commissionRate || \"10%\"}</span>\n              </div>\n              <div className=\"flex justify-between text-sm\">\n                <span className=\"text-muted-foreground\">Active Students</span>\n                <span className=\"font-medium\" data-testid=\"text-active-students\">{profile?.activeStudents || 0}</span>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"glass-panel border-white/5 lg:col-span-2\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Briefcase className=\"w-5 h-5\" /> Business Details\n            </CardTitle>\n            <CardDescription>{isEditing ? \"Edit your profile information\" : \"Your profile information\"}</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label>Full Name</Label>\n                <Input \n                  value={isEditing ? formData.name : (user?.name || \"\")} \n                  onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                  className=\"bg-white/5 border-white/10\" \n                  disabled={!isEditing}\n                  data-testid=\"input-name\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Email</Label>\n                <Input \n                  value={user?.email || \"\"} \n                  className=\"bg-white/5 border-white/10\" \n                  disabled \n                  data-testid=\"input-email\"\n                />\n              </div>\n            </div>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label>Phone</Label>\n                <Input \n                  value={isEditing ? formData.phone : (profile?.phone || \"Not provided\")} \n                  onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\n                  className=\"bg-white/5 border-white/10\" \n                  disabled={!isEditing}\n                  data-testid=\"input-phone\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label>License Number</Label>\n                <Input \n                  value={isEditing ? formData.licenseNumber : (profile?.licenseNumber || \"Not provided\")} \n                  onChange={(e) => setFormData({ ...formData, licenseNumber: e.target.value })}\n                  className=\"bg-white/5 border-white/10\" \n                  disabled={!isEditing}\n                  data-testid=\"input-license\"\n                />\n              </div>\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Company Name</Label>\n              <Input \n                value={isEditing ? formData.companyName : (profile?.companyName || \"Not provided\")} \n                onChange={(e) => setFormData({ ...formData, companyName: e.target.value })}\n                className=\"bg-white/5 border-white/10\" \n                disabled={!isEditing}\n                data-testid=\"input-company\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Address</Label>\n              <Input \n                value={isEditing ? formData.address : (profile?.address || \"Not provided\")} \n                onChange={(e) => setFormData({ ...formData, address: e.target.value })}\n                className=\"bg-white/5 border-white/10\" \n                disabled={!isEditing}\n                data-testid=\"input-address\"\n              />\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </DashboardLayout>\n  );\n}\n","path":null,"size_bytes":8565,"size_tokens":null},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"grid place-content-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","path":null,"size_bytes":1031,"size_tokens":null},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-2 w-full overflow-hidden rounded-full bg-primary/20\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","path":null,"size_bytes":792,"size_tokens":null},"shared/schema.ts":{"content":"import { z } from \"zod\";\n\nexport const roleEnum = [\"admin\", \"broker\", \"student\"] as const;\nexport const applicationStatusEnum = [\"Document Review\", \"Submitted\", \"Interview\", \"Approved\", \"Rejected\"] as const;\nexport const commissionStatusEnum = [\"Pending\", \"Approved\", \"Paid\", \"Rejected\"] as const;\nexport const documentStatusEnum = [\"Pending\", \"Approved\", \"Rejected\"] as const;\nexport const activityTypeEnum = [\"application_submitted\", \"application_updated\", \"broker_assigned\", \"document_uploaded\", \"document_reviewed\", \"commission_created\", \"profile_updated\", \"status_changed\"] as const;\n\nexport const insertUserSchema = z.object({\n  name: z.string().min(1),\n  email: z.string().email(),\n  password: z.string().min(1),\n  role: z.enum(roleEnum),\n});\n\nexport const insertBrokerSchema = z.object({\n  userId: z.number(),\n  adminId: z.number(),\n  commissionRate: z.string().default(\"10%\"),\n  commissionAmount: z.number().optional(),\n  status: z.string().default(\"Active\"),\n  phone: z.string().optional(),\n  address: z.string().optional(),\n  companyName: z.string().optional(),\n  licenseNumber: z.string().optional(),\n});\n\nexport const insertStudentSchema = z.object({\n  userId: z.number(),\n  adminId: z.number(),\n  brokerId: z.number().nullable().optional(),\n  passportNumber: z.string().optional(),\n  dateOfBirth: z.string().optional(),\n  currentAddress: z.string().optional(),\n  phone: z.string().optional(),\n  nationality: z.string().optional(),\n  education: z.string().optional(),\n});\n\nexport const insertApplicationSchema = z.object({\n  studentId: z.number(),\n  visaType: z.string(),\n  targetCountry: z.string(),\n  purpose: z.string().optional(),\n  status: z.enum(applicationStatusEnum).default(\"Document Review\"),\n  progress: z.number().default(0),\n  lastAction: z.string().optional(),\n});\n\nexport const insertCommissionSchema = z.object({\n  brokerId: z.number(),\n  studentId: z.number(),\n  amount: z.string(),\n  status: z.enum(commissionStatusEnum).default(\"Pending\"),\n});\n\nexport const insertDocumentSchema = z.object({\n  ownerType: z.enum(roleEnum),\n  ownerId: z.number(),\n  uploadedById: z.number(),\n  name: z.string(),\n  type: z.string(),\n  path: z.string(),\n  status: z.enum(documentStatusEnum).default(\"Pending\"),\n  notes: z.string().optional(),\n});\n\nexport const insertActivitySchema = z.object({\n  actorId: z.number(),\n  actorRole: z.enum(roleEnum),\n  targetType: z.string(),\n  targetId: z.number(),\n  activityType: z.enum(activityTypeEnum),\n  description: z.string(),\n  metadata: z.record(z.any()).optional(),\n});\n\nexport const updateStudentSchema = z.object({\n  passportNumber: z.string().optional(),\n  dateOfBirth: z.string().optional(),\n  currentAddress: z.string().optional(),\n  phone: z.string().optional(),\n  nationality: z.string().optional(),\n  education: z.string().optional(),\n  brokerId: z.number().nullable().optional(),\n});\n\nexport const updateBrokerSchema = z.object({\n  phone: z.string().optional(),\n  address: z.string().optional(),\n  companyName: z.string().optional(),\n  licenseNumber: z.string().optional(),\n  commissionRate: z.string().optional(),\n  commissionAmount: z.number().optional(),\n  status: z.string().optional(),\n});\n\nexport type User = {\n  id: number;\n  name: string;\n  email: string;\n  password: string;\n  role: typeof roleEnum[number];\n  createdAt: Date;\n};\n\nexport type InsertUser = z.infer<typeof insertUserSchema>;\n\nexport type Broker = {\n  id: number;\n  userId: number;\n  adminId: number;\n  commissionRate: string;\n  commissionAmount?: number | null;\n  status: string;\n  activeStudents: number;\n  phone?: string | null;\n  address?: string | null;\n  companyName?: string | null;\n  licenseNumber?: string | null;\n};\n\nexport type InsertBroker = z.infer<typeof insertBrokerSchema>;\n\nexport type Student = {\n  id: number;\n  userId: number;\n  adminId: number;\n  brokerId: number | null;\n  passportNumber?: string | null;\n  dateOfBirth?: string | null;\n  currentAddress?: string | null;\n  phone?: string | null;\n  nationality?: string | null;\n  education?: string | null;\n};\n\nexport type InsertStudent = z.infer<typeof insertStudentSchema>;\n\nexport type Application = {\n  id: number;\n  studentId: number;\n  visaType: string;\n  targetCountry: string;\n  purpose?: string | null;\n  status: typeof applicationStatusEnum[number];\n  progress: number;\n  submittedAt: Date;\n  lastAction?: string | null;\n};\n\nexport type InsertApplication = z.infer<typeof insertApplicationSchema>;\n\nexport type Commission = {\n  id: number;\n  brokerId: number;\n  studentId: number;\n  amount: string;\n  status: typeof commissionStatusEnum[number];\n  date: Date;\n};\n\nexport type InsertCommission = z.infer<typeof insertCommissionSchema>;\n\nexport type Document = {\n  id: number;\n  ownerType: typeof roleEnum[number];\n  ownerId: number;\n  uploadedById: number;\n  name: string;\n  type: string;\n  path: string;\n  status: typeof documentStatusEnum[number];\n  notes?: string | null;\n  uploadedAt: Date;\n};\n\nexport type InsertDocument = z.infer<typeof insertDocumentSchema>;\n\nexport type Activity = {\n  id: number;\n  actorId: number;\n  actorRole: typeof roleEnum[number];\n  targetType: string;\n  targetId: number;\n  activityType: typeof activityTypeEnum[number];\n  description: string;\n  metadata?: Record<string, any> | null;\n  createdAt: Date;\n};\n\nexport type InsertActivity = z.infer<typeof insertActivitySchema>;\n","path":null,"size_bytes":5325,"size_tokens":null},"client/src/pages/home.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { motion } from \"framer-motion\";\nimport { ArrowRight, Shield, Briefcase, GraduationCap, Globe } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { useAuth } from \"@/lib/auth-context\";\n\nexport default function Home() {\n  const [, setLocation] = useLocation();\n  const { isAuthenticated, user } = useAuth();\n  const [hoveredRole, setHoveredRole] = useState<string | null>(null);\n\n  const handleNavigation = (path: string) => {\n    if (isAuthenticated && user) {\n      // If logged in, go to their dashboard\n      setLocation(`/${user.role}`);\n    } else {\n      // If not logged in, go to login\n      setLocation(\"/login\");\n    }\n  };\n\n  const roles = [\n    {\n      id: \"admin\",\n      title: \"Admin Portal\",\n      icon: Shield,\n      description: \"Manage brokers, track commissions, and oversee all operations.\",\n      color: \"text-primary\",\n      gradient: \"from-cyan-500/20 to-blue-500/5\",\n      border: \"group-hover:border-cyan-500/50\",\n      path: \"/admin\"\n    },\n    {\n      id: \"broker\",\n      title: \"Broker Portal\",\n      icon: Briefcase,\n      description: \"Manage your students, track applications, and view earnings.\",\n      color: \"text-secondary\",\n      gradient: \"from-purple-500/20 to-pink-500/5\",\n      border: \"group-hover:border-purple-500/50\",\n      path: \"/broker\"\n    },\n    {\n      id: \"student\",\n      title: \"Student Portal\",\n      icon: GraduationCap,\n      description: \"Apply for visas, track progress, and connect with brokers.\",\n      color: \"text-accent\",\n      gradient: \"from-pink-500/20 to-rose-500/5\",\n      border: \"group-hover:border-pink-500/50\",\n      path: \"/student\"\n    }\n  ];\n\n  return (\n    <div className=\"min-h-screen w-full flex flex-col items-center justify-center relative overflow-hidden p-4\">\n      {/* Background Elements */}\n      <div className=\"absolute inset-0 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-slate-900/50 via-background to-background -z-10\"></div>\n      <div className=\"absolute top-0 left-0 w-full h-full bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 -z-10\"></div>\n      \n      {/* Floating Orbs */}\n      <motion.div \n        animate={{ \n          x: [0, 50, 0],\n          y: [0, -50, 0],\n          scale: [1, 1.2, 1] \n        }}\n        transition={{ duration: 20, repeat: Infinity, ease: \"easeInOut\" }}\n        className=\"absolute top-20 right-20 w-96 h-96 bg-primary/10 rounded-full blur-[100px] -z-10\"\n      />\n      <motion.div \n        animate={{ \n          x: [0, -30, 0],\n          y: [0, 40, 0],\n          scale: [1, 1.1, 1] \n        }}\n        transition={{ duration: 15, repeat: Infinity, ease: \"easeInOut\", delay: 2 }}\n        className=\"absolute bottom-20 left-20 w-80 h-80 bg-secondary/10 rounded-full blur-[100px] -z-10\"\n      />\n\n      <div className=\"max-w-5xl w-full space-y-12 z-10\">\n        <div className=\"text-center space-y-6\">\n          <motion.div\n            initial={{ opacity: 0, y: -20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.8 }}\n            className=\"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-white/5 border border-white/10 backdrop-blur-md mb-4\"\n          >\n            <Globe className=\"w-4 h-4 text-primary animate-pulse\" />\n            <span className=\"text-sm font-mono tracking-wider text-muted-foreground\">VISA CONSULTANCY 2.0</span>\n          </motion.div>\n          \n          <motion.h1 \n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.8, delay: 0.2 }}\n            className=\"text-6xl md:text-8xl font-display font-bold tracking-tighter text-transparent bg-clip-text bg-gradient-to-br from-white via-white/80 to-white/40\"\n          >\n            Visa<span className=\"text-primary\">Flow</span>\n          </motion.h1>\n          \n          <motion.p \n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.8, delay: 0.3 }}\n            className=\"text-xl text-muted-foreground max-w-2xl mx-auto leading-relaxed\"\n          >\n            The future of immigration management. Seamlessly connect students, brokers, and administrators in one unified, intelligent platform.\n          </motion.p>\n\n          <div className=\"flex justify-center gap-4 pt-4\">\n            {!isAuthenticated && (\n              <Button \n                size=\"lg\" \n                className=\"bg-primary text-primary-foreground hover:bg-primary/90 font-bold rounded-full px-8 shadow-[0_0_20px_-5px_hsl(var(--primary))]\"\n                onClick={() => setLocation(\"/signup\")}\n              >\n                Get Started\n              </Button>\n            )}\n             <Button \n                size=\"lg\" \n                variant=\"outline\"\n                className=\"border-white/10 hover:bg-white/5 rounded-full px-8\"\n                onClick={() => setLocation(isAuthenticated ? `/${user?.role}` : \"/login\")}\n              >\n                {isAuthenticated ? \"Go to Dashboard\" : \"Login\"}\n              </Button>\n          </div>\n        </div>\n\n        <div className=\"grid md:grid-cols-3 gap-6\">\n          {roles.map((role, index) => (\n            <motion.div\n              key={role.id}\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.5, delay: 0.4 + (index * 0.1) }}\n            >\n              <Card \n                className={`h-full bg-card/40 backdrop-blur-sm border-white/5 hover:bg-card/60 transition-all duration-500 group cursor-pointer border ${role.border} relative overflow-hidden`}\n                onMouseEnter={() => setHoveredRole(role.id)}\n                onMouseLeave={() => setHoveredRole(null)}\n                onClick={() => handleNavigation(role.path)}\n              >\n                <div className={`absolute inset-0 bg-gradient-to-br ${role.gradient} opacity-0 group-hover:opacity-100 transition-opacity duration-500`}></div>\n                <CardContent className=\"p-8 flex flex-col items-center text-center h-full relative z-10 space-y-6\">\n                  <div className={`p-4 rounded-2xl bg-white/5 border border-white/10 ${role.color} ring-1 ring-white/5 group-hover:scale-110 transition-transform duration-500 shadow-[0_0_30px_-10px_currentColor]`}>\n                    <role.icon className=\"w-8 h-8\" />\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <h3 className=\"text-2xl font-display font-bold\">{role.title}</h3>\n                    <p className=\"text-muted-foreground text-sm leading-relaxed\">\n                      {role.description}\n                    </p>\n                  </div>\n\n                  <div className=\"mt-auto pt-4\">\n                    <Button variant=\"ghost\" className=\"group-hover:translate-x-1 transition-transform duration-300 gap-2\">\n                      Enter Portal <ArrowRight className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n          ))}\n        </div>\n      </div>\n      \n      <div className=\"absolute bottom-0 left-0 w-full h-px bg-gradient-to-r from-transparent via-white/10 to-transparent\"></div>\n    </div>\n  );\n}\n","path":null,"size_bytes":7443,"size_tokens":null},"script/build.ts":{"content":"import { build as esbuild } from \"esbuild\";\nimport { build as viteBuild } from \"vite\";\nimport { rm, readFile } from \"fs/promises\";\n\n// server deps to bundle to reduce openat(2) syscalls\n// which helps cold start times\nconst allowlist = [\n  \"@google/generative-ai\",\n  \"axios\",\n  \"bcryptjs\",\n  \"cors\",\n  \"date-fns\",\n  \"express\",\n  \"express-rate-limit\",\n  \"express-session\",\n  \"jsonwebtoken\",\n  \"memorystore\",\n  \"mongoose\",\n  \"multer\",\n  \"nanoid\",\n  \"nodemailer\",\n  \"openai\",\n  \"passport\",\n  \"passport-local\",\n  \"stripe\",\n  \"uuid\",\n  \"ws\",\n  \"xlsx\",\n  \"zod\",\n  \"zod-validation-error\",\n];\n\nasync function buildAll() {\n  await rm(\"dist\", { recursive: true, force: true });\n\n  console.log(\"building client...\");\n  await viteBuild();\n\n  console.log(\"building server...\");\n  const pkg = JSON.parse(await readFile(\"package.json\", \"utf-8\"));\n  const allDeps = [\n    ...Object.keys(pkg.dependencies || {}),\n    ...Object.keys(pkg.devDependencies || {}),\n  ];\n  const externals = allDeps.filter((dep) => !allowlist.includes(dep));\n\n  await esbuild({\n    entryPoints: [\"server/index.ts\"],\n    platform: \"node\",\n    bundle: true,\n    format: \"cjs\",\n    outfile: \"dist/index.cjs\",\n    define: {\n      \"process.env.NODE_ENV\": '\"production\"',\n    },\n    minify: true,\n    external: externals,\n    logLevel: \"info\",\n  });\n}\n\nbuildAll().catch((err) => {\n  console.error(err);\n  process.exit(1);\n});\n","path":null,"size_bytes":1380,"size_tokens":null},"client/src/pages/admin/commissions.tsx":{"content":"import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { DashboardLayout } from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Check, X } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { adminApi } from \"@/lib/api\";\nimport { parseAmount, formatAmount } from \"@/lib/utils\";\n\nexport default function AdminCommissions() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const { data: commissions = [], isLoading } = useQuery({\n    queryKey: [\"admin\", \"commissions\"],\n    queryFn: adminApi.getCommissions,\n  });\n\n  const statusMutation = useMutation({\n    mutationFn: ({ commissionId, status }: { commissionId: number; status: string }) =>\n      adminApi.updateCommissionStatus(commissionId, status),\n    onSuccess: (_, variables) => {\n      queryClient.invalidateQueries({ queryKey: [\"admin\", \"commissions\"] });\n      toast({ \n        title: `Commission ${variables.status}`, \n        description: `Commission has been ${variables.status.toLowerCase()}.`,\n        variant: variables.status === \"Rejected\" ? \"destructive\" : \"default\"\n      });\n    },\n    onError: (error: any) => {\n      toast({ \n        title: \"Error\", \n        description: error.message || \"Failed to update commission\",\n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const handleAction = (id: number, action: 'Approved' | 'Rejected' | 'Paid') => {\n    statusMutation.mutate({ commissionId: id, status: action });\n  };\n\n  const totalPending = commissions\n    .filter((c: any) => c.status === 'Pending')\n    .reduce((acc: number, curr: any) => acc + parseAmount(curr.amount), 0);\n\n  const totalApproved = commissions\n    .filter((c: any) => c.status === 'Approved')\n    .reduce((acc: number, curr: any) => acc + parseAmount(curr.amount), 0);\n\n  const totalPaid = commissions\n    .filter((c: any) => c.status === 'Paid')\n    .reduce((acc: number, curr: any) => acc + parseAmount(curr.amount), 0);\n\n  if (isLoading) {\n    return (\n      <DashboardLayout role=\"admin\">\n        <div className=\"flex items-center justify-center h-64\">\n          <p className=\"text-muted-foreground\">Loading commissions...</p>\n        </div>\n      </DashboardLayout>\n    );\n  }\n\n  return (\n    <DashboardLayout role=\"admin\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-3xl font-display font-bold text-white\">Commission Tracking</h1>\n          <p className=\"text-muted-foreground\">Monitor and approve broker payouts.</p>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        <Card className=\"glass-card border-white/5\">\n          <CardContent className=\"p-6\">\n             <p className=\"text-sm text-muted-foreground\">Total Pending</p>\n             <h3 className=\"text-3xl font-bold font-mono text-yellow-500\">${totalPending.toFixed(2)}</h3>\n          </CardContent>\n        </Card>\n        <Card className=\"glass-card border-white/5\">\n          <CardContent className=\"p-6\">\n             <p className=\"text-sm text-muted-foreground\">Total Approved</p>\n             <h3 className=\"text-3xl font-bold font-mono text-blue-500\">${totalApproved.toFixed(2)}</h3>\n          </CardContent>\n        </Card>\n        <Card className=\"glass-card border-white/5\">\n          <CardContent className=\"p-6\">\n             <p className=\"text-sm text-muted-foreground\">Total Paid</p>\n             <h3 className=\"text-3xl font-bold font-mono text-green-500\">${totalPaid.toFixed(2)}</h3>\n          </CardContent>\n        </Card>\n      </div>\n\n      <Card className=\"glass-panel border-white/5\">\n        <CardHeader>\n          <CardTitle>Commission Requests</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <Table>\n            <TableHeader>\n              <TableRow className=\"border-white/10 hover:bg-white/5\">\n                <TableHead>Broker</TableHead>\n                <TableHead>Student</TableHead>\n                <TableHead>Amount</TableHead>\n                <TableHead>Status</TableHead>\n                <TableHead>Date</TableHead>\n                <TableHead className=\"text-right\">Actions</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {commissions.length === 0 ? (\n                <TableRow>\n                  <TableCell colSpan={6} className=\"text-center text-muted-foreground\">\n                    No commissions found\n                  </TableCell>\n                </TableRow>\n              ) : (\n                commissions.map((commission: any) => (\n                  <TableRow key={commission.id} className=\"border-white/10 hover:bg-white/5\">\n                    <TableCell className=\"font-medium\">{commission.broker?.user?.name || \"N/A\"}</TableCell>\n                    <TableCell>{commission.student?.user?.name || \"N/A\"}</TableCell>\n                    <TableCell className=\"font-mono\">{formatAmount(commission.amount)}</TableCell>\n                    <TableCell>\n                      <Badge variant=\"outline\" className={`\n                        ${commission.status === 'Paid' ? 'bg-green-500/10 text-green-500 border-green-500/20' : ''}\n                        ${commission.status === 'Approved' ? 'bg-blue-500/10 text-blue-500 border-blue-500/20' : ''}\n                        ${commission.status === 'Pending' ? 'bg-yellow-500/10 text-yellow-500 border-yellow-500/20' : ''}\n                        ${commission.status === 'Rejected' ? 'bg-red-500/10 text-red-500 border-red-500/20' : ''}\n                      `}>\n                        {commission.status}\n                      </Badge>\n                    </TableCell>\n                    <TableCell>{new Date(commission.date).toLocaleDateString()}</TableCell>\n                    <TableCell className=\"text-right space-x-2\">\n                      {commission.status === 'Pending' && (\n                        <>\n                          <Button \n                            size=\"sm\" \n                            variant=\"ghost\" \n                            className=\"text-green-500 hover:text-green-600 hover:bg-green-500/10\"\n                            onClick={() => handleAction(commission.id, 'Approved')}\n                          >\n                            <Check className=\"w-4 h-4\" />\n                          </Button>\n                          <Button \n                            size=\"sm\" \n                            variant=\"ghost\" \n                            className=\"text-red-500 hover:text-red-600 hover:bg-red-500/10\"\n                            onClick={() => handleAction(commission.id, 'Rejected')}\n                          >\n                            <X className=\"w-4 h-4\" />\n                          </Button>\n                        </>\n                      )}\n                      {commission.status === 'Approved' && (\n                        <Button \n                          size=\"sm\" \n                          variant=\"ghost\" \n                          className=\"text-primary hover:bg-primary/10\"\n                          onClick={() => handleAction(commission.id, 'Paid')}\n                        >\n                          Mark as Paid\n                        </Button>\n                      )}\n                    </TableCell>\n                  </TableRow>\n                ))\n              )}\n            </TableBody>\n          </Table>\n        </CardContent>\n      </Card>\n    </DashboardLayout>\n  );\n}\n","path":null,"size_bytes":7708,"size_tokens":null},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","path":null,"size_bytes":1037,"size_tokens":null},"client/src/pages/admin/dashboard.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { DashboardLayout } from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Users, TrendingUp, DollarSign, FileCheck, AlertCircle } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\nimport { Button } from \"@/components/ui/button\";\nimport { Link } from \"wouter\";\nimport { adminApi } from \"@/lib/api\";\nimport { parseAmount } from \"@/lib/utils\";\n\nexport default function AdminDashboard() {\n  const { data: brokers = [] } = useQuery({\n    queryKey: [\"admin\", \"brokers\"],\n    queryFn: adminApi.getBrokers,\n  });\n\n  const { data: students = [] } = useQuery({\n    queryKey: [\"admin\", \"students\"],\n    queryFn: adminApi.getStudents,\n  });\n\n  const { data: commissions = [] } = useQuery({\n    queryKey: [\"admin\", \"commissions\"],\n    queryFn: adminApi.getCommissions,\n  });\n\n  const totalRevenue = commissions\n    .filter((c: any) => c.status === 'Paid')\n    .reduce((acc: number, curr: any) => acc + parseAmount(curr.amount), 0);\n\n  const pendingApproval = commissions.filter((c: any) => c.status === 'Pending').length;\n\n  const activeBrokers = brokers.filter((b: any) => b.status === 'Active').length;\n  \n  const stats = [\n    { title: \"Total Revenue\", value: `$${totalRevenue.toFixed(2)}`, subtitle: \"from paid commissions\", icon: DollarSign, color: \"text-primary\" },\n    { title: \"Active Brokers\", value: activeBrokers.toString(), subtitle: `of ${brokers.length} total`, icon: Users, color: \"text-secondary\" },\n    { title: \"Total Students\", value: students.length.toString(), subtitle: \"registered\", icon: FileCheck, color: \"text-accent\" },\n    { title: \"Pending Approval\", value: pendingApproval.toString(), subtitle: \"commissions\", icon: AlertCircle, color: \"text-orange-500\" },\n  ];\n\n  return (\n    <DashboardLayout role=\"admin\">\n      <div className=\"flex flex-col gap-8\">\n        <div className=\"flex justify-between items-end\">\n          <div>\n            <h1 className=\"text-4xl font-display font-bold text-white mb-2\">Admin Overview</h1>\n            <p className=\"text-muted-foreground\">Welcome back, Administrator. System status is nominal.</p>\n          </div>\n          <Link href=\"/admin/brokers\">\n            <Button className=\"bg-primary text-primary-foreground hover:bg-primary/90 shadow-[0_0_20px_-5px_hsl(var(--primary))]\">\n              Manage Brokers\n            </Button>\n          </Link>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n          {stats.map((stat, i) => (\n            <motion.div\n              key={i}\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: i * 0.1 }}\n            >\n              <Card className=\"glass-card border-white/5 bg-white/5\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex justify-between items-start mb-4\">\n                    <div className={`p-3 rounded-xl bg-white/5 ${stat.color}`}>\n                      <stat.icon className=\"w-5 h-5\" />\n                    </div>\n                    <span className=\"text-xs font-mono px-2 py-1 rounded-full bg-white/5 text-muted-foreground\">\n                      {stat.subtitle}\n                    </span>\n                  </div>\n                  <div className=\"space-y-1\">\n                    <p className=\"text-sm text-muted-foreground\">{stat.title}</p>\n                    <h3 className=\"text-2xl font-bold font-mono\">{stat.value}</h3>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n          ))}\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          <Card className=\"lg:col-span-2 glass-panel border-white/5\">\n            <CardHeader>\n              <CardTitle>Quick Actions</CardTitle>\n            </CardHeader>\n            <CardContent className=\"grid grid-cols-2 gap-4\">\n              <Link href=\"/admin/brokers\">\n                <Button variant=\"outline\" className=\"w-full h-24 flex flex-col gap-2 border-white/10 hover:bg-white/5\">\n                  <Users className=\"w-6 h-6\" />\n                  <span>Manage Brokers</span>\n                </Button>\n              </Link>\n              <Link href=\"/admin/students\">\n                <Button variant=\"outline\" className=\"w-full h-24 flex flex-col gap-2 border-white/10 hover:bg-white/5\">\n                  <FileCheck className=\"w-6 h-6\" />\n                  <span>View Students</span>\n                </Button>\n              </Link>\n              <Link href=\"/admin/commissions\">\n                <Button variant=\"outline\" className=\"w-full h-24 flex flex-col gap-2 border-white/10 hover:bg-white/5\">\n                  <DollarSign className=\"w-6 h-6\" />\n                  <span>Commissions</span>\n                </Button>\n              </Link>\n              <Button variant=\"outline\" className=\"w-full h-24 flex flex-col gap-2 border-white/10 hover:bg-white/5\">\n                <TrendingUp className=\"w-6 h-6\" />\n                <span>Analytics</span>\n              </Button>\n            </CardContent>\n          </Card>\n\n          <Card className=\"glass-panel border-white/5\">\n            <CardHeader>\n              <CardTitle>Recent Activity</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              {brokers.length === 0 && students.length === 0 ? (\n                <div className=\"text-center py-8 text-muted-foreground\">\n                  <p>No recent activity</p>\n                  <Link href=\"/admin/brokers\">\n                    <Button variant=\"link\" className=\"text-primary mt-2\">\n                      Add your first broker\n                    </Button>\n                  </Link>\n                </div>\n              ) : (\n                <>\n                  {brokers.slice(0, 3).map((broker: any, i: number) => (\n                    <motion.div \n                      key={broker.id}\n                      initial={{ opacity: 0, x: -20 }}\n                      animate={{ opacity: 1, x: 0 }}\n                      transition={{ delay: i * 0.05 }}\n                      className=\"flex items-center gap-4 group cursor-pointer\"\n                    >\n                      <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-primary/20 to-secondary/20 flex items-center justify-center text-xs font-bold border border-white/10 group-hover:border-primary/50 transition-colors\">\n                        {broker.user?.name?.split(' ').map((n: string) => n[0]).join('').toUpperCase() || 'BR'}\n                      </div>\n                      <div className=\"flex-1 min-w-0\">\n                        <p className=\"font-medium text-sm truncate group-hover:text-primary transition-colors\">\n                          {broker.user?.name || 'Broker'}\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {broker.user?.email || 'No email'}\n                        </p>\n                      </div>\n                    </motion.div>\n                  ))}\n                </>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </DashboardLayout>\n  );\n}\n","path":null,"size_bytes":7277,"size_tokens":null},"client/src/components/ui/field.tsx":{"content":"\"use client\"\n\nimport { useMemo } from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\nimport { Separator } from \"@/components/ui/separator\"\n\nfunction FieldSet({ className, ...props }: React.ComponentProps<\"fieldset\">) {\n  return (\n    <fieldset\n      data-slot=\"field-set\"\n      className={cn(\n        \"flex flex-col gap-6\",\n        \"has-[>[data-slot=checkbox-group]]:gap-3 has-[>[data-slot=radio-group]]:gap-3\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldLegend({\n  className,\n  variant = \"legend\",\n  ...props\n}: React.ComponentProps<\"legend\"> & { variant?: \"legend\" | \"label\" }) {\n  return (\n    <legend\n      data-slot=\"field-legend\"\n      data-variant={variant}\n      className={cn(\n        \"mb-3 font-medium\",\n        \"data-[variant=legend]:text-base\",\n        \"data-[variant=label]:text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-group\"\n      className={cn(\n        \"group/field-group @container/field-group flex w-full flex-col gap-7 data-[slot=checkbox-group]:gap-3 [&>[data-slot=field-group]]:gap-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst fieldVariants = cva(\n  \"group/field data-[invalid=true]:text-destructive flex w-full gap-3\",\n  {\n    variants: {\n      orientation: {\n        vertical: [\"flex-col [&>*]:w-full [&>.sr-only]:w-auto\"],\n        horizontal: [\n          \"flex-row items-center\",\n          \"[&>[data-slot=field-label]]:flex-auto\",\n          \"has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px has-[>[data-slot=field-content]]:items-start\",\n        ],\n        responsive: [\n          \"@md/field-group:flex-row @md/field-group:items-center @md/field-group:[&>*]:w-auto flex-col [&>*]:w-full [&>.sr-only]:w-auto\",\n          \"@md/field-group:[&>[data-slot=field-label]]:flex-auto\",\n          \"@md/field-group:has-[>[data-slot=field-content]]:items-start @md/field-group:has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px\",\n        ],\n      },\n    },\n    defaultVariants: {\n      orientation: \"vertical\",\n    },\n  }\n)\n\nfunction Field({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof fieldVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"field\"\n      data-orientation={orientation}\n      className={cn(fieldVariants({ orientation }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction FieldContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-content\"\n      className={cn(\n        \"group/field-content flex flex-1 flex-col gap-1.5 leading-snug\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldLabel({\n  className,\n  ...props\n}: React.ComponentProps<typeof Label>) {\n  return (\n    <Label\n      data-slot=\"field-label\"\n      className={cn(\n        \"group/field-label peer/field-label flex w-fit gap-2 leading-snug group-data-[disabled=true]/field:opacity-50\",\n        \"has-[>[data-slot=field]]:w-full has-[>[data-slot=field]]:flex-col has-[>[data-slot=field]]:rounded-md has-[>[data-slot=field]]:border [&>[data-slot=field]]:p-4\",\n        \"has-data-[state=checked]:bg-primary/5 has-data-[state=checked]:border-primary dark:has-data-[state=checked]:bg-primary/10\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-label\"\n      className={cn(\n        \"flex w-fit items-center gap-2 text-sm font-medium leading-snug group-data-[disabled=true]/field:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <p\n      data-slot=\"field-description\"\n      className={cn(\n        \"text-muted-foreground text-sm font-normal leading-normal group-has-[[data-orientation=horizontal]]/field:text-balance\",\n        \"nth-last-2:-mt-1 last:mt-0 [[data-variant=legend]+&]:-mt-1.5\",\n        \"[&>a:hover]:text-primary [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldSeparator({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  children?: React.ReactNode\n}) {\n  return (\n    <div\n      data-slot=\"field-separator\"\n      data-content={!!children}\n      className={cn(\n        \"relative -my-2 h-5 text-sm group-data-[variant=outline]/field-group:-mb-2\",\n        className\n      )}\n      {...props}\n    >\n      <Separator className=\"absolute inset-0 top-1/2\" />\n      {children && (\n        <span\n          className=\"bg-background text-muted-foreground relative mx-auto block w-fit px-2\"\n          data-slot=\"field-separator-content\"\n        >\n          {children}\n        </span>\n      )}\n    </div>\n  )\n}\n\nfunction FieldError({\n  className,\n  children,\n  errors,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  errors?: Array<{ message?: string } | undefined>\n}) {\n  const content = useMemo(() => {\n    if (children) {\n      return children\n    }\n\n    if (!errors) {\n      return null\n    }\n\n    if (errors?.length === 1 && errors[0]?.message) {\n      return errors[0].message\n    }\n\n    return (\n      <ul className=\"ml-4 flex list-disc flex-col gap-1\">\n        {errors.map(\n          (error, index) =>\n            error?.message && <li key={index}>{error.message}</li>\n        )}\n      </ul>\n    )\n  }, [children, errors])\n\n  if (!content) {\n    return null\n  }\n\n  return (\n    <div\n      role=\"alert\"\n      data-slot=\"field-error\"\n      className={cn(\"text-destructive text-sm font-normal\", className)}\n      {...props}\n    >\n      {content}\n    </div>\n  )\n}\n\nexport {\n  Field,\n  FieldLabel,\n  FieldDescription,\n  FieldError,\n  FieldGroup,\n  FieldLegend,\n  FieldSeparator,\n  FieldSet,\n  FieldContent,\n  FieldTitle,\n}\n","path":null,"size_bytes":6044,"size_tokens":null},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","path":null,"size_bytes":157,"size_tokens":null},"client/src/pages/student/application.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { DashboardLayout } from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Send, ArrowLeft } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useLocation, Link } from \"wouter\";\nimport { studentApi } from \"@/lib/api\";\n\nexport default function StudentApplication() {\n  const { toast } = useToast();\n  const [, setLocation] = useLocation();\n  const queryClient = useQueryClient();\n\n  const [formData, setFormData] = useState({\n    visaType: \"\",\n    targetCountry: \"\",\n    purpose: \"\",\n  });\n\n  const createMutation = useMutation({\n    mutationFn: studentApi.createApplication,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"student\", \"applications\"] });\n      toast({ \n        title: \"Application Submitted\", \n        description: \"Your visa application has been created and is now under review.\" \n      });\n      setLocation(\"/student\");\n    },\n    onError: (error: any) => {\n      toast({ \n        title: \"Error\", \n        description: error.message || \"Failed to submit application\",\n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const handleSubmit = () => {\n    if (!formData.visaType || !formData.targetCountry) {\n      toast({ \n        title: \"Missing Information\", \n        description: \"Please select visa type and target country.\",\n        variant: \"destructive\" \n      });\n      return;\n    }\n\n    createMutation.mutate({\n      visaType: formData.visaType,\n      targetCountry: formData.targetCountry,\n      purpose: formData.purpose || \"\",\n    });\n  };\n\n  return (\n    <DashboardLayout role=\"student\">\n      <div className=\"max-w-4xl mx-auto\">\n        <div className=\"flex justify-between items-center mb-8\">\n          <div className=\"flex items-center gap-4\">\n            <Link href=\"/student\">\n              <Button variant=\"ghost\" size=\"icon\" className=\"rounded-full\">\n                <ArrowLeft className=\"w-5 h-5\" />\n              </Button>\n            </Link>\n            <div>\n              <h1 className=\"text-3xl font-display font-bold text-white\">New Visa Application</h1>\n              <p className=\"text-muted-foreground\">Complete your application details.</p>\n            </div>\n          </div>\n          <Button \n            className=\"bg-primary text-primary-foreground\" \n            onClick={handleSubmit}\n            disabled={createMutation.isPending}\n          >\n            {createMutation.isPending ? \"Submitting...\" : (\n              <>\n                <Send className=\"w-4 h-4 mr-2\" /> Submit Application\n              </>\n            )}\n          </Button>\n        </div>\n\n        <div className=\"space-y-6\">\n          <Card className=\"glass-panel border-white/5\">\n            <CardHeader>\n              <CardTitle>Visa Details</CardTitle>\n              <CardDescription>Tell us about your visa requirements</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label>Target Country *</Label>\n                <Select \n                  value={formData.targetCountry}\n                  onValueChange={(val) => setFormData({...formData, targetCountry: val})}\n                >\n                  <SelectTrigger className=\"bg-white/5 border-white/10\">\n                    <SelectValue placeholder=\"Select destination country\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"United States\">United States</SelectItem>\n                    <SelectItem value=\"United Kingdom\">United Kingdom</SelectItem>\n                    <SelectItem value=\"Canada\">Canada</SelectItem>\n                    <SelectItem value=\"Australia\">Australia</SelectItem>\n                    <SelectItem value=\"Germany\">Germany</SelectItem>\n                    <SelectItem value=\"France\">France</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Visa Type *</Label>\n                <Select \n                  value={formData.visaType}\n                  onValueChange={(val) => setFormData({...formData, visaType: val})}\n                >\n                  <SelectTrigger className=\"bg-white/5 border-white/10\">\n                    <SelectValue placeholder=\"Select visa type\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"F-1 Student\">F-1 Student Visa</SelectItem>\n                    <SelectItem value=\"J-1 Exchange\">J-1 Exchange Visitor</SelectItem>\n                    <SelectItem value=\"H-1B Work\">H-1B Work Visa</SelectItem>\n                    <SelectItem value=\"O-1 Talent\">O-1 Extraordinary Ability</SelectItem>\n                    <SelectItem value=\"B-1/B-2 Visitor\">B-1/B-2 Business/Tourist</SelectItem>\n                    <SelectItem value=\"L-1 Transfer\">L-1 Intracompany Transfer</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Purpose of Travel</Label>\n                <Textarea \n                  placeholder=\"Describe your purpose of travel and any additional details...\"\n                  className=\"bg-white/5 border-white/10 min-h-[120px]\"\n                  value={formData.purpose}\n                  onChange={(e) => setFormData({...formData, purpose: e.target.value})}\n                />\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"glass-panel border-white/5 border-l-4 border-l-primary\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-start gap-4\">\n                <div className=\"p-3 rounded-full bg-primary/20 text-primary\">\n                  <Send className=\"w-5 h-5\" />\n                </div>\n                <div>\n                  <h4 className=\"font-semibold mb-1\">What happens next?</h4>\n                  <p className=\"text-sm text-muted-foreground\">\n                    After submitting your application, your assigned broker will review your details \n                    and contact you with next steps. You'll be able to track the progress from your dashboard.\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </DashboardLayout>\n  );\n}\n","path":null,"size_bytes":6863,"size_tokens":null},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","path":null,"size_bytes":140,"size_tokens":null},"client/src/pages/student/profile.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { DashboardLayout } from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { useAuth } from \"@/lib/auth-context\";\nimport { studentApi, commonApi } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Edit, Save, X, UserPlus } from \"lucide-react\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\n\nexport default function StudentProfile() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isEditing, setIsEditing] = useState(false);\n  const [formData, setFormData] = useState({\n    name: \"\",\n    passportNumber: \"\",\n    dateOfBirth: \"\",\n    currentAddress: \"\",\n    phone: \"\",\n    nationality: \"\",\n    education: \"\",\n  });\n  \n  const { data: profile, isLoading } = useQuery({\n    queryKey: [\"student\", \"profile\"],\n    queryFn: studentApi.getProfile,\n  });\n\n  useEffect(() => {\n    if (profile) {\n      setFormData({\n        name: profile.user?.name || \"\",\n        passportNumber: profile.passportNumber || \"\",\n        dateOfBirth: profile.dateOfBirth || \"\",\n        currentAddress: profile.currentAddress || \"\",\n        phone: profile.phone || \"\",\n        nationality: profile.nationality || \"\",\n        education: profile.education || \"\",\n      });\n    }\n  }, [profile]);\n\n  const { data: availableBrokers = [] } = useQuery({\n    queryKey: [\"available-brokers\"],\n    queryFn: commonApi.getAvailableBrokers,\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: studentApi.updateProfile,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"student\", \"profile\"] });\n      setIsEditing(false);\n      toast({ title: \"Profile updated\", description: \"Your profile has been saved.\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to update profile.\", variant: \"destructive\" });\n    },\n  });\n\n  const chooseBrokerMutation = useMutation({\n    mutationFn: studentApi.chooseBroker,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"student\", \"profile\"] });\n      toast({ title: \"Broker assigned\", description: \"You have been assigned to the selected broker.\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to assign broker.\", variant: \"destructive\" });\n    },\n  });\n\n  const handleSave = () => {\n    updateMutation.mutate(formData);\n  };\n\n  const handleCancel = () => {\n    setFormData({\n      name: profile?.user?.name || \"\",\n      passportNumber: profile?.passportNumber || \"\",\n      dateOfBirth: profile?.dateOfBirth || \"\",\n      currentAddress: profile?.currentAddress || \"\",\n      phone: profile?.phone || \"\",\n      nationality: profile?.nationality || \"\",\n      education: profile?.education || \"\",\n    });\n    setIsEditing(false);\n  };\n\n  const initials = user?.name\n    ?.split(\" \")\n    .map((n) => n[0])\n    .join(\"\")\n    .toUpperCase() || \"ST\";\n\n  if (isLoading) {\n    return (\n      <DashboardLayout role=\"student\">\n        <div className=\"flex items-center justify-center h-64\">\n          <p className=\"text-muted-foreground\">Loading profile...</p>\n        </div>\n      </DashboardLayout>\n    );\n  }\n\n  return (\n    <DashboardLayout role=\"student\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-3xl font-display font-bold text-white\">My Profile</h1>\n          <p className=\"text-muted-foreground\">Manage your personal information.</p>\n        </div>\n        {!isEditing ? (\n          <Button onClick={() => setIsEditing(true)} data-testid=\"edit-profile-btn\">\n            <Edit className=\"w-4 h-4 mr-2\" /> Edit Profile\n          </Button>\n        ) : (\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" onClick={handleCancel} data-testid=\"cancel-edit-btn\">\n              <X className=\"w-4 h-4 mr-2\" /> Cancel\n            </Button>\n            <Button onClick={handleSave} disabled={updateMutation.isPending} data-testid=\"save-profile-btn\">\n              <Save className=\"w-4 h-4 mr-2\" /> Save\n            </Button>\n          </div>\n        )}\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n        <Card className=\"glass-panel border-white/5 lg:col-span-1 h-fit\">\n          <CardContent className=\"p-6 flex flex-col items-center space-y-4\">\n            <Avatar className=\"w-32 h-32\">\n              <AvatarFallback className=\"text-4xl bg-primary/20 text-primary\">\n                {initials}\n              </AvatarFallback>\n            </Avatar>\n            <div className=\"text-center\">\n              <h3 className=\"font-bold text-xl\">{user?.name || \"Student\"}</h3>\n              <p className=\"text-sm text-muted-foreground\">ID: ST-{user?.id || \"---\"}</p>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"glass-panel border-white/5 lg:col-span-2\">\n          <CardHeader>\n            <CardTitle>Account Details</CardTitle>\n            <CardDescription>{isEditing ? \"Edit your profile information\" : \"Your profile information\"}</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label>Full Name</Label>\n                <Input \n                  value={isEditing ? formData.name : (user?.name || \"\")} \n                  onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                  className=\"bg-white/5 border-white/10\" \n                  disabled={!isEditing}\n                  data-testid=\"input-name\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Email</Label>\n                <Input \n                  value={user?.email || \"\"} \n                  className=\"bg-white/5 border-white/10\" \n                  disabled \n                  data-testid=\"input-email\"\n                />\n              </div>\n            </div>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label>Phone</Label>\n                <Input \n                  value={isEditing ? formData.phone : (profile?.phone || \"Not provided\")} \n                  onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\n                  className=\"bg-white/5 border-white/10\" \n                  disabled={!isEditing}\n                  data-testid=\"input-phone\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Nationality</Label>\n                <Input \n                  value={isEditing ? formData.nationality : (profile?.nationality || \"Not provided\")} \n                  onChange={(e) => setFormData({ ...formData, nationality: e.target.value })}\n                  className=\"bg-white/5 border-white/10\" \n                  disabled={!isEditing}\n                  data-testid=\"input-nationality\"\n                />\n              </div>\n            </div>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label>Passport Number</Label>\n                <Input \n                  value={isEditing ? formData.passportNumber : (profile?.passportNumber || \"Not provided\")} \n                  onChange={(e) => setFormData({ ...formData, passportNumber: e.target.value })}\n                  className=\"bg-white/5 border-white/10\" \n                  disabled={!isEditing}\n                  data-testid=\"input-passport\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Date of Birth</Label>\n                <Input \n                  type={isEditing ? \"date\" : \"text\"}\n                  value={isEditing ? formData.dateOfBirth : (profile?.dateOfBirth || \"Not provided\")} \n                  onChange={(e) => setFormData({ ...formData, dateOfBirth: e.target.value })}\n                  className=\"bg-white/5 border-white/10\" \n                  disabled={!isEditing}\n                  data-testid=\"input-dob\"\n                />\n              </div>\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Education</Label>\n              <Input \n                value={isEditing ? formData.education : (profile?.education || \"Not provided\")} \n                onChange={(e) => setFormData({ ...formData, education: e.target.value })}\n                className=\"bg-white/5 border-white/10\" \n                disabled={!isEditing}\n                data-testid=\"input-education\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Current Address</Label>\n              <Input \n                value={isEditing ? formData.currentAddress : (profile?.currentAddress || \"Not provided\")} \n                onChange={(e) => setFormData({ ...formData, currentAddress: e.target.value })}\n                className=\"bg-white/5 border-white/10\" \n                disabled={!isEditing}\n                data-testid=\"input-address\"\n              />\n            </div>\n          </CardContent>\n        </Card>\n\n        {!profile?.brokerId && availableBrokers.length > 0 && (\n          <Card className=\"glass-panel border-white/5 lg:col-span-3\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <UserPlus className=\"w-5 h-5\" /> Choose Your Broker\n              </CardTitle>\n              <CardDescription>Select a broker to help manage your visa application</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex gap-4 items-end\">\n                <div className=\"flex-1 space-y-2\">\n                  <Label>Available Brokers</Label>\n                  <Select onValueChange={(value) => chooseBrokerMutation.mutate(parseInt(value))}>\n                    <SelectTrigger className=\"bg-white/5 border-white/10\" data-testid=\"select-broker\">\n                      <SelectValue placeholder=\"Select a broker\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {availableBrokers.map((broker: any) => (\n                        <SelectItem key={broker.id} value={broker.id.toString()}>\n                          {broker.user?.name} - {broker.commissionRate} commission\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {profile?.brokerId && (\n          <Card className=\"glass-panel border-white/5 lg:col-span-3\">\n            <CardHeader>\n              <CardTitle>Your Broker</CardTitle>\n              <CardDescription>You are assigned to a broker who will help manage your application</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-muted-foreground\">Broker ID: {profile.brokerId}</p>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </DashboardLayout>\n  );\n}\n","path":null,"size_bytes":11484,"size_tokens":null},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n\nexport function parseAmount(amount: string | number | null | undefined): number {\n  if (amount === null || amount === undefined) return 0;\n  if (typeof amount === 'number') return amount;\n  const parsed = parseFloat(amount.replace(/[^0-9.-]/g, ''));\n  return isNaN(parsed) ? 0 : parsed;\n}\n\nexport function formatAmount(amount: string | number | null | undefined): string {\n  const num = parseAmount(amount);\n  return `$${num.toFixed(2)}`;\n}\n","path":null,"size_bytes":608,"size_tokens":null},"client/src/pages/broker/dashboard.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { DashboardLayout } from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Users, DollarSign, FileText, Clock, Plus } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\nimport { Button } from \"@/components/ui/button\";\nimport { Link } from \"wouter\";\nimport { brokerApi } from \"@/lib/api\";\nimport { parseAmount } from \"@/lib/utils\";\n\nexport default function BrokerDashboard() {\n  const { data: students = [] } = useQuery({\n    queryKey: [\"broker\", \"students\"],\n    queryFn: brokerApi.getStudents,\n  });\n\n  const { data: applications = [] } = useQuery({\n    queryKey: [\"broker\", \"applications\"],\n    queryFn: brokerApi.getApplications,\n  });\n\n  const { data: commissions = [] } = useQuery({\n    queryKey: [\"broker\", \"commissions\"],\n    queryFn: brokerApi.getCommissions,\n  });\n\n  const pendingCommissions = commissions\n    .filter((c: any) => c.status === 'Pending' || c.status === 'Approved')\n    .reduce((acc: number, curr: any) => acc + parseAmount(curr.amount), 0);\n\n  const processingApps = applications.filter((a: any) => \n    a.status !== 'Approved' && a.status !== 'Rejected'\n  ).length;\n\n  return (\n    <DashboardLayout role=\"broker\">\n      <div className=\"flex flex-col gap-8\">\n        <div className=\"flex justify-between items-end\">\n          <div>\n            <h1 className=\"text-4xl font-display font-bold text-white mb-2\">Broker Portal</h1>\n            <p className=\"text-muted-foreground\">Manage your student portfolio and commissions.</p>\n          </div>\n          <Link href=\"/broker/students\">\n            <Button className=\"bg-secondary text-secondary-foreground hover:bg-secondary/90 shadow-[0_0_20px_-5px_hsl(var(--secondary))]\">\n              <Plus className=\"w-4 h-4 mr-2\" /> Add New Student\n            </Button>\n          </Link>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: 0.1 }}\n          >\n            <Card className=\"glass-card border-white/5 relative overflow-hidden\">\n              <div className=\"absolute top-0 right-0 w-32 h-32 bg-secondary/10 blur-[50px] -mr-10 -mt-10\"></div>\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center gap-4 mb-4\">\n                  <div className=\"p-3 rounded-xl bg-secondary/20 text-secondary\">\n                    <Users className=\"w-6 h-6\" />\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">Active Students</p>\n                    <h3 className=\"text-3xl font-bold font-mono\">{students.length}</h3>\n                  </div>\n                </div>\n                <div className=\"w-full bg-white/5 h-1 rounded-full overflow-hidden\">\n                  <div className=\"bg-secondary h-full\" style={{ width: `${Math.min(students.length * 10, 100)}%` }}></div>\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: 0.2 }}\n          >\n            <Card className=\"glass-card border-white/5 relative overflow-hidden\">\n              <div className=\"absolute top-0 right-0 w-32 h-32 bg-primary/10 blur-[50px] -mr-10 -mt-10\"></div>\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center gap-4 mb-4\">\n                  <div className=\"p-3 rounded-xl bg-primary/20 text-primary\">\n                    <DollarSign className=\"w-6 h-6\" />\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">Pending Commission</p>\n                    <h3 className=\"text-3xl font-bold font-mono\">${pendingCommissions.toFixed(2)}</h3>\n                  </div>\n                </div>\n                <div className=\"w-full bg-white/5 h-1 rounded-full overflow-hidden\">\n                  <div className=\"bg-primary h-full w-[45%]\"></div>\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: 0.3 }}\n          >\n            <Card className=\"glass-card border-white/5 relative overflow-hidden\">\n              <div className=\"absolute top-0 right-0 w-32 h-32 bg-accent/10 blur-[50px] -mr-10 -mt-10\"></div>\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center gap-4 mb-4\">\n                  <div className=\"p-3 rounded-xl bg-accent/20 text-accent\">\n                    <Clock className=\"w-6 h-6\" />\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">Processing Apps</p>\n                    <h3 className=\"text-3xl font-bold font-mono\">{processingApps}</h3>\n                  </div>\n                </div>\n                <div className=\"w-full bg-white/5 h-1 rounded-full overflow-hidden\">\n                  <div className=\"bg-accent h-full\" style={{ width: `${Math.min(processingApps * 15, 100)}%` }}></div>\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n        </div>\n\n        <Card className=\"glass-panel border-white/5 flex-1\">\n          <CardHeader>\n            <CardTitle>Assigned Students</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              {students.length === 0 ? (\n                <div className=\"text-center py-8 text-muted-foreground\">\n                  <Users className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n                  <p>No students assigned yet.</p>\n                  <Link href=\"/broker/students\">\n                    <Button variant=\"link\" className=\"text-primary mt-2\">\n                      Add your first student\n                    </Button>\n                  </Link>\n                </div>\n              ) : (\n                students.slice(0, 5).map((student: any, i: number) => (\n                  <motion.div \n                    key={student.id}\n                    initial={{ opacity: 0, x: -20 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    transition={{ delay: i * 0.05 }}\n                    className=\"flex items-center justify-between p-4 rounded-lg bg-white/5 border border-white/5 hover:bg-white/10 transition-colors\"\n                  >\n                    <div className=\"flex items-center gap-4\">\n                      <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-primary/20 to-secondary/20 flex items-center justify-center text-xs font-bold border border-white/10\">\n                        {student.user?.name?.split(' ').map((n: string) => n[0]).join('').toUpperCase() || 'ST'}\n                      </div>\n                      <div>\n                        <p className=\"font-medium\">{student.user?.name || 'Unknown'}</p>\n                        <p className=\"text-xs text-muted-foreground\">{student.user?.email || 'No email'}</p>\n                      </div>\n                    </div>\n                    <Link href=\"/broker/students\">\n                      <Button variant=\"ghost\" size=\"sm\">View</Button>\n                    </Link>\n                  </motion.div>\n                ))\n              )}\n              {students.length > 5 && (\n                <Link href=\"/broker/students\">\n                  <Button variant=\"link\" className=\"w-full text-muted-foreground\">\n                    View all {students.length} students\n                  </Button>\n                </Link>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </DashboardLayout>\n  );\n}\n","path":null,"size_bytes":7939,"size_tokens":null},"client/src/components/ui/menubar.tsx":{"content":"import * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-9 items-center space-x-1 rounded-md border bg-background p-1 shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-4 w-4 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","path":null,"size_bytes":8608,"size_tokens":null},"server/vite.ts":{"content":"import { type Express } from \"express\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport async function setupVite(server: Server, app: Express) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server, path: \"/vite-hmr\" },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n","path":null,"size_bytes":1534,"size_tokens":null},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\n      \"p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n      className\n    )}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","path":null,"size_bytes":2859,"size_tokens":null},"server/db.ts":{"content":"import mongoose from \"mongoose\";\n\nconst MONGODB_URI = process.env.MONGODB_URI;\n\nif (!MONGODB_URI) {\n  throw new Error(\n    \"MONGODB_URI must be set. Did you forget to add a MongoDB connection string?\",\n  );\n}\n\nlet isConnected = false;\n\nexport async function connectToDatabase(): Promise<typeof mongoose> {\n  if (isConnected) {\n    return mongoose;\n  }\n\n  try {\n    await mongoose.connect(MONGODB_URI as string);\n    isConnected = true;\n    console.log(\"Connected to MongoDB\");\n    return mongoose;\n  } catch (error) {\n    console.error(\"MongoDB connection error:\", error);\n    throw error;\n  }\n}\n\nconst counterSchema = new mongoose.Schema({\n  _id: { type: String, required: true },\n  seq: { type: Number, default: 0 }\n});\n\nconst Counter = mongoose.models.Counter || mongoose.model(\"Counter\", counterSchema);\n\nexport async function getNextSequence(name: string): Promise<number> {\n  const counter = await Counter.findByIdAndUpdate(\n    name,\n    { $inc: { seq: 1 } },\n    { new: true, upsert: true }\n  );\n  return counter.seq;\n}\n\nconst userSchema = new mongoose.Schema({\n  id: { type: Number, required: true, unique: true },\n  name: { type: String, required: true },\n  email: { type: String, required: true, unique: true },\n  password: { type: String, required: true },\n  role: { type: String, enum: [\"admin\", \"broker\", \"student\"], required: true },\n  createdAt: { type: Date, default: Date.now },\n});\n\nconst brokerSchema = new mongoose.Schema({\n  id: { type: Number, required: true, unique: true },\n  userId: { type: Number, required: true },\n  adminId: { type: Number, required: true },\n  commissionRate: { type: String, default: \"10%\" },\n  commissionAmount: { type: Number },\n  status: { type: String, default: \"Active\" },\n  activeStudents: { type: Number, default: 0 },\n  phone: { type: String },\n  address: { type: String },\n  companyName: { type: String },\n  licenseNumber: { type: String },\n});\n\nconst studentSchema = new mongoose.Schema({\n  id: { type: Number, required: true, unique: true },\n  userId: { type: Number, required: true },\n  adminId: { type: Number, required: true },\n  brokerId: { type: Number, default: null },\n  passportNumber: { type: String },\n  dateOfBirth: { type: String },\n  currentAddress: { type: String },\n  phone: { type: String },\n  nationality: { type: String },\n  education: { type: String },\n});\n\nconst applicationSchema = new mongoose.Schema({\n  id: { type: Number, required: true, unique: true },\n  studentId: { type: Number, required: true },\n  visaType: { type: String, required: true },\n  targetCountry: { type: String, required: true },\n  purpose: { type: String },\n  status: { type: String, enum: [\"Document Review\", \"Submitted\", \"Interview\", \"Approved\", \"Rejected\"], default: \"Document Review\" },\n  progress: { type: Number, default: 0 },\n  submittedAt: { type: Date, default: Date.now },\n  lastAction: { type: String },\n});\n\nconst commissionSchema = new mongoose.Schema({\n  id: { type: Number, required: true, unique: true },\n  brokerId: { type: Number, required: true },\n  studentId: { type: Number, required: true },\n  amount: { type: String, required: true },\n  status: { type: String, enum: [\"Pending\", \"Approved\", \"Paid\", \"Rejected\"], default: \"Pending\" },\n  date: { type: Date, default: Date.now },\n});\n\nconst documentSchema = new mongoose.Schema({\n  id: { type: Number, required: true, unique: true },\n  ownerType: { type: String, enum: [\"admin\", \"broker\", \"student\"], required: true },\n  ownerId: { type: Number, required: true },\n  uploadedById: { type: Number, required: true },\n  name: { type: String, required: true },\n  type: { type: String, required: true },\n  path: { type: String, required: true },\n  status: { type: String, enum: [\"Pending\", \"Approved\", \"Rejected\"], default: \"Pending\" },\n  notes: { type: String },\n  uploadedAt: { type: Date, default: Date.now },\n});\n\nconst activitySchema = new mongoose.Schema({\n  id: { type: Number, required: true, unique: true },\n  actorId: { type: Number, required: true },\n  actorRole: { type: String, enum: [\"admin\", \"broker\", \"student\"], required: true },\n  targetType: { type: String, required: true },\n  targetId: { type: Number, required: true },\n  activityType: { type: String, enum: [\"application_submitted\", \"application_updated\", \"broker_assigned\", \"document_uploaded\", \"document_reviewed\", \"commission_created\", \"profile_updated\", \"status_changed\"], required: true },\n  description: { type: String, required: true },\n  metadata: { type: mongoose.Schema.Types.Mixed },\n  createdAt: { type: Date, default: Date.now },\n});\n\nexport const UserModel = mongoose.models.User || mongoose.model(\"User\", userSchema);\nexport const BrokerModel = mongoose.models.Broker || mongoose.model(\"Broker\", brokerSchema);\nexport const StudentModel = mongoose.models.Student || mongoose.model(\"Student\", studentSchema);\nexport const ApplicationModel = mongoose.models.Application || mongoose.model(\"Application\", applicationSchema);\nexport const CommissionModel = mongoose.models.Commission || mongoose.model(\"Commission\", commissionSchema);\nexport const DocumentModel = mongoose.models.Document || mongoose.model(\"Document\", documentSchema);\nexport const ActivityModel = mongoose.models.Activity || mongoose.model(\"Activity\", activitySchema);\nexport const CounterModel = Counter;\n","path":null,"size_bytes":5272,"size_tokens":null},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","path":null,"size_bytes":6210,"size_tokens":null},"client/src/pages/broker/applications.tsx":{"content":"import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { DashboardLayout } from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Eye, CheckCircle, XCircle, Clock } from \"lucide-react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { brokerApi } from \"@/lib/api\";\n\nexport default function BrokerApplications() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const { data: applications = [], isLoading } = useQuery({\n    queryKey: [\"broker\", \"applications\"],\n    queryFn: brokerApi.getApplications,\n  });\n\n  const statusMutation = useMutation({\n    mutationFn: ({ applicationId, status }: { applicationId: number; status: string }) =>\n      brokerApi.updateApplicationStatus(applicationId, status),\n    onSuccess: (_, variables) => {\n      queryClient.invalidateQueries({ queryKey: [\"broker\", \"applications\"] });\n      toast({ \n        title: \"Application Updated\", \n        description: `Application status changed to ${variables.status}.` \n      });\n    },\n    onError: (error: any) => {\n      toast({ \n        title: \"Error\", \n        description: error.message || \"Failed to update application\",\n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const handleStatusChange = (appId: number, status: string) => {\n    statusMutation.mutate({ applicationId: appId, status });\n  };\n\n  const getStatusBadge = (status: string) => {\n    switch (status) {\n      case 'Approved':\n        return 'bg-green-500/10 text-green-500 border-green-500/20';\n      case 'Submitted':\n        return 'bg-blue-500/10 text-blue-500 border-blue-500/20';\n      case 'Interview':\n        return 'bg-purple-500/10 text-purple-500 border-purple-500/20';\n      case 'Document Review':\n        return 'bg-yellow-500/10 text-yellow-500 border-yellow-500/20';\n      case 'Rejected':\n        return 'bg-red-500/10 text-red-500 border-red-500/20';\n      default:\n        return 'bg-gray-500/10 text-gray-500 border-gray-500/20';\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <DashboardLayout role=\"broker\">\n        <div className=\"flex items-center justify-center h-64\">\n          <p className=\"text-muted-foreground\">Loading applications...</p>\n        </div>\n      </DashboardLayout>\n    );\n  }\n\n  return (\n    <DashboardLayout role=\"broker\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-3xl font-display font-bold text-white\">Application Management</h1>\n          <p className=\"text-muted-foreground\">Review and update student visa applications.</p>\n        </div>\n      </div>\n\n      <Card className=\"glass-panel border-white/5\">\n        <CardHeader>\n          <CardTitle>All Applications ({applications.length})</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <Table>\n            <TableHeader>\n              <TableRow className=\"border-white/10 hover:bg-white/5\">\n                <TableHead>Student Name</TableHead>\n                <TableHead>Visa Type</TableHead>\n                <TableHead>Country</TableHead>\n                <TableHead>Progress</TableHead>\n                <TableHead>Status</TableHead>\n                <TableHead>Submitted</TableHead>\n                <TableHead className=\"text-right\">Actions</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {applications.length === 0 ? (\n                <TableRow>\n                  <TableCell colSpan={7} className=\"text-center text-muted-foreground py-8\">\n                    No applications found. Add students to start processing applications.\n                  </TableCell>\n                </TableRow>\n              ) : (\n                applications.map((app: any) => (\n                  <TableRow key={app.id} className=\"border-white/10 hover:bg-white/5\">\n                    <TableCell className=\"font-medium\">{app.student?.user?.name || \"N/A\"}</TableCell>\n                    <TableCell>{app.visaType}</TableCell>\n                    <TableCell>{app.targetCountry}</TableCell>\n                    <TableCell>\n                      <div className=\"flex items-center gap-2\">\n                        <div className=\"w-20 bg-white/10 h-2 rounded-full overflow-hidden\">\n                          <div \n                            className=\"h-full bg-primary transition-all\" \n                            style={{ width: `${app.progress}%` }}\n                          />\n                        </div>\n                        <span className=\"text-xs text-muted-foreground\">{app.progress}%</span>\n                      </div>\n                    </TableCell>\n                    <TableCell>\n                      <Badge variant=\"outline\" className={getStatusBadge(app.status)}>\n                        {app.status}\n                      </Badge>\n                    </TableCell>\n                    <TableCell>{new Date(app.submittedAt).toLocaleDateString()}</TableCell>\n                    <TableCell className=\"text-right\">\n                      <Dialog>\n                        <DialogTrigger asChild>\n                          <Button size=\"sm\" variant=\"outline\" className=\"border-white/10 hover:bg-white/5\">\n                            <Eye className=\"w-4 h-4 mr-2\" /> Review\n                          </Button>\n                        </DialogTrigger>\n                        <DialogContent className=\"bg-card border-white/10\">\n                          <DialogHeader>\n                            <DialogTitle>Review Application</DialogTitle>\n                            <DialogDescription>Update the status of {app.student?.user?.name}'s application.</DialogDescription>\n                          </DialogHeader>\n                          <div className=\"space-y-4 py-4\">\n                            <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                              <div>\n                                <p className=\"text-muted-foreground\">Visa Type</p>\n                                <p className=\"font-medium\">{app.visaType}</p>\n                              </div>\n                              <div>\n                                <p className=\"text-muted-foreground\">Target Country</p>\n                                <p className=\"font-medium\">{app.targetCountry}</p>\n                              </div>\n                              <div>\n                                <p className=\"text-muted-foreground\">Current Status</p>\n                                <Badge variant=\"outline\" className={getStatusBadge(app.status)}>\n                                  {app.status}\n                                </Badge>\n                              </div>\n                              <div>\n                                <p className=\"text-muted-foreground\">Progress</p>\n                                <p className=\"font-medium\">{app.progress}%</p>\n                              </div>\n                            </div>\n                            <div className=\"p-4 rounded-lg bg-white/5 border border-white/10\">\n                              <p className=\"mb-3 font-medium text-white\">Update Status:</p>\n                              <div className=\"flex flex-wrap gap-2\">\n                                <Button \n                                  size=\"sm\" \n                                  variant=\"ghost\" \n                                  className=\"text-yellow-400 hover:bg-yellow-500/10\"\n                                  onClick={() => handleStatusChange(app.id, 'Document Review')}\n                                >\n                                  <Clock className=\"w-4 h-4 mr-2\" /> Document Review\n                                </Button>\n                                <Button \n                                  size=\"sm\" \n                                  variant=\"ghost\" \n                                  className=\"text-blue-400 hover:bg-blue-500/10\"\n                                  onClick={() => handleStatusChange(app.id, 'Submitted')}\n                                >\n                                  Submitted\n                                </Button>\n                                <Button \n                                  size=\"sm\" \n                                  variant=\"ghost\" \n                                  className=\"text-purple-400 hover:bg-purple-500/10\"\n                                  onClick={() => handleStatusChange(app.id, 'Interview')}\n                                >\n                                  Interview\n                                </Button>\n                                <Button \n                                  size=\"sm\" \n                                  variant=\"ghost\" \n                                  className=\"text-green-400 hover:bg-green-500/10\"\n                                  onClick={() => handleStatusChange(app.id, 'Approved')}\n                                >\n                                  <CheckCircle className=\"w-4 h-4 mr-2\" /> Approve\n                                </Button>\n                                <Button \n                                  size=\"sm\" \n                                  variant=\"ghost\" \n                                  className=\"text-red-400 hover:bg-red-500/10\"\n                                  onClick={() => handleStatusChange(app.id, 'Rejected')}\n                                >\n                                  <XCircle className=\"w-4 h-4 mr-2\" /> Reject\n                                </Button>\n                              </div>\n                            </div>\n                          </div>\n                        </DialogContent>\n                      </Dialog>\n                    </TableCell>\n                  </TableRow>\n                ))\n              )}\n            </TableBody>\n          </Table>\n        </CardContent>\n      </Card>\n    </DashboardLayout>\n  );\n}\n","path":null,"size_bytes":10230,"size_tokens":null},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","path":null,"size_bytes":1877,"size_tokens":null},"client/src/lib/auth-context.tsx":{"content":"import React, { createContext, useContext, useState, useEffect, ReactNode } from \"react\";\nimport { useLocation } from \"wouter\";\n\ntype UserRole = \"admin\" | \"broker\" | \"student\" | null;\n\ninterface User {\n  id: number;\n  name: string;\n  email: string;\n  role: UserRole;\n}\n\ninterface AuthContextType {\n  user: User | null;\n  login: (email: string, password: string, role: UserRole) => Promise<void>;\n  signup: (role: UserRole, name: string, email: string, password: string, adminId?: number) => Promise<void>;\n  logout: () => Promise<void>;\n  isAuthenticated: boolean;\n  isLoading: boolean;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<User | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [, setLocation] = useLocation();\n\n  useEffect(() => {\n    checkAuth();\n  }, []);\n\n  const checkAuth = async () => {\n    try {\n      const response = await fetch(\"/api/auth/me\", {\n        credentials: \"include\",\n      });\n      \n      if (response.ok) {\n        const data = await response.json();\n        setUser(data.user);\n      }\n    } catch (error) {\n      console.error(\"Auth check failed:\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const login = async (email: string, password: string, role: UserRole) => {\n    const response = await fetch(\"/api/auth/login\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      credentials: \"include\",\n      body: JSON.stringify({ email, password, role }),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || \"Login failed\");\n    }\n\n    const data = await response.json();\n    setUser(data.user);\n    \n    if (role) {\n      setLocation(`/${role}`);\n    }\n  };\n\n  const signup = async (role: UserRole, name: string, email: string, password: string, adminId?: number) => {\n    const response = await fetch(\"/api/auth/signup\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      credentials: \"include\",\n      body: JSON.stringify({ name, email, password, role, adminId }),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || \"Signup failed\");\n    }\n\n    const data = await response.json();\n    setUser(data.user);\n    \n    if (role) {\n      setLocation(`/${role}`);\n    }\n  };\n\n  const logout = async () => {\n    await fetch(\"/api/auth/logout\", {\n      method: \"POST\",\n      credentials: \"include\",\n    });\n    setUser(null);\n    setLocation(\"/login\");\n  };\n\n  return (\n    <AuthContext.Provider value={{ user, login, signup, logout, isAuthenticated: !!user, isLoading }}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error(\"useAuth must be used within an AuthProvider\");\n  }\n  return context;\n}\n","path":null,"size_bytes":3049,"size_tokens":null},"client/src/pages/admin/settings.tsx":{"content":"import { DashboardLayout } from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Save } from \"lucide-react\";\n\nexport default function AdminSettings() {\n  return (\n    <DashboardLayout role=\"admin\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-3xl font-display font-bold text-white\">System Settings</h1>\n          <p className=\"text-muted-foreground\">Configure platform preferences and notifications.</p>\n        </div>\n        <Button className=\"bg-primary text-primary-foreground\">\n          <Save className=\"w-4 h-4 mr-2\" /> Save Changes\n        </Button>\n      </div>\n\n      <div className=\"space-y-6\">\n        <Card className=\"glass-panel border-white/5\">\n          <CardHeader>\n            <CardTitle>General Configuration</CardTitle>\n            <CardDescription>Basic settings for the VisaFlow platform.</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label>Platform Name</Label>\n              <Input defaultValue=\"VisaFlow\" className=\"bg-white/5 border-white/10\" />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Support Email</Label>\n              <Input defaultValue=\"support@visaflow.com\" className=\"bg-white/5 border-white/10\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"glass-panel border-white/5\">\n          <CardHeader>\n            <CardTitle>Notifications</CardTitle>\n            <CardDescription>Manage system-wide alerts and emails.</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"space-y-0.5\">\n                <Label>New Application Alerts</Label>\n                <p className=\"text-sm text-muted-foreground\">Notify admins when a new student applies</p>\n              </div>\n              <Switch defaultChecked />\n            </div>\n            <div className=\"flex items-center justify-between\">\n              <div className=\"space-y-0.5\">\n                <Label>Commission Reports</Label>\n                <p className=\"text-sm text-muted-foreground\">Weekly email summary of commissions</p>\n              </div>\n              <Switch defaultChecked />\n            </div>\n            <div className=\"flex items-center justify-between\">\n              <div className=\"space-y-0.5\">\n                <Label>System Maintenance</Label>\n                <p className=\"text-sm text-muted-foreground\">Show maintenance banner to users</p>\n              </div>\n              <Switch />\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </DashboardLayout>\n  );\n}\n","path":null,"size_bytes":3050,"size_tokens":null},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Portal>\n    <TooltipPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </TooltipPrimitive.Portal>\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","path":null,"size_bytes":1267,"size_tokens":null},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n      {children}\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","path":null,"size_bytes":4280,"size_tokens":null},"client/src/pages/broker/earnings.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { DashboardLayout } from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { brokerApi } from \"@/lib/api\";\nimport { parseAmount, formatAmount } from \"@/lib/utils\";\n\nexport default function BrokerEarnings() {\n  const { data: commissions = [], isLoading } = useQuery({\n    queryKey: [\"broker\", \"commissions\"],\n    queryFn: brokerApi.getCommissions,\n  });\n\n  const totalPending = commissions\n    .filter((c: any) => c.status === 'Pending')\n    .reduce((acc: number, curr: any) => acc + parseAmount(curr.amount), 0);\n\n  const totalApproved = commissions\n    .filter((c: any) => c.status === 'Approved')\n    .reduce((acc: number, curr: any) => acc + parseAmount(curr.amount), 0);\n\n  const totalPaid = commissions\n    .filter((c: any) => c.status === 'Paid')\n    .reduce((acc: number, curr: any) => acc + parseAmount(curr.amount), 0);\n\n  if (isLoading) {\n    return (\n      <DashboardLayout role=\"broker\">\n        <div className=\"flex items-center justify-center h-64\">\n          <p className=\"text-muted-foreground\">Loading earnings...</p>\n        </div>\n      </DashboardLayout>\n    );\n  }\n\n  return (\n    <DashboardLayout role=\"broker\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-3xl font-display font-bold text-white\">Earnings & Commissions</h1>\n          <p className=\"text-muted-foreground\">Track your financial performance.</p>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\n        <Card className=\"glass-card border-white/5\">\n          <CardContent className=\"p-6\">\n             <p className=\"text-sm text-muted-foreground\">Available (Approved)</p>\n             <h3 className=\"text-4xl font-bold font-mono text-blue-400 mt-2\">${totalApproved.toFixed(2)}</h3>\n          </CardContent>\n        </Card>\n        <Card className=\"glass-card border-white/5\">\n          <CardContent className=\"p-6\">\n             <p className=\"text-sm text-muted-foreground\">Total Paid</p>\n             <h3 className=\"text-4xl font-bold font-mono text-green-400 mt-2\">${totalPaid.toFixed(2)}</h3>\n          </CardContent>\n        </Card>\n        <Card className=\"glass-card border-white/5\">\n          <CardContent className=\"p-6\">\n             <p className=\"text-sm text-muted-foreground\">Pending Approval</p>\n             <h3 className=\"text-4xl font-bold font-mono text-yellow-400 mt-2\">${totalPending.toFixed(2)}</h3>\n          </CardContent>\n        </Card>\n      </div>\n\n      <Card className=\"glass-panel border-white/5\">\n        <CardHeader>\n          <CardTitle>Commission History</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <Table>\n            <TableHeader>\n              <TableRow className=\"border-white/10 hover:bg-white/5\">\n                <TableHead>Student</TableHead>\n                <TableHead>Amount</TableHead>\n                <TableHead>Status</TableHead>\n                <TableHead>Date</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {commissions.length === 0 ? (\n                <TableRow>\n                  <TableCell colSpan={4} className=\"text-center text-muted-foreground py-8\">\n                    No commissions yet. Complete student applications to earn commissions.\n                  </TableCell>\n                </TableRow>\n              ) : (\n                commissions.map((commission: any) => (\n                  <TableRow key={commission.id} className=\"border-white/10 hover:bg-white/5\">\n                    <TableCell className=\"font-medium\">{commission.student?.user?.name || \"N/A\"}</TableCell>\n                    <TableCell className=\"font-mono\">{formatAmount(commission.amount)}</TableCell>\n                    <TableCell>\n                      <Badge variant=\"outline\" className={`\n                        ${commission.status === 'Paid' ? 'bg-green-500/10 text-green-500 border-green-500/20' : ''}\n                        ${commission.status === 'Approved' ? 'bg-blue-500/10 text-blue-500 border-blue-500/20' : ''}\n                        ${commission.status === 'Pending' ? 'bg-yellow-500/10 text-yellow-500 border-yellow-500/20' : ''}\n                        ${commission.status === 'Rejected' ? 'bg-red-500/10 text-red-500 border-red-500/20' : ''}\n                      `}>\n                        {commission.status}\n                      </Badge>\n                    </TableCell>\n                    <TableCell>{new Date(commission.date).toLocaleDateString()}</TableCell>\n                  </TableRow>\n                ))\n              )}\n            </TableBody>\n          </Table>\n        </CardContent>\n      </Card>\n    </DashboardLayout>\n  );\n}\n","path":null,"size_bytes":4945,"size_tokens":null},"client/src/pages/auth/login.tsx":{"content":"import { useState } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { motion } from \"framer-motion\";\nimport { Shield, Briefcase, GraduationCap, Lock, Mail, ArrowRight, CheckCircle2 } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription, CardFooter } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { useAuth } from \"@/lib/auth-context\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nexport default function LoginPage() {\n  const { login } = useAuth();\n  const { toast } = useToast();\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n\n  const handleLogin = async (role: \"admin\" | \"broker\" | \"student\") => {\n    if (!email || !password) {\n      toast({\n        title: \"Missing information\",\n        description: \"Please enter both email and password.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsLoading(true);\n    \n    try {\n      await login(email, password, role);\n      toast({\n        title: \"Welcome back!\",\n        description: `Successfully logged in as ${role}.`,\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Login failed\",\n        description: error.message || \"Invalid credentials. Please try again.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center relative overflow-hidden p-4 bg-background\">\n      {/* Background Elements */}\n      <div className=\"absolute top-0 left-0 w-full h-full bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 -z-10\"></div>\n      <div className=\"absolute top-1/4 left-1/4 w-96 h-96 bg-primary/10 rounded-full blur-[100px] -z-10\" />\n      <div className=\"absolute bottom-1/4 right-1/4 w-96 h-96 bg-secondary/10 rounded-full blur-[100px] -z-10\" />\n\n      <motion.div\n        initial={{ opacity: 0, scale: 0.95 }}\n        animate={{ opacity: 1, scale: 1 }}\n        transition={{ duration: 0.5 }}\n        className=\"w-full max-w-md\"\n      >\n        <Card className=\"glass-panel border-white/10\">\n          <CardHeader className=\"text-center space-y-2\">\n            <CardTitle className=\"text-3xl font-display font-bold text-gradient\">Welcome Back</CardTitle>\n            <CardDescription>Sign in to access your dashboard</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Tabs defaultValue=\"student\" className=\"w-full\">\n              <TabsList className=\"grid w-full grid-cols-3 mb-8 bg-white/5\">\n                <TabsTrigger value=\"admin\">Admin</TabsTrigger>\n                <TabsTrigger value=\"broker\">Broker</TabsTrigger>\n                <TabsTrigger value=\"student\">Student</TabsTrigger>\n              </TabsList>\n\n              {[\"admin\", \"broker\", \"student\"].map((role) => (\n                <TabsContent key={role} value={role} className=\"space-y-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor={`${role}-email`}>Email</Label>\n                    <div className=\"relative\">\n                      <Mail className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                      <Input \n                        id={`${role}-email`} \n                        placeholder={`name@example.com`} \n                        className=\"pl-10 bg-white/5 border-white/10\"\n                        value={email}\n                        onChange={(e) => setEmail(e.target.value)}\n                      />\n                    </div>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor={`${role}-password`}>Password</Label>\n                    <div className=\"relative\">\n                      <Lock className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                      <Input \n                        id={`${role}-password`} \n                        type=\"password\" \n                        className=\"pl-10 bg-white/5 border-white/10\"\n                        value={password}\n                        onChange={(e) => setPassword(e.target.value)}\n                      />\n                    </div>\n                  </div>\n\n                  <Button \n                    className=\"w-full mt-4 bg-gradient-to-r from-primary to-secondary hover:opacity-90 transition-opacity\" \n                    onClick={() => handleLogin(role as any)}\n                    disabled={isLoading}\n                  >\n                    {isLoading ? \"Signing in...\" : \"Sign In\"} <ArrowRight className=\"w-4 h-4 ml-2\" />\n                  </Button>\n                  \n                  <div className=\"text-center text-sm text-muted-foreground mt-4\">\n                    <p>Don't have an account? <Link href=\"/signup\" className=\"text-primary hover:underline\">Sign up</Link></p>\n                  </div>\n                </TabsContent>\n              ))}\n            </Tabs>\n          </CardContent>\n        </Card>\n      </motion.div>\n    </div>\n  );\n}\n","path":null,"size_bytes":5263,"size_tokens":null},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"px-2 py-1.5 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute right-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","path":null,"size_bytes":5745,"size_tokens":null},"server/storage.ts":{"content":"import {\n  connectToDatabase,\n  getNextSequence,\n  UserModel,\n  BrokerModel,\n  StudentModel,\n  ApplicationModel,\n  CommissionModel,\n  DocumentModel,\n  ActivityModel,\n  CounterModel,\n} from \"./db\";\nimport {\n  type User,\n  type InsertUser,\n  type Broker,\n  type InsertBroker,\n  type Student,\n  type InsertStudent,\n  type Application,\n  type InsertApplication,\n  type Commission,\n  type InsertCommission,\n  type Document,\n  type InsertDocument,\n  type Activity,\n  type InsertActivity,\n} from \"@shared/schema\";\n\nfunction toUser(doc: any): User | undefined {\n  if (!doc) return undefined;\n  return {\n    id: doc.id,\n    name: doc.name,\n    email: doc.email,\n    password: doc.password,\n    role: doc.role,\n    createdAt: doc.createdAt,\n  };\n}\n\nfunction toBroker(doc: any): Broker | undefined {\n  if (!doc) return undefined;\n  return {\n    id: doc.id,\n    userId: doc.userId,\n    adminId: doc.adminId,\n    commissionRate: doc.commissionRate,\n    commissionAmount: doc.commissionAmount || null,\n    status: doc.status,\n    activeStudents: doc.activeStudents,\n    phone: doc.phone || null,\n    address: doc.address || null,\n    companyName: doc.companyName || null,\n    licenseNumber: doc.licenseNumber || null,\n  };\n}\n\nfunction toStudent(doc: any): Student | undefined {\n  if (!doc) return undefined;\n  return {\n    id: doc.id,\n    userId: doc.userId,\n    adminId: doc.adminId,\n    brokerId: doc.brokerId || null,\n    passportNumber: doc.passportNumber || null,\n    dateOfBirth: doc.dateOfBirth || null,\n    currentAddress: doc.currentAddress || null,\n    phone: doc.phone || null,\n    nationality: doc.nationality || null,\n    education: doc.education || null,\n  };\n}\n\nfunction toApplication(doc: any): Application | undefined {\n  if (!doc) return undefined;\n  return {\n    id: doc.id,\n    studentId: doc.studentId,\n    visaType: doc.visaType,\n    targetCountry: doc.targetCountry,\n    purpose: doc.purpose || null,\n    status: doc.status,\n    progress: doc.progress,\n    submittedAt: doc.submittedAt,\n    lastAction: doc.lastAction || null,\n  };\n}\n\nfunction toCommission(doc: any): Commission | undefined {\n  if (!doc) return undefined;\n  return {\n    id: doc.id,\n    brokerId: doc.brokerId,\n    studentId: doc.studentId,\n    amount: doc.amount,\n    status: doc.status,\n    date: doc.date,\n  };\n}\n\nfunction toDocument(doc: any): Document | undefined {\n  if (!doc) return undefined;\n  return {\n    id: doc.id,\n    ownerType: doc.ownerType,\n    ownerId: doc.ownerId,\n    uploadedById: doc.uploadedById,\n    name: doc.name,\n    type: doc.type,\n    path: doc.path,\n    status: doc.status,\n    notes: doc.notes || null,\n    uploadedAt: doc.uploadedAt,\n  };\n}\n\nfunction toActivity(doc: any): Activity | undefined {\n  if (!doc) return undefined;\n  return {\n    id: doc.id,\n    actorId: doc.actorId,\n    actorRole: doc.actorRole,\n    targetType: doc.targetType,\n    targetId: doc.targetId,\n    activityType: doc.activityType,\n    description: doc.description,\n    metadata: doc.metadata || null,\n    createdAt: doc.createdAt,\n  };\n}\n\nexport interface IStorage {\n  getUserByEmail(email: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n  getUserById(id: number): Promise<User | undefined>;\n  updateUserName(userId: number, name: string): Promise<void>;\n  updateUserPassword(userId: number, hashedPassword: string): Promise<void>;\n  getAllAdmins(): Promise<Array<{ id: number; name: string; email: string }>>;\n  clearAllData(): Promise<void>;\n\n  createBroker(broker: InsertBroker): Promise<Broker>;\n  getBrokerByUserId(userId: number): Promise<Broker | undefined>;\n  getAllBrokers(): Promise<Array<Broker & { user: User }>>;\n  getBrokersByAdminId(adminId: number): Promise<Array<Broker & { user: User }>>;\n  updateBrokerStatus(brokerId: number, status: string): Promise<void>;\n  getBrokerById(id: number): Promise<Broker | undefined>;\n  updateBrokerProfile(brokerId: number, data: Partial<Broker>): Promise<Broker>;\n  updateBrokerCommissionRate(brokerId: number, rate: string): Promise<void>;\n  updateBrokerCommission(brokerId: number, rate: string, amount: number | null): Promise<void>;\n\n  createStudent(student: InsertStudent): Promise<Student>;\n  getStudentByUserId(userId: number): Promise<Student | undefined>;\n  getStudentsByBrokerId(brokerId: number): Promise<Array<Student & { user: User }>>;\n  getStudentsByAdminId(adminId: number): Promise<Array<Student & { user: User; broker?: Broker & { user: User } }>>;\n  getAllStudents(): Promise<Array<Student & { user: User; broker?: Broker & { user: User } }>>;\n  assignBrokerToStudent(studentId: number, brokerId: number): Promise<void>;\n  updateStudentProfile(studentId: number, data: Partial<Student>): Promise<Student>;\n  getStudentById(id: number): Promise<Student | undefined>;\n\n  createApplication(application: InsertApplication): Promise<Application>;\n  getApplicationsByStudentId(studentId: number): Promise<Application[]>;\n  getApplicationsByBrokerId(brokerId: number): Promise<Array<Application & { student: Student & { user: User } }>>;\n  getApplicationsByAdminId(adminId: number): Promise<Array<Application & { student: Student & { user: User } }>>;\n  getAllApplications(): Promise<Array<Application & { student: Student & { user: User } }>>;\n  updateApplicationStatus(id: number, status: string): Promise<void>;\n  updateApplicationProgress(id: number, progress: number, lastAction: string): Promise<void>;\n  getApplicationById(id: number): Promise<Application | undefined>;\n\n  createCommission(commission: InsertCommission): Promise<Commission>;\n  getCommissionsByBrokerId(brokerId: number): Promise<Array<Commission & { student: Student & { user: User } }>>;\n  getCommissionsByAdminId(adminId: number): Promise<Array<Commission & { broker: Broker & { user: User }; student: Student & { user: User } }>>;\n  getCommissionById(id: number): Promise<Commission | undefined>;\n  getAllCommissions(): Promise<Array<Commission & { broker: Broker & { user: User }; student: Student & { user: User } }>>;\n  updateCommissionStatus(id: number, status: string): Promise<void>;\n\n  createDocument(document: InsertDocument): Promise<Document>;\n  getDocumentsByOwner(ownerType: string, ownerId: number): Promise<Array<Document & { uploadedBy: User }>>;\n  getDocumentsByBrokerStudents(brokerId: number): Promise<Array<Document & { uploadedBy: User }>>;\n  getDocumentsByAdminId(adminId: number): Promise<Array<Document & { uploadedBy: User }>>;\n  getAllDocuments(): Promise<Array<Document & { uploadedBy: User }>>;\n  updateDocumentStatus(id: number, status: string, notes?: string): Promise<void>;\n  getDocumentById(id: number): Promise<Document | undefined>;\n\n  createActivity(activity: InsertActivity): Promise<Activity>;\n  getActivitiesByRole(role: string, userId: number): Promise<Array<Activity & { actor: User }>>;\n  getAllActivities(): Promise<Array<Activity & { actor: User }>>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  private initialized = false;\n\n  private async ensureConnected(): Promise<void> {\n    if (!this.initialized) {\n      await connectToDatabase();\n      this.initialized = true;\n    }\n  }\n\n  async getUserByEmail(email: string): Promise<User | undefined> {\n    await this.ensureConnected();\n    const user = await UserModel.findOne({ email }).lean();\n    return toUser(user);\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    await this.ensureConnected();\n    const id = await getNextSequence(\"users\");\n    const user = await UserModel.create({\n      id,\n      ...insertUser,\n      createdAt: new Date(),\n    });\n    return toUser(user)!;\n  }\n\n  async getUserById(id: number): Promise<User | undefined> {\n    await this.ensureConnected();\n    const user = await UserModel.findOne({ id }).lean();\n    return toUser(user);\n  }\n\n  async updateUserName(userId: number, name: string): Promise<void> {\n    await this.ensureConnected();\n    await UserModel.updateOne({ id: userId }, { name });\n  }\n\n  async updateUserPassword(userId: number, hashedPassword: string): Promise<void> {\n    await this.ensureConnected();\n    await UserModel.updateOne({ id: userId }, { password: hashedPassword });\n  }\n\n  async getAllAdmins(): Promise<Array<{ id: number; name: string; email: string }>> {\n    await this.ensureConnected();\n    const admins = await UserModel.find({ role: \"admin\" }).lean();\n    return admins.map(admin => ({\n      id: admin.id,\n      name: admin.name,\n      email: admin.email,\n    }));\n  }\n\n  async clearAllData(): Promise<void> {\n    await this.ensureConnected();\n    await UserModel.deleteMany({});\n    await BrokerModel.deleteMany({});\n    await StudentModel.deleteMany({});\n    await ApplicationModel.deleteMany({});\n    await CommissionModel.deleteMany({});\n    await DocumentModel.deleteMany({});\n    await ActivityModel.deleteMany({});\n    await CounterModel.deleteMany({});\n  }\n\n  async createBroker(insertBroker: InsertBroker): Promise<Broker> {\n    await this.ensureConnected();\n    const id = await getNextSequence(\"brokers\");\n    const broker = await BrokerModel.create({\n      id,\n      ...insertBroker,\n      activeStudents: 0,\n    });\n    return toBroker(broker)!;\n  }\n\n  async getBrokerByUserId(userId: number): Promise<Broker | undefined> {\n    await this.ensureConnected();\n    const broker = await BrokerModel.findOne({ userId }).lean();\n    return toBroker(broker);\n  }\n\n  async getAllBrokers(): Promise<Array<Broker & { user: User }>> {\n    await this.ensureConnected();\n    const brokerDocs = await BrokerModel.find().lean();\n    const results: Array<Broker & { user: User }> = [];\n    \n    for (const brokerDoc of brokerDocs) {\n      const userDoc = await UserModel.findOne({ id: brokerDoc.userId }).lean();\n      if (userDoc) {\n        results.push({\n          ...toBroker(brokerDoc)!,\n          user: toUser(userDoc)!,\n        });\n      }\n    }\n    \n    return results;\n  }\n\n  async getBrokersByAdminId(adminId: number): Promise<Array<Broker & { user: User }>> {\n    await this.ensureConnected();\n    const brokerDocs = await BrokerModel.find({ adminId }).lean();\n    const results: Array<Broker & { user: User }> = [];\n    \n    for (const brokerDoc of brokerDocs) {\n      const userDoc = await UserModel.findOne({ id: brokerDoc.userId }).lean();\n      if (userDoc) {\n        results.push({\n          ...toBroker(brokerDoc)!,\n          user: toUser(userDoc)!,\n        });\n      }\n    }\n    \n    return results;\n  }\n\n  async updateBrokerStatus(brokerId: number, status: string): Promise<void> {\n    await this.ensureConnected();\n    await BrokerModel.updateOne({ id: brokerId }, { status });\n  }\n\n  async getBrokerById(id: number): Promise<Broker | undefined> {\n    await this.ensureConnected();\n    const broker = await BrokerModel.findOne({ id }).lean();\n    return toBroker(broker);\n  }\n\n  async updateBrokerProfile(brokerId: number, data: Partial<Broker>): Promise<Broker> {\n    await this.ensureConnected();\n    const broker = await BrokerModel.findOneAndUpdate(\n      { id: brokerId },\n      { $set: data },\n      { new: true }\n    ).lean();\n    return toBroker(broker)!;\n  }\n\n  async updateBrokerCommissionRate(brokerId: number, rate: string): Promise<void> {\n    await this.ensureConnected();\n    await BrokerModel.updateOne({ id: brokerId }, { commissionRate: rate });\n  }\n\n  async updateBrokerCommission(brokerId: number, rate: string, amount: number | null): Promise<void> {\n    await this.ensureConnected();\n    await BrokerModel.updateOne({ id: brokerId }, { commissionRate: rate, commissionAmount: amount });\n  }\n\n  async createStudent(insertStudent: InsertStudent): Promise<Student> {\n    await this.ensureConnected();\n    const id = await getNextSequence(\"students\");\n    const student = await StudentModel.create({\n      id,\n      ...insertStudent,\n    });\n    return toStudent(student)!;\n  }\n\n  async getStudentByUserId(userId: number): Promise<Student | undefined> {\n    await this.ensureConnected();\n    const student = await StudentModel.findOne({ userId }).lean();\n    return toStudent(student);\n  }\n\n  async getStudentsByBrokerId(brokerId: number): Promise<Array<Student & { user: User }>> {\n    await this.ensureConnected();\n    const studentDocs = await StudentModel.find({ brokerId }).lean();\n    const results: Array<Student & { user: User }> = [];\n    \n    for (const studentDoc of studentDocs) {\n      const userDoc = await UserModel.findOne({ id: studentDoc.userId }).lean();\n      if (userDoc) {\n        results.push({\n          ...toStudent(studentDoc)!,\n          user: toUser(userDoc)!,\n        });\n      }\n    }\n    \n    return results;\n  }\n\n  async getStudentsByAdminId(adminId: number): Promise<Array<Student & { user: User; broker?: Broker & { user: User } }>> {\n    await this.ensureConnected();\n    const studentDocs = await StudentModel.find({ adminId }).lean();\n    const results: Array<Student & { user: User; broker?: Broker & { user: User } }> = [];\n    \n    for (const studentDoc of studentDocs) {\n      const userDoc = await UserModel.findOne({ id: studentDoc.userId }).lean();\n      if (userDoc) {\n        let brokerWithUser: (Broker & { user: User }) | undefined;\n        \n        if (studentDoc.brokerId) {\n          const brokerDoc = await BrokerModel.findOne({ id: studentDoc.brokerId }).lean();\n          if (brokerDoc) {\n            const brokerUserDoc = await UserModel.findOne({ id: brokerDoc.userId }).lean();\n            if (brokerUserDoc) {\n              brokerWithUser = {\n                ...toBroker(brokerDoc)!,\n                user: toUser(brokerUserDoc)!,\n              };\n            }\n          }\n        }\n        \n        results.push({\n          ...toStudent(studentDoc)!,\n          user: toUser(userDoc)!,\n          broker: brokerWithUser,\n        });\n      }\n    }\n    \n    return results;\n  }\n\n  async getAllStudents(): Promise<Array<Student & { user: User; broker?: Broker & { user: User } }>> {\n    await this.ensureConnected();\n    const studentDocs = await StudentModel.find().lean();\n    const results: Array<Student & { user: User; broker?: Broker & { user: User } }> = [];\n    \n    for (const studentDoc of studentDocs) {\n      const userDoc = await UserModel.findOne({ id: studentDoc.userId }).lean();\n      if (userDoc) {\n        let brokerWithUser: (Broker & { user: User }) | undefined;\n        \n        if (studentDoc.brokerId) {\n          const brokerDoc = await BrokerModel.findOne({ id: studentDoc.brokerId }).lean();\n          if (brokerDoc) {\n            const brokerUserDoc = await UserModel.findOne({ id: brokerDoc.userId }).lean();\n            if (brokerUserDoc) {\n              brokerWithUser = {\n                ...toBroker(brokerDoc)!,\n                user: toUser(brokerUserDoc)!,\n              };\n            }\n          }\n        }\n        \n        results.push({\n          ...toStudent(studentDoc)!,\n          user: toUser(userDoc)!,\n          broker: brokerWithUser,\n        });\n      }\n    }\n    \n    return results;\n  }\n\n  async assignBrokerToStudent(studentId: number, brokerId: number): Promise<void> {\n    await this.ensureConnected();\n    await StudentModel.updateOne({ id: studentId }, { brokerId });\n  }\n\n  async updateStudentProfile(studentId: number, data: Partial<Student>): Promise<Student> {\n    await this.ensureConnected();\n    const student = await StudentModel.findOneAndUpdate(\n      { id: studentId },\n      { $set: data },\n      { new: true }\n    ).lean();\n    return toStudent(student)!;\n  }\n\n  async getStudentById(id: number): Promise<Student | undefined> {\n    await this.ensureConnected();\n    const student = await StudentModel.findOne({ id }).lean();\n    return toStudent(student);\n  }\n\n  async createApplication(insertApplication: InsertApplication): Promise<Application> {\n    await this.ensureConnected();\n    const id = await getNextSequence(\"applications\");\n    const application = await ApplicationModel.create({\n      id,\n      ...insertApplication,\n      submittedAt: new Date(),\n    });\n    return toApplication(application)!;\n  }\n\n  async getApplicationsByStudentId(studentId: number): Promise<Application[]> {\n    await this.ensureConnected();\n    const applications = await ApplicationModel.find({ studentId }).lean();\n    return applications.map(app => toApplication(app)!);\n  }\n\n  async getApplicationsByBrokerId(brokerId: number): Promise<Array<Application & { student: Student & { user: User } }>> {\n    await this.ensureConnected();\n    const studentDocs = await StudentModel.find({ brokerId }).lean();\n    const studentIds = studentDocs.map(s => s.id);\n    \n    if (studentIds.length === 0) {\n      return [];\n    }\n    \n    const applicationDocs = await ApplicationModel.find({ studentId: { $in: studentIds } })\n      .sort({ submittedAt: -1 })\n      .lean();\n    \n    const results: Array<Application & { student: Student & { user: User } }> = [];\n    \n    for (const appDoc of applicationDocs) {\n      const studentDoc = studentDocs.find(s => s.id === appDoc.studentId);\n      if (studentDoc) {\n        const userDoc = await UserModel.findOne({ id: studentDoc.userId }).lean();\n        if (userDoc) {\n          results.push({\n            ...toApplication(appDoc)!,\n            student: {\n              ...toStudent(studentDoc)!,\n              user: toUser(userDoc)!,\n            },\n          });\n        }\n      }\n    }\n    \n    return results;\n  }\n\n  async getApplicationsByAdminId(adminId: number): Promise<Array<Application & { student: Student & { user: User } }>> {\n    await this.ensureConnected();\n    const studentDocs = await StudentModel.find({ adminId }).lean();\n    const studentIds = studentDocs.map(s => s.id);\n    \n    if (studentIds.length === 0) {\n      return [];\n    }\n    \n    const applicationDocs = await ApplicationModel.find({ studentId: { $in: studentIds } })\n      .sort({ submittedAt: -1 })\n      .lean();\n    \n    const results: Array<Application & { student: Student & { user: User } }> = [];\n    \n    for (const appDoc of applicationDocs) {\n      const studentDoc = studentDocs.find(s => s.id === appDoc.studentId);\n      if (studentDoc) {\n        const userDoc = await UserModel.findOne({ id: studentDoc.userId }).lean();\n        if (userDoc) {\n          results.push({\n            ...toApplication(appDoc)!,\n            student: {\n              ...toStudent(studentDoc)!,\n              user: toUser(userDoc)!,\n            },\n          });\n        }\n      }\n    }\n    \n    return results;\n  }\n\n  async getAllApplications(): Promise<Array<Application & { student: Student & { user: User } }>> {\n    await this.ensureConnected();\n    const applicationDocs = await ApplicationModel.find().sort({ submittedAt: -1 }).lean();\n    const results: Array<Application & { student: Student & { user: User } }> = [];\n    \n    for (const appDoc of applicationDocs) {\n      const studentDoc = await StudentModel.findOne({ id: appDoc.studentId }).lean();\n      if (studentDoc) {\n        const userDoc = await UserModel.findOne({ id: studentDoc.userId }).lean();\n        if (userDoc) {\n          results.push({\n            ...toApplication(appDoc)!,\n            student: {\n              ...toStudent(studentDoc)!,\n              user: toUser(userDoc)!,\n            },\n          });\n        }\n      }\n    }\n    \n    return results;\n  }\n\n  async updateApplicationStatus(id: number, status: string): Promise<void> {\n    await this.ensureConnected();\n    await ApplicationModel.updateOne({ id }, { status });\n  }\n\n  async updateApplicationProgress(id: number, progress: number, lastAction: string): Promise<void> {\n    await this.ensureConnected();\n    await ApplicationModel.updateOne({ id }, { progress, lastAction });\n  }\n\n  async getApplicationById(id: number): Promise<Application | undefined> {\n    await this.ensureConnected();\n    const application = await ApplicationModel.findOne({ id }).lean();\n    return toApplication(application);\n  }\n\n  async createCommission(insertCommission: InsertCommission): Promise<Commission> {\n    await this.ensureConnected();\n    const id = await getNextSequence(\"commissions\");\n    const commission = await CommissionModel.create({\n      id,\n      ...insertCommission,\n      date: new Date(),\n    });\n    return toCommission(commission)!;\n  }\n\n  async getCommissionsByBrokerId(brokerId: number): Promise<Array<Commission & { student: Student & { user: User } }>> {\n    await this.ensureConnected();\n    const commissionDocs = await CommissionModel.find({ brokerId }).sort({ date: -1 }).lean();\n    const results: Array<Commission & { student: Student & { user: User } }> = [];\n    \n    for (const commDoc of commissionDocs) {\n      const studentDoc = await StudentModel.findOne({ id: commDoc.studentId }).lean();\n      if (studentDoc) {\n        const userDoc = await UserModel.findOne({ id: studentDoc.userId }).lean();\n        if (userDoc) {\n          results.push({\n            ...toCommission(commDoc)!,\n            student: {\n              ...toStudent(studentDoc)!,\n              user: toUser(userDoc)!,\n            },\n          });\n        }\n      }\n    }\n    \n    return results;\n  }\n\n  async getCommissionsByAdminId(adminId: number): Promise<Array<Commission & { broker: Broker & { user: User }; student: Student & { user: User } }>> {\n    await this.ensureConnected();\n    const brokerDocs = await BrokerModel.find({ adminId }).lean();\n    const brokerIds = brokerDocs.map(b => b.id);\n    \n    if (brokerIds.length === 0) {\n      return [];\n    }\n    \n    const commissionDocs = await CommissionModel.find({ brokerId: { $in: brokerIds } }).sort({ date: -1 }).lean();\n    const results: Array<Commission & { broker: Broker & { user: User }; student: Student & { user: User } }> = [];\n    \n    for (const commDoc of commissionDocs) {\n      const brokerDoc = brokerDocs.find(b => b.id === commDoc.brokerId);\n      const studentDoc = await StudentModel.findOne({ id: commDoc.studentId }).lean();\n      \n      if (brokerDoc && studentDoc) {\n        const brokerUserDoc = await UserModel.findOne({ id: brokerDoc.userId }).lean();\n        const studentUserDoc = await UserModel.findOne({ id: studentDoc.userId }).lean();\n        \n        if (brokerUserDoc && studentUserDoc) {\n          results.push({\n            ...toCommission(commDoc)!,\n            broker: {\n              ...toBroker(brokerDoc)!,\n              user: toUser(brokerUserDoc)!,\n            },\n            student: {\n              ...toStudent(studentDoc)!,\n              user: toUser(studentUserDoc)!,\n            },\n          });\n        }\n      }\n    }\n    \n    return results;\n  }\n\n  async getCommissionById(id: number): Promise<Commission | undefined> {\n    await this.ensureConnected();\n    const commission = await CommissionModel.findOne({ id }).lean();\n    return toCommission(commission);\n  }\n\n  async getAllCommissions(): Promise<Array<Commission & { broker: Broker & { user: User }; student: Student & { user: User } }>> {\n    await this.ensureConnected();\n    const commissionDocs = await CommissionModel.find().sort({ date: -1 }).lean();\n    const results: Array<Commission & { broker: Broker & { user: User }; student: Student & { user: User } }> = [];\n    \n    for (const commDoc of commissionDocs) {\n      const brokerDoc = await BrokerModel.findOne({ id: commDoc.brokerId }).lean();\n      const studentDoc = await StudentModel.findOne({ id: commDoc.studentId }).lean();\n      \n      if (brokerDoc && studentDoc) {\n        const brokerUserDoc = await UserModel.findOne({ id: brokerDoc.userId }).lean();\n        const studentUserDoc = await UserModel.findOne({ id: studentDoc.userId }).lean();\n        \n        if (brokerUserDoc && studentUserDoc) {\n          results.push({\n            ...toCommission(commDoc)!,\n            broker: {\n              ...toBroker(brokerDoc)!,\n              user: toUser(brokerUserDoc)!,\n            },\n            student: {\n              ...toStudent(studentDoc)!,\n              user: toUser(studentUserDoc)!,\n            },\n          });\n        }\n      }\n    }\n    \n    return results;\n  }\n\n  async updateCommissionStatus(id: number, status: string): Promise<void> {\n    await this.ensureConnected();\n    await CommissionModel.updateOne({ id }, { status });\n  }\n\n  async createDocument(insertDocument: InsertDocument): Promise<Document> {\n    await this.ensureConnected();\n    const id = await getNextSequence(\"documents\");\n    const document = await DocumentModel.create({\n      id,\n      ...insertDocument,\n      uploadedAt: new Date(),\n    });\n    return toDocument(document)!;\n  }\n\n  async getDocumentsByOwner(ownerType: string, ownerId: number): Promise<Array<Document & { uploadedBy: User }>> {\n    await this.ensureConnected();\n    const documentDocs = await DocumentModel.find({ ownerType, ownerId }).sort({ uploadedAt: -1 }).lean();\n    const results: Array<Document & { uploadedBy: User }> = [];\n    \n    for (const docDoc of documentDocs) {\n      const userDoc = await UserModel.findOne({ id: docDoc.uploadedById }).lean();\n      if (userDoc) {\n        results.push({\n          ...toDocument(docDoc)!,\n          uploadedBy: toUser(userDoc)!,\n        });\n      }\n    }\n    \n    return results;\n  }\n\n  async getDocumentsByBrokerStudents(brokerId: number): Promise<Array<Document & { uploadedBy: User }>> {\n    await this.ensureConnected();\n    const studentDocs = await StudentModel.find({ brokerId }).lean();\n    const studentIds = studentDocs.map(s => s.id);\n    \n    if (studentIds.length === 0) {\n      return [];\n    }\n    \n    const documentDocs = await DocumentModel.find({\n      ownerType: \"student\",\n      ownerId: { $in: studentIds },\n    }).sort({ uploadedAt: -1 }).lean();\n    \n    const results: Array<Document & { uploadedBy: User }> = [];\n    \n    for (const docDoc of documentDocs) {\n      const userDoc = await UserModel.findOne({ id: docDoc.uploadedById }).lean();\n      if (userDoc) {\n        results.push({\n          ...toDocument(docDoc)!,\n          uploadedBy: toUser(userDoc)!,\n        });\n      }\n    }\n    \n    return results;\n  }\n\n  async getDocumentsByAdminId(adminId: number): Promise<Array<Document & { uploadedBy: User }>> {\n    await this.ensureConnected();\n    \n    const studentDocs = await StudentModel.find({ adminId }).lean();\n    const studentIds = studentDocs.map(s => s.id);\n    \n    const brokerDocs = await BrokerModel.find({ adminId }).lean();\n    const brokerIds = brokerDocs.map(b => b.id);\n    \n    const documentDocs = await DocumentModel.find({\n      $or: [\n        { ownerType: \"student\", ownerId: { $in: studentIds } },\n        { ownerType: \"broker\", ownerId: { $in: brokerIds } },\n      ],\n    }).sort({ uploadedAt: -1 }).lean();\n    \n    const results: Array<Document & { uploadedBy: User }> = [];\n    \n    for (const docDoc of documentDocs) {\n      const userDoc = await UserModel.findOne({ id: docDoc.uploadedById }).lean();\n      if (userDoc) {\n        results.push({\n          ...toDocument(docDoc)!,\n          uploadedBy: toUser(userDoc)!,\n        });\n      }\n    }\n    \n    return results;\n  }\n\n  async getAllDocuments(): Promise<Array<Document & { uploadedBy: User }>> {\n    await this.ensureConnected();\n    const documentDocs = await DocumentModel.find().sort({ uploadedAt: -1 }).lean();\n    const results: Array<Document & { uploadedBy: User }> = [];\n    \n    for (const docDoc of documentDocs) {\n      const userDoc = await UserModel.findOne({ id: docDoc.uploadedById }).lean();\n      if (userDoc) {\n        results.push({\n          ...toDocument(docDoc)!,\n          uploadedBy: toUser(userDoc)!,\n        });\n      }\n    }\n    \n    return results;\n  }\n\n  async updateDocumentStatus(id: number, status: string, notes?: string): Promise<void> {\n    await this.ensureConnected();\n    const updateData: any = { status };\n    if (notes !== undefined) {\n      updateData.notes = notes;\n    }\n    await DocumentModel.updateOne({ id }, updateData);\n  }\n\n  async getDocumentById(id: number): Promise<Document | undefined> {\n    await this.ensureConnected();\n    const document = await DocumentModel.findOne({ id }).lean();\n    return toDocument(document);\n  }\n\n  async createActivity(insertActivity: InsertActivity): Promise<Activity> {\n    await this.ensureConnected();\n    const id = await getNextSequence(\"activities\");\n    const activity = await ActivityModel.create({\n      id,\n      ...insertActivity,\n      createdAt: new Date(),\n    });\n    return toActivity(activity)!;\n  }\n\n  async getActivitiesByRole(role: string, userId: number): Promise<Array<Activity & { actor: User }>> {\n    await this.ensureConnected();\n    const activityDocs = await ActivityModel.find()\n      .sort({ createdAt: -1 })\n      .limit(50)\n      .lean();\n    \n    const results: Array<Activity & { actor: User }> = [];\n    \n    for (const actDoc of activityDocs) {\n      const userDoc = await UserModel.findOne({ id: actDoc.actorId }).lean();\n      if (userDoc) {\n        results.push({\n          ...toActivity(actDoc)!,\n          actor: toUser(userDoc)!,\n        });\n      }\n    }\n    \n    return results;\n  }\n\n  async getAllActivities(): Promise<Array<Activity & { actor: User }>> {\n    await this.ensureConnected();\n    const activityDocs = await ActivityModel.find()\n      .sort({ createdAt: -1 })\n      .limit(100)\n      .lean();\n    \n    const results: Array<Activity & { actor: User }> = [];\n    \n    for (const actDoc of activityDocs) {\n      const userDoc = await UserModel.findOne({ id: actDoc.actorId }).lean();\n      if (userDoc) {\n        results.push({\n          ...toActivity(actDoc)!,\n          actor: toUser(userDoc)!,\n        });\n      }\n    }\n    \n    return results;\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","path":null,"size_bytes":29458,"size_tokens":null},"client/src/pages/broker/students.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { DashboardLayout } from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { MessageSquare, Plus, FileText, ChevronDown, ChevronUp, CheckCircle, XCircle, Clock, Eye } from \"lucide-react\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger, DialogFooter } from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Collapsible, CollapsibleContent, CollapsibleTrigger } from \"@/components/ui/collapsible\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { brokerApi } from \"@/lib/api\";\nimport { motion, AnimatePresence } from \"framer-motion\";\n\nconst getStatusIcon = (status: string) => {\n  switch (status) {\n    case \"Approved\":\n      return <CheckCircle className=\"w-4 h-4 text-green-500\" />;\n    case \"Rejected\":\n      return <XCircle className=\"w-4 h-4 text-red-500\" />;\n    case \"Under Review\":\n      return <Clock className=\"w-4 h-4 text-yellow-500\" />;\n    default:\n      return <Clock className=\"w-4 h-4 text-muted-foreground\" />;\n  }\n};\n\nconst getStatusColor = (status: string) => {\n  switch (status) {\n    case \"Approved\":\n      return \"bg-green-500/10 text-green-500 border-green-500/20\";\n    case \"Rejected\":\n      return \"bg-red-500/10 text-red-500 border-red-500/20\";\n    case \"Under Review\":\n      return \"bg-yellow-500/10 text-yellow-500 border-yellow-500/20\";\n    default:\n      return \"bg-gray-500/10 text-gray-500 border-gray-500/20\";\n  }\n};\n\nconst isValidUrl = (url: string): boolean => {\n  try {\n    const parsed = new URL(url);\n    return parsed.protocol === \"https:\" || parsed.protocol === \"http:\";\n  } catch {\n    return false;\n  }\n};\n\nexport default function BrokerStudents() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isAddOpen, setIsAddOpen] = useState(false);\n  const [expandedStudent, setExpandedStudent] = useState<number | null>(null);\n  const [isReviewOpen, setIsReviewOpen] = useState(false);\n  const [selectedDocument, setSelectedDocument] = useState<any>(null);\n  const [reviewForm, setReviewForm] = useState({ status: \"\", notes: \"\" });\n  const [newStudent, setNewStudent] = useState({ name: \"\", email: \"\", visaType: \"F-1 Student\" });\n\n  const { data: students = [], isLoading } = useQuery({\n    queryKey: [\"broker\", \"students\"],\n    queryFn: brokerApi.getStudents,\n  });\n\n  const { data: studentDocuments = [], isLoading: docsLoading } = useQuery({\n    queryKey: [\"broker\", \"student-documents\", expandedStudent],\n    queryFn: () => expandedStudent ? brokerApi.getStudentDocuments(expandedStudent) : Promise.resolve([]),\n    enabled: !!expandedStudent,\n  });\n\n  const [createdCredentials, setCreatedCredentials] = useState<{ email: string; password: string } | null>(null);\n  const [isCredentialsOpen, setIsCredentialsOpen] = useState(false);\n\n  const createMutation = useMutation({\n    mutationFn: brokerApi.createStudent,\n    onSuccess: (data: any) => {\n      queryClient.invalidateQueries({ queryKey: [\"broker\", \"students\"] });\n      queryClient.invalidateQueries({ queryKey: [\"broker\", \"applications\"] });\n      setIsAddOpen(false);\n      setCreatedCredentials({ email: newStudent.email, password: data.temporaryPassword });\n      setIsCredentialsOpen(true);\n      setNewStudent({ name: \"\", email: \"\", visaType: \"F-1 Student\" });\n    },\n    onError: (error: any) => {\n      toast({ \n        title: \"Error\", \n        description: error.message || \"Failed to add student\",\n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const updateDocStatusMutation = useMutation({\n    mutationFn: ({ documentId, status, notes }: { documentId: number; status: string; notes?: string }) =>\n      brokerApi.updateDocumentStatus(documentId, status, notes),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"broker\", \"student-documents\", expandedStudent] });\n      setIsReviewOpen(false);\n      setSelectedDocument(null);\n      setReviewForm({ status: \"\", notes: \"\" });\n      toast({ title: \"Document Updated\", description: \"Document status has been updated.\" });\n    },\n    onError: (error: any) => {\n      toast({ \n        title: \"Error\", \n        description: error.message || \"Failed to update document\",\n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const handleAddStudent = () => {\n    if (!newStudent.name || !newStudent.email) {\n      toast({ title: \"Error\", description: \"Please fill in all fields\", variant: \"destructive\" });\n      return;\n    }\n    createMutation.mutate(newStudent);\n  };\n\n  const handleMessage = (name: string) => {\n    toast({ title: \"Message Sent\", description: `Notification sent to ${name}.` });\n  };\n\n  const toggleStudentExpand = (studentId: number) => {\n    setExpandedStudent(expandedStudent === studentId ? null : studentId);\n  };\n\n  const openReviewDialog = (doc: any) => {\n    setSelectedDocument(doc);\n    setReviewForm({ status: doc.status || \"Under Review\", notes: \"\" });\n    setIsReviewOpen(true);\n  };\n\n  const handleReviewSubmit = () => {\n    if (!selectedDocument || !reviewForm.status) return;\n    updateDocStatusMutation.mutate({\n      documentId: selectedDocument.id,\n      status: reviewForm.status,\n      notes: reviewForm.notes,\n    });\n  };\n\n  if (isLoading) {\n    return (\n      <DashboardLayout role=\"broker\">\n        <div className=\"flex items-center justify-center h-64\">\n          <p className=\"text-muted-foreground\">Loading students...</p>\n        </div>\n      </DashboardLayout>\n    );\n  }\n\n  return (\n    <DashboardLayout role=\"broker\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-3xl font-display font-bold text-white\">My Students</h1>\n          <p className=\"text-muted-foreground\">Manage your assigned visa applicants and their documents.</p>\n        </div>\n        <Dialog open={isAddOpen} onOpenChange={setIsAddOpen}>\n          <DialogTrigger asChild>\n            <Button className=\"bg-secondary text-secondary-foreground hover:bg-secondary/90\" data-testid=\"button-add-student\">\n              <Plus className=\"w-4 h-4 mr-2\" /> Add New Student\n            </Button>\n          </DialogTrigger>\n          <DialogContent className=\"bg-card border-white/10\">\n            <DialogHeader>\n              <DialogTitle>Add New Student</DialogTitle>\n            </DialogHeader>\n            <div className=\"space-y-4 py-4\">\n              <div className=\"space-y-2\">\n                <Label>Student Name</Label>\n                <Input \n                  placeholder=\"Full Name\" \n                  className=\"bg-white/5 border-white/10\"\n                  value={newStudent.name}\n                  onChange={(e) => setNewStudent({...newStudent, name: e.target.value})}\n                  data-testid=\"input-new-student-name\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Email Address</Label>\n                <Input \n                  placeholder=\"student@example.com\" \n                  className=\"bg-white/5 border-white/10\"\n                  value={newStudent.email}\n                  onChange={(e) => setNewStudent({...newStudent, email: e.target.value})}\n                  data-testid=\"input-new-student-email\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Visa Type</Label>\n                <Select \n                  value={newStudent.visaType}\n                  onValueChange={(val) => setNewStudent({...newStudent, visaType: val})}\n                >\n                  <SelectTrigger className=\"bg-white/5 border-white/10\" data-testid=\"select-visa-type\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"F-1 Student\">F-1 Student</SelectItem>\n                    <SelectItem value=\"J-1 Exchange\">J-1 Exchange</SelectItem>\n                    <SelectItem value=\"H-1B Work\">H-1B Work</SelectItem>\n                    <SelectItem value=\"O-1 Talent\">O-1 Talent</SelectItem>\n                    <SelectItem value=\"B-1/B-2 Visitor\">B-1/B-2 Visitor</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n            <DialogFooter>\n              <Button variant=\"ghost\" onClick={() => setIsAddOpen(false)}>Cancel</Button>\n              <Button onClick={handleAddStudent} disabled={createMutation.isPending} data-testid=\"button-confirm-add-student\">\n                {createMutation.isPending ? \"Adding...\" : \"Add Student\"}\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      <Card className=\"glass-panel border-white/5\">\n        <CardHeader>\n          <CardTitle>Assigned Students ({students.length})</CardTitle>\n          <CardDescription>Click on a student row to view their documents</CardDescription>\n        </CardHeader>\n        <CardContent>\n          {students.length === 0 ? (\n            <div className=\"text-center text-muted-foreground py-8\">\n              No students yet. Add your first student to get started.\n            </div>\n          ) : (\n            <div className=\"space-y-2\">\n              {students.map((student: any) => (\n                <Collapsible \n                  key={student.id} \n                  open={expandedStudent === student.id}\n                  onOpenChange={() => toggleStudentExpand(student.id)}\n                >\n                  <div className=\"border border-white/10 rounded-lg overflow-hidden\">\n                    <CollapsibleTrigger asChild>\n                      <div \n                        className=\"flex items-center justify-between p-4 bg-white/5 hover:bg-white/10 cursor-pointer transition-colors\"\n                        data-testid={`row-student-${student.id}`}\n                      >\n                        <div className=\"flex items-center gap-4\">\n                          <div>\n                            <p className=\"font-medium\" data-testid={`text-student-name-${student.id}`}>\n                              {student.user?.name || \"N/A\"}\n                            </p>\n                            <p className=\"text-sm text-muted-foreground\">{student.user?.email || \"N/A\"}</p>\n                          </div>\n                        </div>\n                        <div className=\"flex items-center gap-4\">\n                          <div className=\"text-right\">\n                            <p className=\"text-sm text-muted-foreground\">Passport</p>\n                            <p className=\"font-mono text-xs\">{student.passportNumber || \"Not provided\"}</p>\n                          </div>\n                          <Button \n                            variant=\"ghost\" \n                            size=\"sm\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              handleMessage(student.user?.name || \"Student\");\n                            }}\n                            data-testid={`button-message-${student.id}`}\n                          >\n                            <MessageSquare className=\"w-4 h-4\" />\n                          </Button>\n                          <div className=\"flex items-center gap-2\">\n                            <FileText className=\"w-4 h-4 text-muted-foreground\" />\n                            {expandedStudent === student.id ? (\n                              <ChevronUp className=\"w-4 h-4\" />\n                            ) : (\n                              <ChevronDown className=\"w-4 h-4\" />\n                            )}\n                          </div>\n                        </div>\n                      </div>\n                    </CollapsibleTrigger>\n                    <CollapsibleContent>\n                      <AnimatePresence>\n                        {expandedStudent === student.id && (\n                          <motion.div\n                            initial={{ opacity: 0, height: 0 }}\n                            animate={{ opacity: 1, height: \"auto\" }}\n                            exit={{ opacity: 0, height: 0 }}\n                            className=\"border-t border-white/10 bg-background/50 p-4\"\n                          >\n                            <h4 className=\"font-medium mb-3 flex items-center gap-2\">\n                              <FileText className=\"w-4 h-4\" /> Documents\n                            </h4>\n                            {docsLoading ? (\n                              <p className=\"text-sm text-muted-foreground\">Loading documents...</p>\n                            ) : studentDocuments.length === 0 ? (\n                              <p className=\"text-sm text-muted-foreground\">No documents uploaded yet.</p>\n                            ) : (\n                              <div className=\"grid gap-2\">\n                                {studentDocuments.map((doc: any) => (\n                                  <div \n                                    key={doc.id} \n                                    className=\"flex items-center justify-between p-3 bg-white/5 rounded-lg\"\n                                    data-testid={`card-document-${doc.id}`}\n                                  >\n                                    <div className=\"flex items-center gap-3\">\n                                      <div className=\"w-10 h-10 rounded bg-primary/10 flex items-center justify-center\">\n                                        <FileText className=\"w-5 h-5 text-primary\" />\n                                      </div>\n                                      <div>\n                                        <p className=\"font-medium text-sm\" data-testid={`text-doc-name-${doc.id}`}>{doc.name}</p>\n                                        <p className=\"text-xs text-muted-foreground\">{doc.type}</p>\n                                      </div>\n                                    </div>\n                                    <div className=\"flex items-center gap-3\">\n                                      <Badge \n                                        variant=\"outline\" \n                                        className={getStatusColor(doc.status)}\n                                        data-testid={`status-doc-${doc.id}`}\n                                      >\n                                        <span className=\"mr-1\">{getStatusIcon(doc.status)}</span>\n                                        {doc.status}\n                                      </Badge>\n                                      <Button \n                                        variant=\"outline\" \n                                        size=\"sm\"\n                                        onClick={() => openReviewDialog(doc)}\n                                        data-testid={`button-review-doc-${doc.id}`}\n                                      >\n                                        Review\n                                      </Button>\n                                    </div>\n                                  </div>\n                                ))}\n                              </div>\n                            )}\n                          </motion.div>\n                        )}\n                      </AnimatePresence>\n                    </CollapsibleContent>\n                  </div>\n                </Collapsible>\n              ))}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      <Dialog open={isReviewOpen} onOpenChange={setIsReviewOpen}>\n        <DialogContent className=\"bg-card border-white/10\">\n          <DialogHeader>\n            <DialogTitle>Review Document</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"p-3 bg-white/5 rounded-lg\">\n              <p className=\"text-sm text-muted-foreground\">\n                Document: <span className=\"text-white font-medium\">{selectedDocument?.name}</span>\n              </p>\n              <p className=\"text-sm text-muted-foreground\">\n                Type: <span className=\"text-white\">{selectedDocument?.type}</span>\n              </p>\n              {selectedDocument?.path && isValidUrl(selectedDocument.path) && (\n                <p className=\"text-sm text-muted-foreground mt-1\">\n                  <a href={selectedDocument.path} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-primary hover:underline flex items-center gap-1\">\n                    <Eye className=\"w-3 h-3\" /> View Document\n                  </a>\n                </p>\n              )}\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Status</Label>\n              <Select value={reviewForm.status} onValueChange={(val) => setReviewForm({...reviewForm, status: val})}>\n                <SelectTrigger className=\"bg-white/5 border-white/10\" data-testid=\"select-doc-status\">\n                  <SelectValue placeholder=\"Select status\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"Pending\">Pending</SelectItem>\n                  <SelectItem value=\"Under Review\">Under Review</SelectItem>\n                  <SelectItem value=\"Approved\">Approved</SelectItem>\n                  <SelectItem value=\"Rejected\">Rejected</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Notes (optional)</Label>\n              <Textarea \n                placeholder=\"Add notes about this document...\"\n                className=\"bg-white/5 border-white/10\"\n                value={reviewForm.notes}\n                onChange={(e) => setReviewForm({...reviewForm, notes: e.target.value})}\n                data-testid=\"input-review-notes\"\n              />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"ghost\" onClick={() => setIsReviewOpen(false)}>Cancel</Button>\n            <Button \n              onClick={handleReviewSubmit} \n              disabled={updateDocStatusMutation.isPending}\n              data-testid=\"button-submit-review\"\n            >\n              {updateDocStatusMutation.isPending ? \"Updating...\" : \"Update Status\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={isCredentialsOpen} onOpenChange={(open) => {\n        if (!open && createdCredentials) {\n          return;\n        }\n        setIsCredentialsOpen(open);\n      }}>\n        <DialogContent className=\"bg-card border-white/10\">\n          <DialogHeader>\n            <DialogTitle>Student Account Created</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"p-4 bg-green-500/10 border border-green-500/20 rounded-lg\">\n              <p className=\"text-sm text-green-400 mb-3\">Share these login credentials with the new student:</p>\n              <div className=\"space-y-3\">\n                <div>\n                  <Label className=\"text-muted-foreground text-xs\">Email</Label>\n                  <div className=\"flex items-center gap-2\">\n                    <Input \n                      readOnly \n                      value={createdCredentials?.email || \"\"} \n                      className=\"bg-white/5 border-white/10 font-mono\"\n                      data-testid=\"text-student-email\"\n                    />\n                    <Button \n                      variant=\"outline\" \n                      size=\"sm\"\n                      onClick={() => {\n                        navigator.clipboard.writeText(createdCredentials?.email || \"\");\n                        toast({ title: \"Copied\", description: \"Email copied to clipboard\" });\n                      }}\n                      data-testid=\"button-copy-student-email\"\n                    >\n                      Copy\n                    </Button>\n                  </div>\n                </div>\n                <div>\n                  <Label className=\"text-muted-foreground text-xs\">Password</Label>\n                  <div className=\"flex items-center gap-2\">\n                    <Input \n                      readOnly \n                      value={createdCredentials?.password || \"\"} \n                      className=\"bg-white/5 border-white/10 font-mono\"\n                      data-testid=\"text-student-password\"\n                    />\n                    <Button \n                      variant=\"outline\" \n                      size=\"sm\"\n                      onClick={() => {\n                        navigator.clipboard.writeText(createdCredentials?.password || \"\");\n                        toast({ title: \"Copied\", description: \"Password copied to clipboard\" });\n                      }}\n                      data-testid=\"button-copy-student-password\"\n                    >\n                      Copy\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <p className=\"text-xs text-muted-foreground\">\n              Please save these credentials securely. The password cannot be retrieved later.\n            </p>\n          </div>\n          <DialogFooter>\n            <Button onClick={() => {\n              setIsCredentialsOpen(false);\n              setCreatedCredentials(null);\n            }} data-testid=\"button-close-student-credentials\">\n              Done\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </DashboardLayout>\n  );\n}\n","path":null,"size_bytes":21940,"size_tokens":null},"client/src/components/ui/label.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","path":null,"size_bytes":724,"size_tokens":null},"client/src/components/ui/drawer.tsx":{"content":"import * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","path":null,"size_bytes":3007,"size_tokens":null},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-4 w-4 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","path":null,"size_bytes":7406,"size_tokens":null},"client/src/components/ui/empty.tsx":{"content":"import { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Empty({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty\"\n      className={cn(\n        \"flex min-w-0 flex-1 flex-col items-center justify-center gap-6 text-balance rounded-lg border-dashed p-6 text-center md:p-12\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-header\"\n      className={cn(\n        \"flex max-w-sm flex-col items-center gap-2 text-center\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst emptyMediaVariants = cva(\n  \"mb-2 flex shrink-0 items-center justify-center [&_svg]:pointer-events-none [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        icon: \"bg-muted text-foreground flex size-10 shrink-0 items-center justify-center rounded-lg [&_svg:not([class*='size-'])]:size-6\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction EmptyMedia({\n  className,\n  variant = \"default\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof emptyMediaVariants>) {\n  return (\n    <div\n      data-slot=\"empty-icon\"\n      data-variant={variant}\n      className={cn(emptyMediaVariants({ variant, className }))}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-title\"\n      className={cn(\"text-lg font-medium tracking-tight\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <div\n      data-slot=\"empty-description\"\n      className={cn(\n        \"text-muted-foreground [&>a:hover]:text-primary text-sm/relaxed [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-content\"\n      className={cn(\n        \"flex w-full min-w-0 max-w-sm flex-col items-center gap-4 text-balance text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Empty,\n  EmptyHeader,\n  EmptyTitle,\n  EmptyDescription,\n  EmptyContent,\n  EmptyMedia,\n}\n","path":null,"size_bytes":2396,"size_tokens":null},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","path":null,"size_bytes":3895,"size_tokens":null},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","path":null,"size_bytes":768,"size_tokens":null},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Minus } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-9 w-9 items-center justify-center border-y border-r border-input text-sm shadow-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-1 ring-ring\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Minus />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","path":null,"size_bytes":2143,"size_tokens":null},"vite-plugin-meta-images.ts":{"content":"import type { Plugin } from 'vite';\nimport fs from 'fs';\nimport path from 'path';\n\n/**\n * Vite plugin that updates og:image and twitter:image meta tags\n * to point to the app's opengraph image with the correct Replit domain.\n */\nexport function metaImagesPlugin(): Plugin {\n  return {\n    name: 'vite-plugin-meta-images',\n    transformIndexHtml(html) {\n      const baseUrl = getDeploymentUrl();\n      if (!baseUrl) {\n        log('[meta-images] no Replit deployment domain found, skipping meta tag updates');\n        return html;\n      }\n\n      // Check if opengraph image exists in public directory\n      const publicDir = path.resolve(process.cwd(), 'client', 'public');\n      const opengraphPngPath = path.join(publicDir, 'opengraph.png');\n      const opengraphJpgPath = path.join(publicDir, 'opengraph.jpg');\n      const opengraphJpegPath = path.join(publicDir, 'opengraph.jpeg');\n\n      let imageExt: string | null = null;\n      if (fs.existsSync(opengraphPngPath)) {\n        imageExt = 'png';\n      } else if (fs.existsSync(opengraphJpgPath)) {\n        imageExt = 'jpg';\n      } else if (fs.existsSync(opengraphJpegPath)) {\n        imageExt = 'jpeg';\n      }\n\n      if (!imageExt) {\n        log('[meta-images] OpenGraph image not found, skipping meta tag updates');\n        return html;\n      }\n\n      const imageUrl = `${baseUrl}/opengraph.${imageExt}`;\n\n      log('[meta-images] updating meta image tags to:', imageUrl);\n\n      html = html.replace(\n        /<meta\\s+property=\"og:image\"\\s+content=\"[^\"]*\"\\s*\\/>/g,\n        `<meta property=\"og:image\" content=\"${imageUrl}\" />`\n      );\n\n      html = html.replace(\n        /<meta\\s+name=\"twitter:image\"\\s+content=\"[^\"]*\"\\s*\\/>/g,\n        `<meta name=\"twitter:image\" content=\"${imageUrl}\" />`\n      );\n\n      return html;\n    },\n  };\n}\n\nfunction getDeploymentUrl(): string | null {\n  if (process.env.REPLIT_INTERNAL_APP_DOMAIN) {\n    const url = `https://${process.env.REPLIT_INTERNAL_APP_DOMAIN}`;\n    log('[meta-images] using internal app domain:', url);\n    return url;\n  }\n\n  if (process.env.REPLIT_DEV_DOMAIN) {\n    const url = `https://${process.env.REPLIT_DEV_DOMAIN}`;\n    log('[meta-images] using dev domain:', url);\n    return url;\n  }\n\n  return null;\n}\n\nfunction log(...args: any[]): void {\n  if (process.env.NODE_ENV === 'production') {\n    console.log(...args);\n  }\n}\n","path":null,"size_bytes":2333,"size_tokens":null},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":80,"size_tokens":null},"client/src/components/ui/sonner.tsx":{"content":"\"use client\"\n\nimport { useTheme } from \"next-themes\"\nimport { Toaster as Sonner } from \"sonner\"\n\ntype ToasterProps = React.ComponentProps<typeof Sonner>\n\nconst Toaster = ({ ...props }: ToasterProps) => {\n  const { theme = \"system\" } = useTheme()\n\n  return (\n    <Sonner\n      theme={theme as ToasterProps[\"theme\"]}\n      className=\"toaster group\"\n      toastOptions={{\n        classNames: {\n          toast:\n            \"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg\",\n          description: \"group-[.toast]:text-muted-foreground\",\n          actionButton:\n            \"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground\",\n          cancelButton:\n            \"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground\",\n        },\n      }}\n      {...props}\n    />\n  )\n}\n\nexport { Toaster }\n","path":null,"size_bytes":894,"size_tokens":null},"client/src/components/ui/kbd.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Kbd({ className, ...props }: React.ComponentProps<\"kbd\">) {\n  return (\n    <kbd\n      data-slot=\"kbd\"\n      className={cn(\n        \"bg-muted text-muted-foreground pointer-events-none inline-flex h-5 w-fit min-w-5 select-none items-center justify-center gap-1 rounded-sm px-1 font-sans text-xs font-medium\",\n        \"[&_svg:not([class*='size-'])]:size-3\",\n        \"[[data-slot=tooltip-content]_&]:bg-background/20 [[data-slot=tooltip-content]_&]:text-background dark:[[data-slot=tooltip-content]_&]:bg-background/10\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction KbdGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <kbd\n      data-slot=\"kbd-group\"\n      className={cn(\"inline-flex items-center gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Kbd, KbdGroup }\n","path":null,"size_bytes":862,"size_tokens":null},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","path":null,"size_bytes":2001,"size_tokens":null},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { serveStatic } from \"./static\";\nimport { createServer } from \"http\";\nimport session from \"express-session\";\nimport createMemoryStore from \"memorystore\";\n\nconst app = express();\nconst httpServer = createServer(app);\n\ndeclare module \"http\" {\n  interface IncomingMessage {\n    rawBody: unknown;\n  }\n}\n\ndeclare module \"express-session\" {\n  interface SessionData {\n    userId?: number;\n    role?: \"admin\" | \"broker\" | \"student\";\n  }\n}\n\nconst MemoryStore = createMemoryStore(session);\n\napp.use(\n  session({\n    secret: process.env.SESSION_SECRET || \"visa-consultancy-secret-key-change-in-production\",\n    resave: false,\n    saveUninitialized: false,\n    store: new MemoryStore({\n      checkPeriod: 86400000, // prune expired entries every 24h\n    }),\n    cookie: {\n      maxAge: 24 * 60 * 60 * 1000, // 24 hours\n      httpOnly: true,\n      secure: process.env.NODE_ENV === \"production\",\n      sameSite: \"lax\",\n    },\n  })\n);\n\napp.use(\n  express.json({\n    verify: (req, _res, buf) => {\n      req.rawBody = buf;\n    },\n  }),\n);\n\napp.use(express.urlencoded({ extended: false }));\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  await registerRoutes(httpServer, app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (process.env.NODE_ENV === \"production\") {\n    serveStatic(app);\n  } else {\n    const { setupVite } = await import(\"./vite\");\n    await setupVite(httpServer, app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || \"5000\", 10);\n  httpServer.listen(\n    {\n      port,\n      host: \"0.0.0.0\",\n      reusePort: true,\n    },\n    () => {\n      log(`serving on port ${port}`);\n    },\n  );\n})();\n","path":null,"size_bytes":3265,"size_tokens":null},"client/src/components/ui/hover-card.tsx":{"content":"import * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","path":null,"size_bytes":1237,"size_tokens":null},"client/src/pages/student/documents.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { DashboardLayout } from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { commonApi } from \"@/lib/api\";\nimport { useAuth } from \"@/lib/auth-context\";\nimport { FileText, Upload, Eye, Clock, CheckCircle, XCircle, AlertCircle, Plus, Link } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\n\nconst documentTypes = [\n  \"Passport\",\n  \"Photo\",\n  \"Bank Statement\",\n  \"Employment Letter\",\n  \"Education Certificate\",\n  \"Travel Insurance\",\n  \"Application Form\",\n  \"Other\",\n];\n\nconst getStatusIcon = (status: string) => {\n  switch (status) {\n    case \"Approved\":\n      return <CheckCircle className=\"w-4 h-4 text-green-500\" />;\n    case \"Rejected\":\n      return <XCircle className=\"w-4 h-4 text-red-500\" />;\n    case \"Under Review\":\n      return <Clock className=\"w-4 h-4 text-yellow-500\" />;\n    default:\n      return <AlertCircle className=\"w-4 h-4 text-muted-foreground\" />;\n  }\n};\n\nconst getStatusColor = (status: string) => {\n  switch (status) {\n    case \"Approved\":\n      return \"bg-green-500/10 text-green-500 border-green-500/20\";\n    case \"Rejected\":\n      return \"bg-red-500/10 text-red-500 border-red-500/20\";\n    case \"Under Review\":\n      return \"bg-yellow-500/10 text-yellow-500 border-yellow-500/20\";\n    default:\n      return \"bg-gray-500/10 text-gray-500 border-gray-500/20\";\n  }\n};\n\nconst isValidUrl = (url: string): boolean => {\n  try {\n    const parsed = new URL(url);\n    return parsed.protocol === \"https:\" || parsed.protocol === \"http:\";\n  } catch {\n    return false;\n  }\n};\n\nexport default function StudentDocuments() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isUploadOpen, setIsUploadOpen] = useState(false);\n  const [uploadForm, setUploadForm] = useState({\n    name: \"\",\n    type: \"\",\n    path: \"\",\n  });\n\n  const { data: documents = [], isLoading } = useQuery({\n    queryKey: [\"student\", \"documents\"],\n    queryFn: commonApi.getMyDocuments,\n  });\n\n  const uploadMutation = useMutation({\n    mutationFn: (data: { name: string; type: string; path: string }) =>\n      commonApi.uploadDocument({\n        ...data,\n        ownerType: \"student\",\n        ownerId: user?.id || 0,\n      }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"student\", \"documents\"] });\n      setIsUploadOpen(false);\n      resetForm();\n      toast({ title: \"Document uploaded\", description: \"Your document has been uploaded for review.\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to upload document.\", variant: \"destructive\" });\n    },\n  });\n\n  const resetForm = () => {\n    setUploadForm({ name: \"\", type: \"\", path: \"\" });\n  };\n\n  const handleUpload = () => {\n    if (!uploadForm.name || !uploadForm.type || !uploadForm.path) {\n      toast({ title: \"Missing fields\", description: \"Please fill in all fields.\", variant: \"destructive\" });\n      return;\n    }\n\n    if (!isValidUrl(uploadForm.path)) {\n      toast({ \n        title: \"Invalid URL\", \n        description: \"Please enter a valid URL starting with http:// or https://\", \n        variant: \"destructive\" \n      });\n      return;\n    }\n\n    uploadMutation.mutate(uploadForm);\n  };\n\n  const handleDialogClose = (open: boolean) => {\n    setIsUploadOpen(open);\n    if (!open) {\n      resetForm();\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <DashboardLayout role=\"student\">\n        <div className=\"flex items-center justify-center h-64\">\n          <p className=\"text-muted-foreground\">Loading documents...</p>\n        </div>\n      </DashboardLayout>\n    );\n  }\n\n  return (\n    <DashboardLayout role=\"student\">\n      <div className=\"flex flex-col gap-8\">\n        <div className=\"flex justify-between items-end\">\n          <div>\n            <h1 className=\"text-4xl font-display font-bold text-white mb-2\">My Documents</h1>\n            <p className=\"text-muted-foreground\">Upload and manage your visa application documents.</p>\n          </div>\n          <Dialog open={isUploadOpen} onOpenChange={handleDialogClose}>\n            <DialogTrigger asChild>\n              <Button className=\"bg-primary text-primary-foreground\" data-testid=\"button-upload-document\">\n                <Plus className=\"w-4 h-4 mr-2\" /> Add Document\n              </Button>\n            </DialogTrigger>\n            <DialogContent className=\"glass-panel border-white/10 max-w-md\">\n              <DialogHeader>\n                <DialogTitle>Add Document</DialogTitle>\n              </DialogHeader>\n              <div className=\"space-y-4 pt-4\">\n                <div className=\"space-y-2\">\n                  <Label>Document Name</Label>\n                  <Input\n                    placeholder=\"e.g., Passport Copy\"\n                    value={uploadForm.name}\n                    onChange={(e) => setUploadForm({ ...uploadForm, name: e.target.value })}\n                    className=\"bg-white/5 border-white/10\"\n                    data-testid=\"input-document-name\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Document Type</Label>\n                  <Select\n                    value={uploadForm.type}\n                    onValueChange={(val) => setUploadForm({ ...uploadForm, type: val })}\n                  >\n                    <SelectTrigger className=\"bg-white/5 border-white/10\" data-testid=\"select-document-type\">\n                      <SelectValue placeholder=\"Select document type\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {documentTypes.map((type) => (\n                        <SelectItem key={type} value={type}>\n                          {type}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <Label className=\"flex items-center gap-2\">\n                    <Link className=\"w-4 h-4\" /> Document URL\n                  </Label>\n                  <Input\n                    placeholder=\"https://drive.google.com/file/...\"\n                    value={uploadForm.path}\n                    onChange={(e) => setUploadForm({ ...uploadForm, path: e.target.value })}\n                    className=\"bg-white/5 border-white/10\"\n                    data-testid=\"input-document-url\"\n                  />\n                  <p className=\"text-xs text-muted-foreground\">\n                    Upload your document to Google Drive, Dropbox, or OneDrive and paste the sharing link here\n                  </p>\n                </div>\n\n                <div className=\"flex gap-2 pt-2\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => handleDialogClose(false)}\n                    className=\"flex-1\"\n                    data-testid=\"button-cancel-upload\"\n                  >\n                    Cancel\n                  </Button>\n                  <Button\n                    onClick={handleUpload}\n                    disabled={uploadMutation.isPending}\n                    className=\"flex-1\"\n                    data-testid=\"button-submit-upload\"\n                  >\n                    {uploadMutation.isPending ? \"Adding...\" : \"Add Document\"}\n                  </Button>\n                </div>\n              </div>\n            </DialogContent>\n          </Dialog>\n        </div>\n\n        {documents.length === 0 ? (\n          <Card className=\"glass-panel border-white/5\">\n            <CardContent className=\"flex flex-col items-center justify-center py-16\">\n              <Upload className=\"w-16 h-16 text-muted-foreground/50 mb-4\" />\n              <h3 className=\"text-xl font-semibold mb-2\">No Documents Yet</h3>\n              <p className=\"text-muted-foreground text-center mb-6 max-w-md\">\n                Add your visa application documents by providing links from Google Drive, Dropbox, or other cloud storage.\n              </p>\n              <Button\n                className=\"bg-primary text-primary-foreground\"\n                onClick={() => setIsUploadOpen(true)}\n                data-testid=\"button-first-upload\"\n              >\n                <Plus className=\"w-4 h-4 mr-2\" /> Add First Document\n              </Button>\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid gap-4\">\n            {documents.map((doc: any, index: number) => (\n              <motion.div\n                key={doc.id}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: index * 0.05 }}\n              >\n                <Card className=\"glass-panel border-white/5\" data-testid={`card-document-${doc.id}`}>\n                  <CardContent className=\"p-4\">\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center gap-4\">\n                        <div className=\"w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center\">\n                          <FileText className=\"w-6 h-6 text-primary\" />\n                        </div>\n                        <div>\n                          <h4 className=\"font-semibold\" data-testid={`text-document-name-${doc.id}`}>\n                            {doc.name}\n                          </h4>\n                          <p className=\"text-sm text-muted-foreground\" data-testid={`text-document-type-${doc.id}`}>\n                            {doc.type}\n                          </p>\n                        </div>\n                      </div>\n                      <div className=\"flex items-center gap-4\">\n                        <Badge\n                          variant=\"outline\"\n                          className={getStatusColor(doc.status)}\n                          data-testid={`status-document-${doc.id}`}\n                        >\n                          <span className=\"mr-1\">{getStatusIcon(doc.status)}</span>\n                          {doc.status}\n                        </Badge>\n                        {doc.path && isValidUrl(doc.path) && (\n                          <a href={doc.path} target=\"_blank\" rel=\"noopener noreferrer\">\n                            <Button\n                              variant=\"ghost\"\n                              size=\"icon\"\n                              className=\"hover:bg-white/10\"\n                              data-testid={`button-view-document-${doc.id}`}\n                            >\n                              <Eye className=\"w-4 h-4\" />\n                            </Button>\n                          </a>\n                        )}\n                      </div>\n                    </div>\n                    {doc.notes && (\n                      <div className=\"mt-3 pt-3 border-t border-white/10\">\n                        <p className=\"text-sm text-muted-foreground\">\n                          <span className=\"font-medium\">Notes:</span> {doc.notes}\n                        </p>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n        )}\n\n        <Card className=\"glass-panel border-white/5 border-l-4 border-l-secondary\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-start gap-4\">\n              <div className=\"p-3 rounded-full bg-secondary/20 text-secondary\">\n                <AlertCircle className=\"w-5 h-5\" />\n              </div>\n              <div>\n                <h4 className=\"font-semibold mb-1\">How to Add Documents</h4>\n                <p className=\"text-sm text-muted-foreground\">\n                  Upload your documents to a cloud storage service like Google Drive or Dropbox, \n                  then share the link and paste it here. Make sure your documents are clear and legible.\n                  Your broker will review each document and update its status.\n                </p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </DashboardLayout>\n  );\n}\n","path":null,"size_bytes":12680,"size_tokens":null}},"version":2}